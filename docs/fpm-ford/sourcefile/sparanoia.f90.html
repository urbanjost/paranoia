<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="paranoia module">
    
    <meta name="author" content="John S. Urban" >
    <link rel="icon" href="../favicon.png">

    <title>sparanoia.f90 &ndash; paranoia</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">paranoia </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>





<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>sparanoia.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="49.9% of total for source files.">2144 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/sparanoia.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">sparanoia.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 














<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-0">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-0" class="panel-collapse collapse">
      
      <a class="list-group-item" href="../proc/sparanoia.html">sparanoia</a>
      
    </div>
  </div>
</div>









<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/sparanoia.f90.html#src">sparanoia.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
      
      

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 














<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-1">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-1" class="panel-collapse collapse">
      
      <a class="list-group-item" href="../proc/sparanoia.html">sparanoia</a>
      
    </div>
  </div>
</div>









<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/sparanoia.f90.html#src">sparanoia.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">subroutine </span><span class="n">sparanoia</span><span class="p">()</span>
<a name="ln-2"></a><span class="k">implicit none</span>
<a name="ln-3"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">ident</span><span class="o">=</span><span class="s2">&quot;@(#)sparanoia(3f): test real value operations in programming environment&quot;</span>
<a name="ln-4"></a><span class="c">!!!!!   COMMON /STDIO/ IN, OUT</span>
<a name="ln-5"></a>        <span class="kt">integer </span><span class="n">in</span><span class="p">,</span> <span class="n">out</span>
<a name="ln-6"></a><span class="c">!!!!!   COMMON /PGNUM/PGNUMB</span>
<a name="ln-7"></a>        <span class="kt">integer       </span><span class="n">pgnumb</span>
<a name="ln-8"></a><span class="c">!!!!!   COMMON /ROUNDN/  R1, R2, R3, R4, STICKY</span>
<a name="ln-9"></a>        <span class="kt">real </span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r3</span><span class="p">,</span> <span class="n">r4</span><span class="p">,</span> <span class="n">sticky</span>
<a name="ln-10"></a><span class="c">!</span>
<a name="ln-11"></a><span class="c">!!!!!   COMMON /I3TYPE/ IEEE</span>
<a name="ln-12"></a>        <span class="kt">integer         </span><span class="n">ieee</span>
<a name="ln-13"></a><span class="c">!        IEEE   ... FLAG WHETHER GRADUAL UNDERFLOWS ARE DOUBLY ROUNDED</span>
<a name="ln-14"></a><span class="c">!</span>
<a name="ln-15"></a><span class="c">!!!!!   COMMON /GLOBAL/ FAILS, SDEFCT, DEFECT, FLAWS, RADIX, ULPPLS,</span>
<a name="ln-16"></a><span class="c">!!!!!~        ULPMIN, PRECIS, W, MULGRD, DIVGRD, SUBGRD, A1, ONEMIN</span>
<a name="ln-17"></a>        <span class="kt">integer         </span><span class="n">fails</span><span class="p">,</span> <span class="n">sdefct</span><span class="p">,</span> <span class="n">defect</span><span class="p">,</span> <span class="n">flaws</span>
<a name="ln-18"></a>        <span class="kt">real                              </span><span class="nb">radix</span><span class="p">,</span> <span class="n">ulppls</span><span class="p">,</span> <span class="n">ulpmin</span><span class="p">,</span> <span class="n">precis</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">mulgrd</span><span class="p">,</span> <span class="n">divgrd</span><span class="p">,</span> <span class="n">subgrd</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">onemin</span>
<a name="ln-19"></a>        <span class="kt">logical </span><span class="n">flagf</span>
<a name="ln-20"></a><span class="c">!</span>
<a name="ln-21"></a><span class="c">!        FAILS  ... NUMBER OF FAILURES</span>
<a name="ln-22"></a><span class="c">!        SDEFCT ... NUMBER OF SERIOUS DEFECTS</span>
<a name="ln-23"></a><span class="c">!        DEFECT ... NUMBER OF DEFECTS</span>
<a name="ln-24"></a><span class="c">!        FLAWS  ... NUMBER OF FLAWS</span>
<a name="ln-25"></a><span class="c">!</span>
<a name="ln-26"></a><span class="c">!        RADIX  ... COMPUTED RADIX OF THE MACHINE</span>
<a name="ln-27"></a><span class="c">!        ULPPLS ... ONE UNIT IN THE LAST PLACE (ULP) OF 1+EPSILON</span>
<a name="ln-28"></a><span class="c">!        ULPMIN ... ONE UNIT IN THE LAST PLACE (ULP) OF 1-EPSILON</span>
<a name="ln-29"></a><span class="c">!        PRECIS ... COMPUTED PRECISION OF THE MACHINE</span>
<a name="ln-30"></a><span class="c">!        W      ... RADIX ** PRECIS</span>
<a name="ln-31"></a><span class="c">!        MULGRD ... USED TO TEST FOR USE OF GUARD DIGITS IN MULTIPLY</span>
<a name="ln-32"></a><span class="c">!        DIVGRD ... USED TO TEST FOR USE OF GUARD DIGITS IN DIVIDE</span>
<a name="ln-33"></a><span class="c">!        SUBGRD ... USED TO TEST FOR USE OF GUARD DIGITS IN ADD/SUBTRACT</span>
<a name="ln-34"></a><span class="c">!        A1     ...</span>
<a name="ln-35"></a><span class="c">!        ONEMIN ... ONE MINUS ULPMIN = ~.99999999999999</span>
<a name="ln-36"></a><span class="c">!</span>
<a name="ln-37"></a><span class="c">!!!!!   COMMON /CONST/   FP0, FP1, FP2, FP3, FP4, FP8, FP9, FP27, FP32,</span>
<a name="ln-38"></a><span class="c">!!!!!~                   HALF, MINUS1</span>
<a name="ln-39"></a>        <span class="kt">real </span><span class="n">fp0</span><span class="p">,</span> <span class="n">fp1</span><span class="p">,</span> <span class="n">fp2</span><span class="p">,</span> <span class="n">fp3</span><span class="p">,</span> <span class="n">fp4</span><span class="p">,</span> <span class="n">fp8</span><span class="p">,</span> <span class="n">fp9</span><span class="p">,</span> <span class="n">fp27</span><span class="p">,</span> <span class="n">fp32</span><span class="p">,</span> <span class="n">half</span><span class="p">,</span> <span class="n">minus1</span>
<a name="ln-40"></a><span class="c">!</span>
<a name="ln-41"></a><span class="c">!!!!!   COMMON /OVUNFL/  C1, H1, MINPOS, NULPS, UFLTHR, PHONY0</span>
<a name="ln-42"></a>        <span class="kt">real </span><span class="n">c1</span><span class="p">,</span> <span class="n">h1</span><span class="p">,</span> <span class="n">minpos</span><span class="p">,</span> <span class="n">nulps</span><span class="p">,</span> <span class="n">uflthr</span><span class="p">,</span> <span class="n">phony0</span>
<a name="ln-43"></a><span class="c">!        C1     ... 1/C ~= RADIX^LARGE_INTEGER</span>
<a name="ln-44"></a><span class="c">!        H1     ... MAX (2,RADIX)</span>
<a name="ln-45"></a><span class="c">!        MINPOS ... MINIMUM POSITIVE NUMBER FOUND BY MULT./DIVISION</span>
<a name="ln-46"></a><span class="c">!        NULPS  ... (SMALL INTEGER) * 1 UNIT IN LAST PLACE OF 1+ ... E9</span>
<a name="ln-47"></a><span class="c">!        UFLTHR ... THE UNDERFLOW THRESHOLD U0</span>
<a name="ln-48"></a><span class="c">!        PHONY0 ... CANDIDATE AND FINAL PHONY ZERO IF IT EXISTS. Z0</span>
<a name="ln-49"></a><span class="c">!#######################################################################</span>
<a name="ln-50"></a>      <span class="k">call </span><span class="n">runtests</span><span class="p">()</span>
<a name="ln-51"></a>      <span class="k">close</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;delete&#39;</span><span class="p">)</span>
<a name="ln-52"></a>      <span class="k">close</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;delete&#39;</span><span class="p">)</span>
<a name="ln-53"></a>      <span class="k">return</span>
<a name="ln-54"></a><span class="k">      contains</span>
<a name="ln-55"></a><span class="c">!#######################################################################</span>
<a name="ln-56"></a>      <span class="k">subroutine </span><span class="n">runtests</span><span class="p">()</span>
<a name="ln-57"></a>      <span class="k">implicit none</span>
<a name="ln-58"></a><span class="c">!</span>
<a name="ln-59"></a>        <span class="kt">integer </span><span class="n">start</span>
<a name="ln-60"></a><span class="c">!        ... FLAG TO TELL WHETHER WE ARE RESTARTING OR</span>
<a name="ln-61"></a><span class="c">!        ... STARTING FROM SCRATCH</span>
<a name="ln-62"></a>        <span class="kt">integer </span><span class="n">temp</span>
<a name="ln-63"></a>        <span class="kt">integer </span><span class="n">miles</span><span class="p">,</span> <span class="n">numtry</span><span class="p">,</span> <span class="n">from</span>
<a name="ln-64"></a><span class="c">!        MILES  ... NUMBER OF MILESTONE REACHED SO FAR IN TESTING</span>
<a name="ln-65"></a><span class="c">!        NUMTRY ... NUMBER OF TIMES TO TRY RANDOM TRIALS</span>
<a name="ln-66"></a><span class="c">!        FROM   ... NUMBER OF MILESTONE TO RETURN TO ON RESTART</span>
<a name="ln-67"></a><span class="c">!</span>
<a name="ln-68"></a><span class="c">!</span>
<a name="ln-69"></a><span class="c">!</span>
<a name="ln-70"></a><span class="c">! DISABLE INTERRUPTS FOR LAHEY F77L.</span>
<a name="ln-71"></a><span class="c">!       LOGICAL FLAG</span>
<a name="ln-72"></a><span class="c">!       CALL INVALOP(FLAG)</span>
<a name="ln-73"></a><span class="c">!       CALL OVEFL(FLAG)</span>
<a name="ln-74"></a><span class="c">!       CALL UNDFL(FLAG)</span>
<a name="ln-75"></a><span class="c">!       CALL DVCHK(FLAG)</span>
<a name="ln-76"></a><span class="c">!</span>
<a name="ln-77"></a><span class="c">! DISABLE INTERRUPTS FOR MICROSOFT FORTRAN  (MASK MUST BE INTEGER*2)</span>
<a name="ln-78"></a><span class="c">!       INTEGER*2 MASK</span>
<a name="ln-79"></a><span class="c">!       MASK=4927</span>
<a name="ln-80"></a><span class="c">!       CALL LCWRQQ(MASK)</span>
<a name="ln-81"></a><span class="c">! DISABLE INTERRUPTS FOR WATFIV</span>
<a name="ln-82"></a><span class="c">!       CALL TRAPS(100,100,100,100,100)</span>
<a name="ln-83"></a><span class="c">! NO SPECIAL CALL IS REQUIRED FOR FORTVS.</span>
<a name="ln-84"></a><span class="c">!</span>
<a name="ln-85"></a><span class="c">!</span>
<a name="ln-86"></a>        <span class="n">from</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-87"></a><span class="c">!</span>
<a name="ln-88"></a><span class="c">! IN = INPUT UNIT, OUT = OUTPUT UNIT -- YOU MAY HAVE TO CHANGE THESE.</span>
<a name="ln-89"></a>        <span class="n">in</span> <span class="o">=</span> <span class="mi">5</span>
<a name="ln-90"></a>        <span class="n">out</span> <span class="o">=</span> <span class="mi">6</span>
<a name="ln-91"></a><span class="c">! THE FOLLOWING OPENS MAY BE NEEDED FOR SOME VERSIONS.</span>
<a name="ln-92"></a><span class="c">!       OPEN(IN,FILE=&#39;CON&#39;)</span>
<a name="ln-93"></a><span class="c">!       OPEN(OUT,FILE=&#39;CON&#39;)</span>
<a name="ln-94"></a><span class="c">!#######################################################################</span>
<a name="ln-95"></a><span class="c">!</span>
<a name="ln-96"></a><span class="c">!</span>
<a name="ln-97"></a><span class="c">!       CHECK FOR RESTART</span>
<a name="ln-98"></a><span class="c">!</span>
<a name="ln-99"></a><span class="c">!</span>
<a name="ln-100"></a><span class="c">!#######################################################################</span>
<a name="ln-101"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<a name="ln-102"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">110</span><span class="p">)</span>
<a name="ln-103"></a><span class="mi">100</span>     <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Is this a program restart after failure (1)&#39;</span><span class="p">)</span>
<a name="ln-104"></a><span class="mi">110</span>     <span class="k">format</span><span class="p">(</span><span class="s1">&#39; or a start from scratch (0) ?&#39;</span><span class="p">)</span>
<a name="ln-105"></a>        <span class="k">read</span><span class="p">(</span><span class="n">in</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span> <span class="n">start</span>
<a name="ln-106"></a><span class="mi">120</span>     <span class="k">format</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span>
<a name="ln-107"></a>        <span class="n">flagf</span> <span class="o">=</span> <span class="n">start</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span>
<a name="ln-108"></a><span class="c">!  ***  FOR FORTRAN 66 AND FORTRAN 77 SUBSET, COMMENT OUT THE INQUIRE:</span>
<a name="ln-109"></a>        <span class="k">inquire</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;TST&#39;</span><span class="p">,</span><span class="n">exist</span><span class="o">=</span><span class="n">flagf</span><span class="p">)</span>
<a name="ln-110"></a>        <span class="k">if</span><span class="p">(</span><span class="n">flagf</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-111"></a><span class="k">            open</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;TST&#39;</span><span class="p">,</span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;UNFORMATTED&#39;</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;OLD&#39;</span><span class="p">)</span>
<a name="ln-112"></a>            <span class="k">rewind </span><span class="mi">3</span>
<a name="ln-113"></a>            <span class="k">open</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;LOG&#39;</span><span class="p">,</span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;UNFORMATTED&#39;</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;OLD&#39;</span><span class="p">)</span>
<a name="ln-114"></a>            <span class="k">rewind </span><span class="mi">4</span>
<a name="ln-115"></a>        <span class="k">else</span>
<a name="ln-116"></a><span class="k">            open</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;TST&#39;</span><span class="p">,</span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;UNFORMATTED&#39;</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;NEW&#39;</span><span class="p">)</span>
<a name="ln-117"></a>            <span class="k">open</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;LOG&#39;</span><span class="p">,</span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;UNFORMATTED&#39;</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;NEW&#39;</span><span class="p">)</span>
<a name="ln-118"></a>        <span class="k">endif</span>
<a name="ln-119"></a><span class="k">        if</span> <span class="p">(</span><span class="n">start</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">10000</span>
<a name="ln-120"></a>        <span class="k">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">fp0</span><span class="p">,</span><span class="n">fp1</span><span class="p">,</span><span class="n">fp2</span><span class="p">,</span><span class="n">fp3</span><span class="p">,</span><span class="n">fp4</span><span class="p">,</span><span class="n">fp8</span><span class="p">,</span><span class="n">fp9</span><span class="p">,</span><span class="n">fp27</span><span class="p">,</span><span class="n">fp32</span><span class="p">,</span><span class="n">half</span><span class="p">,</span><span class="n">minus1</span>
<a name="ln-121"></a>        <span class="k">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">fails</span><span class="p">,</span><span class="n">sdefct</span><span class="p">,</span><span class="n">defect</span><span class="p">,</span><span class="n">flaws</span><span class="p">,</span><span class="nb">radix</span><span class="p">,</span><span class="n">ulppls</span><span class="p">,</span><span class="n">ulpmin</span><span class="p">,</span><span class="n">precis</span>
<a name="ln-122"></a>        <span class="k">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">w</span><span class="p">,</span> <span class="n">mulgrd</span><span class="p">,</span><span class="n">divgrd</span><span class="p">,</span> <span class="n">subgrd</span><span class="p">,</span><span class="n">a1</span><span class="p">,</span><span class="n">onemin</span>
<a name="ln-123"></a>        <span class="k">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">c1</span><span class="p">,</span> <span class="n">h1</span><span class="p">,</span> <span class="n">minpos</span><span class="p">,</span> <span class="n">nulps</span><span class="p">,</span> <span class="n">uflthr</span><span class="p">,</span> <span class="n">phony0</span><span class="p">,</span><span class="n">ieee</span>
<a name="ln-124"></a>        <span class="k">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">,</span><span class="n">r3</span><span class="p">,</span><span class="n">r4</span><span class="p">,</span><span class="n">sticky</span>
<a name="ln-125"></a>        <span class="k">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">pgnumb</span><span class="p">,</span><span class="n">miles</span>
<a name="ln-126"></a>        <span class="k">rewind </span><span class="mi">4</span>
<a name="ln-127"></a>        <span class="n">from</span> <span class="o">=</span> <span class="n">miles</span>
<a name="ln-128"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">10001</span><span class="p">)</span><span class="n">from</span>
<a name="ln-129"></a><span class="mi">10001</span>   <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Restarting from milestone &#39;</span><span class="p">,</span><span class="n">i5</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-130"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span>   <span class="mi">7</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span>   <span class="mi">881</span>
<a name="ln-131"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span>  <span class="mi">79</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span>  <span class="mi">3959</span>
<a name="ln-132"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span>  <span class="mi">90</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span>  <span class="mi">3960</span>
<a name="ln-133"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">105</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">from</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="mi">109</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">10100</span>
<a name="ln-134"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">115</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">10100</span>
<a name="ln-135"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">120</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">from</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="mi">125</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">10100</span>
<a name="ln-136"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">131</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">10100</span>
<a name="ln-137"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">161</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">10200</span>
<a name="ln-138"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">201</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">from</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="mi">205</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">10200</span>
<a name="ln-139"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">211</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">10300</span>
<a name="ln-140"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">212</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">10300</span>
<a name="ln-141"></a>        <span class="k">call </span><span class="n">badmil</span>
<a name="ln-142"></a><span class="c">!</span>
<a name="ln-143"></a><span class="c">!             FIRST TWO ASSIGNMENTS USE INTEGERS ON RIGHT HAND SIDE</span>
<a name="ln-144"></a><span class="c">!</span>
<a name="ln-145"></a><span class="mi">10000</span>   <span class="k">continue</span>
<a name="ln-146"></a><span class="k">        </span><span class="n">fp0</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-147"></a>        <span class="n">fp1</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-148"></a><span class="c">!910     continue</span>
<a name="ln-149"></a>        <span class="n">fp2</span> <span class="o">=</span> <span class="n">fp1</span> <span class="o">+</span> <span class="n">fp1</span>
<a name="ln-150"></a><span class="c">!960     continue</span>
<a name="ln-151"></a>        <span class="n">fp3</span> <span class="o">=</span> <span class="n">fp2</span> <span class="o">+</span> <span class="n">fp1</span>
<a name="ln-152"></a>        <span class="n">fp4</span> <span class="o">=</span> <span class="n">fp3</span> <span class="o">+</span> <span class="n">fp1</span>
<a name="ln-153"></a><span class="c">!980     continue</span>
<a name="ln-154"></a>        <span class="n">minus1</span> <span class="o">=</span> <span class="o">-</span><span class="n">fp1</span>
<a name="ln-155"></a><span class="c">!1000    continue</span>
<a name="ln-156"></a>        <span class="n">half</span> <span class="o">=</span> <span class="n">fp1</span> <span class="o">/</span> <span class="n">fp2</span>
<a name="ln-157"></a><span class="c">!1100    continue</span>
<a name="ln-158"></a>        <span class="n">fp8</span> <span class="o">=</span> <span class="n">fp4</span> <span class="o">+</span> <span class="n">fp4</span>
<a name="ln-159"></a>        <span class="n">fp9</span> <span class="o">=</span> <span class="n">fp3</span> <span class="o">*</span> <span class="n">fp3</span>
<a name="ln-160"></a>        <span class="n">fp27</span> <span class="o">=</span> <span class="n">fp9</span> <span class="o">*</span> <span class="n">fp3</span>
<a name="ln-161"></a>        <span class="n">fp32</span> <span class="o">=</span> <span class="n">fp8</span> <span class="o">*</span> <span class="n">fp4</span>
<a name="ln-162"></a><span class="c">!</span>
<a name="ln-163"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="ln-164"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<a name="ln-165"></a><span class="mi">10</span>      <span class="k">format</span><span class="p">(</span><span class="s1">&#39; A  Paranoid  Program  to  Diagnose  Floating-point Arithmetic&#39;</span><span class="p">)</span>
<a name="ln-166"></a><span class="mi">40</span>      <span class="k">format</span><span class="p">(</span><span class="s1">&#39;          ... Single-Precision Version  ...&#39;</span><span class="p">)</span>
<a name="ln-167"></a><span class="c">!</span>
<a name="ln-168"></a><span class="c">!#######################################################################</span>
<a name="ln-169"></a><span class="c">!</span>
<a name="ln-170"></a>        <span class="n">numtry</span> <span class="o">=</span> <span class="mi">20</span>
<a name="ln-171"></a><span class="c">!        ...  NUMTRY = #( RANDOM TRIALS OF X*Y=Y*X , ETC.)</span>
<a name="ln-172"></a>        <span class="n">pgnumb</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-173"></a><span class="c">!        ... PGNUMB = #( PAGE OF DIAGNOSIS ); MILES=MILESTONE IN PROGRAM</span>
<a name="ln-174"></a>        <span class="n">miles</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-175"></a><span class="c">!        ... COUNT FAILURES, SERIOUS DEFECTS, DEFECTS, FLAWS</span>
<a name="ln-176"></a>        <span class="n">fails</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-177"></a>        <span class="n">sdefct</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-178"></a>        <span class="n">defect</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-179"></a>        <span class="n">flaws</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-180"></a><span class="c">!#######################################################################</span>
<a name="ln-181"></a><span class="c">!</span>
<a name="ln-182"></a><span class="c">!</span>
<a name="ln-183"></a><span class="c">!       PRINT BIG INTRO MESSAGES</span>
<a name="ln-184"></a><span class="c">!</span>
<a name="ln-185"></a><span class="c">!</span>
<a name="ln-186"></a><span class="c">!#######################################################################</span>
<a name="ln-187"></a>        <span class="k">call </span><span class="n">intro</span> <span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-188"></a><span class="c">!#######################################################################</span>
<a name="ln-189"></a><span class="c">!</span>
<a name="ln-190"></a><span class="c">!</span>
<a name="ln-191"></a><span class="c">!       SMALL INTEGER TESTING</span>
<a name="ln-192"></a><span class="c">!</span>
<a name="ln-193"></a><span class="c">!</span>
<a name="ln-194"></a><span class="c">!#######################################################################</span>
<a name="ln-195"></a><span class="c">!880     continue</span>
<a name="ln-196"></a>        <span class="n">miles</span> <span class="o">=</span> <span class="mi">7</span>
<a name="ln-197"></a>        <span class="k">call </span><span class="n">page</span> <span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-198"></a><span class="mi">881</span>     <span class="k">continue</span>
<a name="ln-199"></a><span class="k">        call </span><span class="n">smlint</span> <span class="p">(</span><span class="n">miles</span><span class="p">,</span><span class="n">from</span><span class="p">)</span>
<a name="ln-200"></a>        <span class="n">from</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-201"></a><span class="c">!#######################################################################</span>
<a name="ln-202"></a><span class="c">!</span>
<a name="ln-203"></a><span class="c">!</span>
<a name="ln-204"></a><span class="c">!       FIND RADIX B AND PRECISION P</span>
<a name="ln-205"></a><span class="c">!</span>
<a name="ln-206"></a><span class="c">!</span>
<a name="ln-207"></a><span class="c">!#######################################################################</span>
<a name="ln-208"></a>        <span class="k">call </span><span class="n">radx</span> <span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-209"></a><span class="c">!#######################################################################</span>
<a name="ln-210"></a><span class="c">!</span>
<a name="ln-211"></a><span class="c">!</span>
<a name="ln-212"></a><span class="c">!       TEST FOR EXTRA PRECISION IN SUBEXPRESSIONS</span>
<a name="ln-213"></a><span class="c">!</span>
<a name="ln-214"></a><span class="c">!</span>
<a name="ln-215"></a><span class="c">!#######################################################################</span>
<a name="ln-216"></a><span class="c">!1680    continue</span>
<a name="ln-217"></a>        <span class="n">miles</span> <span class="o">=</span> <span class="mi">30</span>
<a name="ln-218"></a>        <span class="k">call </span><span class="n">extra</span>
<a name="ln-219"></a><span class="c">!1860    continue</span>
<a name="ln-220"></a>        <span class="k">call </span><span class="n">page</span> <span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-221"></a><span class="c">!#######################################################################</span>
<a name="ln-222"></a><span class="c">!</span>
<a name="ln-223"></a><span class="c">!</span>
<a name="ln-224"></a><span class="c">!       CHECK FOR GUARD DIGITS AND NORMALIZATION IN SUBTRACTION</span>
<a name="ln-225"></a><span class="c">!</span>
<a name="ln-226"></a><span class="c">!</span>
<a name="ln-227"></a><span class="c">!#######################################################################</span>
<a name="ln-228"></a><span class="c">!1870    continue</span>
<a name="ln-229"></a>        <span class="n">miles</span> <span class="o">=</span> <span class="mi">35</span>
<a name="ln-230"></a>        <span class="k">call </span><span class="n">guard</span>
<a name="ln-231"></a><span class="c">!2240    continue</span>
<a name="ln-232"></a>        <span class="n">miles</span> <span class="o">=</span> <span class="mi">40</span>
<a name="ln-233"></a>        <span class="k">call </span><span class="n">page</span> <span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-234"></a><span class="c">!#######################################################################</span>
<a name="ln-235"></a><span class="c">!</span>
<a name="ln-236"></a><span class="c">!</span>
<a name="ln-237"></a><span class="c">!       TEST ROUNDING IN MULTIPLY, DIVIDE, AND ADD/SUBTRACT.</span>
<a name="ln-238"></a><span class="c">!</span>
<a name="ln-239"></a><span class="c">!</span>
<a name="ln-240"></a><span class="c">!#######################################################################</span>
<a name="ln-241"></a>        <span class="k">call </span><span class="n">round</span> <span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-242"></a><span class="c">!2910    continue</span>
<a name="ln-243"></a>        <span class="n">miles</span> <span class="o">=</span> <span class="mi">60</span>
<a name="ln-244"></a><span class="c">!#######################################################################</span>
<a name="ln-245"></a><span class="c">!</span>
<a name="ln-246"></a><span class="c">!</span>
<a name="ln-247"></a><span class="c">!       TEST FOR COMMUTATIVE MULTIPLICATION</span>
<a name="ln-248"></a><span class="c">!</span>
<a name="ln-249"></a><span class="c">!</span>
<a name="ln-250"></a><span class="c">!#######################################################################</span>
<a name="ln-251"></a>        <span class="k">call </span><span class="n">commut</span> <span class="p">(</span><span class="n">numtry</span><span class="p">)</span>
<a name="ln-252"></a><span class="c">!3010    continue</span>
<a name="ln-253"></a>        <span class="n">miles</span> <span class="o">=</span> <span class="mi">70</span>
<a name="ln-254"></a><span class="c">!#######################################################################</span>
<a name="ln-255"></a><span class="c">!</span>
<a name="ln-256"></a><span class="c">!</span>
<a name="ln-257"></a><span class="c">!       TEST SQUARE ROOT</span>
<a name="ln-258"></a><span class="c">!</span>
<a name="ln-259"></a><span class="c">!</span>
<a name="ln-260"></a><span class="c">!#######################################################################</span>
<a name="ln-261"></a><span class="mi">3959</span>    <span class="k">continue</span>
<a name="ln-262"></a><span class="k">        call </span><span class="n">square</span> <span class="p">(</span><span class="n">from</span><span class="p">,</span> <span class="n">miles</span><span class="p">,</span> <span class="n">numtry</span><span class="p">)</span>
<a name="ln-263"></a>        <span class="n">from</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-264"></a><span class="mi">3960</span>    <span class="k">continue</span>
<a name="ln-265"></a><span class="k">        </span><span class="n">miles</span> <span class="o">=</span> <span class="mi">90</span>
<a name="ln-266"></a>        <span class="k">call </span><span class="n">page</span> <span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-267"></a><span class="c">!#######################################################################</span>
<a name="ln-268"></a><span class="c">!</span>
<a name="ln-269"></a><span class="c">!</span>
<a name="ln-270"></a><span class="c">!       TEST Y TO POWER X</span>
<a name="ln-271"></a><span class="c">!</span>
<a name="ln-272"></a><span class="c">!</span>
<a name="ln-273"></a><span class="c">!#######################################################################</span>
<a name="ln-274"></a>        <span class="k">call </span><span class="n">power</span> <span class="p">(</span><span class="n">miles</span><span class="p">,</span><span class="n">from</span><span class="p">)</span>
<a name="ln-275"></a>        <span class="n">from</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-276"></a><span class="c">!#######################################################################</span>
<a name="ln-277"></a><span class="c">!</span>
<a name="ln-278"></a><span class="c">!</span>
<a name="ln-279"></a><span class="c">!       TEST UNDERFLOW THRESHOLDS</span>
<a name="ln-280"></a><span class="c">!</span>
<a name="ln-281"></a><span class="c">!</span>
<a name="ln-282"></a><span class="c">!#######################################################################</span>
<a name="ln-283"></a><span class="mi">10100</span>   <span class="k">continue</span>
<a name="ln-284"></a><span class="k">        call </span><span class="n">underf</span> <span class="p">(</span><span class="n">miles</span><span class="p">,</span><span class="n">numtry</span><span class="p">,</span><span class="n">from</span><span class="p">)</span>
<a name="ln-285"></a>        <span class="n">from</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-286"></a>        <span class="k">call </span><span class="n">page</span> <span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-287"></a><span class="c">!#######################################################################</span>
<a name="ln-288"></a><span class="c">!</span>
<a name="ln-289"></a><span class="c">!</span>
<a name="ln-290"></a><span class="c">!       TEST OVERFLOW THRESHOLDS</span>
<a name="ln-291"></a><span class="c">!</span>
<a name="ln-292"></a><span class="c">!</span>
<a name="ln-293"></a><span class="c">!#######################################################################</span>
<a name="ln-294"></a><span class="mi">10200</span>   <span class="k">continue</span>
<a name="ln-295"></a><span class="k">        call </span><span class="n">overf</span> <span class="p">(</span><span class="n">miles</span><span class="p">,</span> <span class="n">from</span><span class="p">)</span>
<a name="ln-296"></a>        <span class="n">from</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-297"></a><span class="c">!6110    continue</span>
<a name="ln-298"></a>        <span class="n">miles</span> <span class="o">=</span> <span class="mi">210</span>
<a name="ln-299"></a><span class="c">!</span>
<a name="ln-300"></a><span class="c">!</span>
<a name="ln-301"></a><span class="c">!</span>
<a name="ln-302"></a><span class="mi">10300</span>   <span class="k">continue</span>
<a name="ln-303"></a><span class="k">        call </span><span class="n">zeros</span><span class="p">(</span><span class="n">miles</span><span class="p">,</span><span class="n">from</span><span class="p">)</span>
<a name="ln-304"></a>        <span class="n">from</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-305"></a>        <span class="k">call </span><span class="n">page</span> <span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-306"></a><span class="c">!6150    continue</span>
<a name="ln-307"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">fails</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">6151</span><span class="p">)</span> <span class="n">fails</span>
<a name="ln-308"></a><span class="mi">6151</span>    <span class="k">format</span> <span class="p">(</span><span class="s1">&#39; The number of  FAILUREs  encountered =       &#39;</span><span class="p">,</span><span class="n">i4</span><span class="p">)</span>
<a name="ln-309"></a><span class="c">!6160    continue</span>
<a name="ln-310"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">sdefct</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">6161</span><span class="p">)</span> <span class="n">sdefct</span>
<a name="ln-311"></a><span class="mi">6161</span>    <span class="k">format</span> <span class="p">(</span><span class="s1">&#39; The number of  SERIOUS DEFECTs  discovered = &#39;</span><span class="p">,</span><span class="n">i4</span><span class="p">)</span>
<a name="ln-312"></a><span class="c">!6170    continue</span>
<a name="ln-313"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">defect</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">6171</span><span class="p">)</span> <span class="n">defect</span>
<a name="ln-314"></a><span class="mi">6171</span>    <span class="k">format</span> <span class="p">(</span><span class="s1">&#39; The number of  DEFECTs  discovered =         &#39;</span><span class="p">,</span><span class="n">i4</span><span class="p">)</span>
<a name="ln-315"></a><span class="c">!6180    continue</span>
<a name="ln-316"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">flaws</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">6181</span><span class="p">)</span> <span class="n">flaws</span>
<a name="ln-317"></a><span class="mi">6181</span>    <span class="k">format</span> <span class="p">(</span><span class="s1">&#39; The number of  FLAWs  discovered =           &#39;</span><span class="p">,</span><span class="n">i4</span><span class="p">)</span>
<a name="ln-318"></a><span class="c">!6190    continue</span>
<a name="ln-319"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">fails</span><span class="o">+</span><span class="n">sdefct</span><span class="o">+</span><span class="n">defect</span><span class="o">+</span><span class="n">flaws</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">6270</span>
<a name="ln-320"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">6200</span><span class="p">)</span>
<a name="ln-321"></a><span class="mi">6200</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; No failures, defects nor flaws have been discovered.&#39;</span><span class="p">)</span>
<a name="ln-322"></a><span class="c">!6210    continue</span>
<a name="ln-323"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">r1</span><span class="o">+</span><span class="n">r2</span><span class="o">+</span><span class="n">r3</span><span class="o">+</span><span class="n">r4</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">fp4</span><span class="p">)</span> <span class="k">goto </span><span class="mi">6260</span>
<a name="ln-324"></a><span class="c">!6220    continue</span>
<a name="ln-325"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">sticky</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">fp1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="nb">radix</span><span class="o">-</span><span class="n">fp2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">radix</span><span class="o">-</span><span class="n">fp9</span><span class="o">-</span><span class="n">fp1</span><span class="p">)</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span><span class="k">goto </span><span class="mi">6250</span>
<a name="ln-326"></a><span class="c">!6230    continue</span>
<a name="ln-327"></a>        <span class="n">temp</span> <span class="o">=</span> <span class="mi">854</span>
<a name="ln-328"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">radix</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp2</span> <span class="p">.</span><span class="nb">and</span><span class="p">.(</span><span class="n">precis</span> <span class="o">-</span> <span class="n">fp4</span><span class="o">*</span><span class="n">fp3</span><span class="o">*</span><span class="n">fp2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">precis</span> <span class="o">-</span> <span class="n">fp27</span><span class="o">-</span><span class="n">fp27</span><span class="o">+</span><span class="n">fp1</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="n">temp</span> <span class="o">=</span> <span class="mi">754</span>
<a name="ln-329"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">6240</span><span class="p">)</span> <span class="n">temp</span>
<a name="ln-330"></a><span class="mi">6240</span>    <span class="k">format</span> <span class="p">(</span><span class="s1">&#39; Rounding appears to conform to the proposed IEEE standard  P&#39;</span><span class="p">,</span> <span class="n">i3</span><span class="p">)</span>
<a name="ln-331"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ieee</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">6241</span><span class="p">)</span>
<a name="ln-332"></a><span class="mi">6241</span>    <span class="k">format</span> <span class="p">(</span><span class="s1">&#39; except possibly for Single Rounding during Gradual Underflow.&#39;</span><span class="p">)</span>
<a name="ln-333"></a><span class="mi">6250</span>    <span class="k">continue</span>
<a name="ln-334"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">6251</span><span class="p">)</span>
<a name="ln-335"></a><span class="mi">6251</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; The arithmetic diagnosed appears to be Excellent!&#39;</span><span class="p">)</span>
<a name="ln-336"></a>        <span class="k">goto </span><span class="mi">6310</span>
<a name="ln-337"></a><span class="mi">6260</span>    <span class="k">continue</span>
<a name="ln-338"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">6261</span><span class="p">)</span>
<a name="ln-339"></a><span class="mi">6261</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; The arithmetic diagnosed seems Satisfactory.&#39;</span><span class="p">)</span>
<a name="ln-340"></a>        <span class="k">goto </span><span class="mi">6310</span>
<a name="ln-341"></a><span class="mi">6270</span>    <span class="k">continue</span>
<a name="ln-342"></a><span class="k">        if</span> <span class="p">(</span><span class="n">fails</span><span class="o">+</span><span class="n">sdefct</span><span class="o">+</span><span class="n">defect</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">flaws</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">6271</span><span class="p">)</span>
<a name="ln-343"></a><span class="mi">6271</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; The arithmetic diagnosed seems Satisfactory though flawed.&#39;</span><span class="p">)</span>
<a name="ln-344"></a><span class="c">!6280    continue</span>
<a name="ln-345"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">fails</span><span class="o">+</span><span class="n">sdefct</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">defect</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">6281</span><span class="p">)</span>
<a name="ln-346"></a><span class="mi">6281</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; The arithmetic diagnosed may be Acceptable despite inconvenient Defects.&#39;</span><span class="p">)</span>
<a name="ln-347"></a><span class="c">!6290    continue</span>
<a name="ln-348"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">fails</span><span class="o">+</span><span class="n">sdefct</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">6291</span><span class="p">)</span>
<a name="ln-349"></a><span class="mi">6291</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; The arithmetic diagnosed has unacceptable Serious Defects.&#39;</span><span class="p">)</span>
<a name="ln-350"></a><span class="c">!6300    continue</span>
<a name="ln-351"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">fails</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">6301</span><span class="p">)</span>
<a name="ln-352"></a><span class="mi">6301</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Potentially fatal FAILURE may have spoiled this program&#39;&#39;s subsequent diagnoses.&#39;</span><span class="p">)</span>
<a name="ln-353"></a><span class="mi">6310</span>    <span class="k">continue</span>
<a name="ln-354"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">6311</span><span class="p">)</span>
<a name="ln-355"></a><span class="mi">6311</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; End of Test.&#39;</span><span class="p">)</span>
<a name="ln-356"></a>        <span class="k">return</span>
<a name="ln-357"></a><span class="k">        end subroutine </span><span class="n">runtests</span>
<a name="ln-358"></a><span class="c">!#######################################################################</span>
<a name="ln-359"></a>      <span class="k">subroutine </span><span class="n">commut</span><span class="p">(</span> <span class="n">numtry</span><span class="p">)</span>
<a name="ln-360"></a>      <span class="k">implicit none</span>
<a name="ln-361"></a><span class="c">!</span>
<a name="ln-362"></a><span class="c">!</span>
<a name="ln-363"></a>        <span class="kt">integer </span><span class="n">numtry</span>
<a name="ln-364"></a>        <span class="kt">real </span><span class="n">r9</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x9</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y9</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">z9</span>
<a name="ln-365"></a>        <span class="kt">integer </span><span class="n">i</span><span class="p">,</span> <span class="n">nn</span>
<a name="ln-366"></a><span class="c">!</span>
<a name="ln-367"></a><span class="c">!2920    continue</span>
<a name="ln-368"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2921</span><span class="p">)</span> <span class="n">numtry</span>
<a name="ln-369"></a><span class="mi">2921</span>    <span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="s1">&#39; Does multiplication commute? Testing if  x*y = y*x  for&#39;</span><span class="p">,</span> <span class="n">i4</span><span class="p">,</span><span class="s1">&#39; random pairs:&#39;</span><span class="p">)</span>
<a name="ln-370"></a><span class="c">!2930    continue</span>
<a name="ln-371"></a>        <span class="n">r9</span> <span class="o">=</span>  <span class="nb">sqrt</span><span class="p">(</span><span class="n">fp3</span><span class="p">)</span>
<a name="ln-372"></a>        <span class="n">i</span> <span class="o">=</span> <span class="n">numtry</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-373"></a>        <span class="n">x9</span> <span class="o">=</span> <span class="n">fp0</span> <span class="o">/</span> <span class="n">fp3</span>
<a name="ln-374"></a><span class="mi">2960</span>    <span class="k">continue</span>
<a name="ln-375"></a><span class="k">        call </span><span class="n">random</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x9</span><span class="p">,</span> <span class="n">r9</span><span class="p">)</span>
<a name="ln-376"></a>        <span class="n">y9</span><span class="o">=</span><span class="n">x9</span>
<a name="ln-377"></a>        <span class="k">call </span><span class="n">random</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x9</span><span class="p">,</span> <span class="n">r9</span><span class="p">)</span>
<a name="ln-378"></a>        <span class="n">z</span><span class="o">=</span><span class="n">x9</span><span class="o">*</span><span class="n">y9</span>
<a name="ln-379"></a>        <span class="n">y</span><span class="o">=</span><span class="n">y9</span><span class="o">*</span><span class="n">x9</span>
<a name="ln-380"></a>        <span class="n">z9</span><span class="o">=</span><span class="n">z</span><span class="o">-</span><span class="n">y</span>
<a name="ln-381"></a>        <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-382"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">z9</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2960</span>
<a name="ln-383"></a><span class="c">!2970    continue</span>
<a name="ln-384"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3000</span>
<a name="ln-385"></a><span class="c">!2980    continue</span>
<a name="ln-386"></a>        <span class="n">x9</span><span class="o">=</span><span class="n">fp0</span><span class="o">+</span><span class="n">half</span><span class="o">/</span><span class="n">fp3</span>
<a name="ln-387"></a>        <span class="n">y9</span><span class="o">=</span><span class="p">(</span><span class="n">ulppls</span><span class="o">+</span><span class="n">ulpmin</span><span class="p">)</span><span class="o">+</span><span class="n">fp0</span>
<a name="ln-388"></a>        <span class="n">z</span><span class="o">=</span><span class="n">x9</span><span class="o">*</span><span class="n">y9</span>
<a name="ln-389"></a>        <span class="n">y</span><span class="o">=</span><span class="n">y9</span><span class="o">*</span><span class="n">x9</span>
<a name="ln-390"></a>        <span class="n">z9</span><span class="o">=</span><span class="p">(</span><span class="n">fp0</span><span class="o">+</span><span class="n">half</span><span class="o">/</span><span class="n">fp3</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">ulppls</span><span class="o">+</span><span class="n">ulpmin</span><span class="p">)</span><span class="o">+</span><span class="n">fp0</span><span class="p">)</span><span class="o">-</span><span class="p">((</span><span class="n">ulppls</span><span class="o">+</span><span class="n">ulpmin</span><span class="p">)</span><span class="o">+</span><span class="n">fp0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fp0</span><span class="o">+</span><span class="n">half</span><span class="o">/</span><span class="n">fp3</span><span class="p">)</span>
<a name="ln-391"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">z9</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3000</span>
<a name="ln-392"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2990</span><span class="p">)</span> <span class="n">numtry</span>
<a name="ln-393"></a><span class="mi">2990</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; No failure found in &#39;</span><span class="p">,</span><span class="n">i4</span><span class="p">,</span><span class="s1">&#39; randomly chosen pairs.&#39;</span><span class="p">)</span>
<a name="ln-394"></a>        <span class="k">return</span>
<a name="ln-395"></a><span class="mi">3000</span>    <span class="k">continue</span>
<a name="ln-396"></a><span class="k">        </span><span class="n">defect</span><span class="o">=</span><span class="n">defect</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-397"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">3001</span><span class="p">)</span> <span class="n">x9</span><span class="p">,</span> <span class="n">y9</span>
<a name="ln-398"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">3002</span><span class="p">)</span> <span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z9</span>
<a name="ln-399"></a>        <span class="n">nn</span><span class="o">=</span><span class="n">numtry</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-400"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">3003</span><span class="p">)</span> <span class="n">nn</span>
<a name="ln-401"></a><span class="mi">3001</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; DEFECT:  x*y = y*x  violated at  x = &#39;</span><span class="p">,</span><span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">,</span><span class="s1">&#39;, y = &#39;</span><span class="p">,</span><span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-402"></a><span class="mi">3002</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  x*y =&#39;</span><span class="p">,</span><span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">,</span><span class="s1">&#39;,  y*x =&#39;</span><span class="p">,</span><span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">,</span><span class="s1">&#39;,  x*y-y*x =&#39;</span><span class="p">,</span><span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-403"></a><span class="mi">3003</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;    ... pair no.&#39;</span><span class="p">,</span> <span class="n">i4</span><span class="p">)</span>
<a name="ln-404"></a>        <span class="k">return</span>
<a name="ln-405"></a><span class="k">        end subroutine </span><span class="n">commut</span>
<a name="ln-406"></a><span class="c">!#######################################################################</span>
<a name="ln-407"></a><span class="c">!---</span>
<a name="ln-408"></a>      <span class="k">subroutine </span><span class="n">random</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x9</span><span class="p">,</span> <span class="n">r9</span><span class="p">)</span>
<a name="ln-409"></a>      <span class="k">implicit none</span>
<a name="ln-410"></a><span class="k">        </span><span class="kt">real </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x9</span><span class="p">,</span> <span class="n">r9</span>
<a name="ln-411"></a><span class="c">!2950    continue</span>
<a name="ln-412"></a>        <span class="n">x</span><span class="o">=</span><span class="n">x9</span><span class="o">+</span><span class="n">r9</span>
<a name="ln-413"></a>        <span class="n">y</span><span class="o">=</span><span class="n">x</span><span class="o">*</span><span class="n">x</span>
<a name="ln-414"></a>        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">*</span><span class="n">y</span>
<a name="ln-415"></a>        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">*</span><span class="n">y</span>
<a name="ln-416"></a>        <span class="n">y</span><span class="o">=</span><span class="n">x</span><span class="o">-</span><span class="nb">aint</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="ln-417"></a>        <span class="n">x9</span><span class="o">=</span><span class="n">y</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="p">.</span><span class="mi">000005</span>
<a name="ln-418"></a>        <span class="k">return</span>
<a name="ln-419"></a><span class="k">        end subroutine </span><span class="n">random</span>
<a name="ln-420"></a><span class="c">!#######################################################################</span>
<a name="ln-421"></a><span class="c">!---</span>
<a name="ln-422"></a>      <span class="k">subroutine </span><span class="n">extra</span>
<a name="ln-423"></a>      <span class="k">implicit none</span>
<a name="ln-424"></a><span class="c">!</span>
<a name="ln-425"></a><span class="c">!</span>
<a name="ln-426"></a>        <span class="kt">real </span><span class="n">q</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span> <span class="n">xx</span>
<a name="ln-427"></a><span class="c">!</span>
<a name="ln-428"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1681</span><span class="p">)</span>
<a name="ln-429"></a><span class="mi">1681</span>    <span class="k">format</span> <span class="p">(</span><span class="s1">&#39; Test for extra-precise subexpressions:&#39;</span><span class="p">)</span>
<a name="ln-430"></a><span class="c">!</span>
<a name="ln-431"></a><span class="c">!1690    continue</span>
<a name="ln-432"></a>        <span class="n">x</span> <span class="o">=</span>  <span class="nb">abs</span><span class="p">(</span> <span class="p">((</span><span class="n">fp4</span> <span class="o">/</span> <span class="n">fp3</span> <span class="o">-</span> <span class="n">fp1</span><span class="p">)</span> <span class="o">-</span> <span class="n">fp1</span> <span class="o">/</span> <span class="n">fp4</span><span class="p">)</span> <span class="o">*</span> <span class="n">fp3</span> <span class="o">-</span> <span class="n">fp1</span> <span class="o">/</span> <span class="n">fp4</span><span class="p">)</span>
<a name="ln-433"></a><span class="mi">1700</span>    <span class="k">continue</span>
<a name="ln-434"></a><span class="k">        </span><span class="n">z2</span> <span class="o">=</span> <span class="n">x</span>
<a name="ln-435"></a>        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">fp1</span> <span class="o">+</span> <span class="p">(</span><span class="n">half</span> <span class="o">*</span> <span class="n">z2</span> <span class="o">+</span> <span class="n">fp32</span> <span class="o">*</span> <span class="n">z2</span> <span class="o">*</span> <span class="n">z2</span><span class="p">))</span> <span class="o">-</span> <span class="n">fp1</span>
<a name="ln-436"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">z2</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">x</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">x</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1700</span>
<a name="ln-437"></a><span class="c">!1710    continue</span>
<a name="ln-438"></a>        <span class="n">y</span> <span class="o">=</span>  <span class="nb">abs</span><span class="p">(</span> <span class="p">(</span><span class="n">fp3</span><span class="o">/</span><span class="n">fp4</span> <span class="o">-</span> <span class="n">fp2</span><span class="o">/</span><span class="n">fp3</span><span class="p">)</span> <span class="o">*</span> <span class="n">fp3</span> <span class="o">-</span> <span class="n">fp1</span><span class="o">/</span><span class="n">fp4</span><span class="p">)</span>
<a name="ln-439"></a>        <span class="n">z</span><span class="o">=</span><span class="n">y</span>
<a name="ln-440"></a>        <span class="n">x</span><span class="o">=</span><span class="n">y</span>
<a name="ln-441"></a><span class="mi">1720</span>    <span class="k">continue</span>
<a name="ln-442"></a><span class="k">        </span><span class="n">z1</span><span class="o">=</span><span class="n">z</span>
<a name="ln-443"></a>        <span class="n">z</span><span class="o">=</span><span class="p">(</span><span class="n">fp1</span><span class="o">/</span><span class="n">fp2</span> <span class="o">-</span> <span class="p">((</span><span class="n">fp1</span><span class="o">/</span><span class="n">fp2</span><span class="o">-</span><span class="p">(</span><span class="n">half</span><span class="o">*</span><span class="n">z1</span> <span class="o">+</span> <span class="n">fp32</span><span class="o">*</span><span class="n">z1</span><span class="o">*</span><span class="n">z1</span><span class="p">))</span><span class="o">+</span><span class="n">fp1</span><span class="o">/</span><span class="n">fp2</span><span class="p">))</span> <span class="o">+</span> <span class="n">fp1</span><span class="o">/</span><span class="n">fp2</span>
<a name="ln-444"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">z1</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">z</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">z</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1720</span>
<a name="ln-445"></a><span class="mi">1730</span>    <span class="k">continue</span>
<a name="ln-446"></a><span class="k">        </span><span class="n">y1</span><span class="o">=</span><span class="n">y</span>
<a name="ln-447"></a>        <span class="n">y</span><span class="o">=</span><span class="p">(</span><span class="n">half</span> <span class="o">-</span> <span class="p">((</span><span class="n">half</span><span class="o">-</span><span class="p">(</span><span class="n">half</span><span class="o">*</span><span class="n">y1</span> <span class="o">+</span> <span class="n">fp32</span><span class="o">*</span><span class="n">y1</span><span class="o">*</span><span class="n">y1</span><span class="p">))</span><span class="o">+</span><span class="n">half</span><span class="p">))</span> <span class="o">+</span> <span class="n">half</span>
<a name="ln-448"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">y1</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">y</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">y</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1730</span>
<a name="ln-449"></a><span class="c">!1740    continue</span>
<a name="ln-450"></a>        <span class="n">x1</span><span class="o">=</span><span class="n">x</span>
<a name="ln-451"></a>        <span class="n">x</span><span class="o">=</span><span class="p">((</span><span class="n">half</span><span class="o">*</span><span class="n">x1</span><span class="o">+</span><span class="n">fp32</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">-</span><span class="n">onemin</span><span class="p">)</span><span class="o">+</span><span class="n">onemin</span>
<a name="ln-452"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x1</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">x</span>  <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">x</span>  <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1730</span>
<a name="ln-453"></a><span class="c">!1750    continue</span>
<a name="ln-454"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x1</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">y1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">x1</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">z1</span><span class="p">)</span>  <span class="k">goto </span><span class="mi">1780</span>
<a name="ln-455"></a><span class="c">!1760    continue</span>
<a name="ln-456"></a>        <span class="n">sdefct</span><span class="o">=</span><span class="n">sdefct</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-457"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1761</span><span class="p">)</span>
<a name="ln-458"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1762</span><span class="p">)</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span>
<a name="ln-459"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1763</span><span class="p">)</span>
<a name="ln-460"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1770</span><span class="p">)</span>
<a name="ln-461"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1771</span><span class="p">)</span>
<a name="ln-462"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1772</span><span class="p">)</span>
<a name="ln-463"></a><span class="mi">1761</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; SERIOUS DEFECT: disagreements among the values  X1, Y1, Z1&#39;</span><span class="p">)</span>
<a name="ln-464"></a><span class="mi">1762</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; respectively &#39;</span><span class="p">,</span><span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">,</span><span class="s1">&#39;,    &#39;</span><span class="p">,</span><span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">,</span><span class="s1">&#39;,    &#39;</span><span class="p">,</span><span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-465"></a><span class="mi">1763</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; are symptoms of inconsistencies introduced by extra-precise&#39;</span><span class="p">)</span>
<a name="ln-466"></a><span class="mi">1770</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; evaluation of allegedly  &quot;optimized&quot;  arithmetic&#39;</span><span class="p">)</span>
<a name="ln-467"></a><span class="mi">1771</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; subexpressions.  Possibly some part of this&#39;</span><span class="p">)</span>
<a name="ln-468"></a><span class="mi">1772</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; test is inconsistent; PLEASE NOTIFY KARPINSKI !&#39;</span><span class="p">)</span>
<a name="ln-469"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x1</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">ulpmin</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">y1</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">ulpmin</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">z1</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">ulpmin</span><span class="p">)</span><span class="k">goto </span><span class="mi">1850</span>
<a name="ln-470"></a><span class="mi">1780</span>    <span class="k">continue</span>
<a name="ln-471"></a><span class="k">        if</span> <span class="p">(</span><span class="n">z1</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">ulpmin</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">z2</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">ulppls</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1790</span>
<a name="ln-472"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1781</span><span class="p">)</span>
<a name="ln-473"></a><span class="mi">1781</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Subexpressions do not appear to be calculated with extra precision.&#39;</span><span class="p">)</span>
<a name="ln-474"></a>        <span class="k">return</span>
<a name="ln-475"></a><span class="mi">1790</span>    <span class="k">continue</span>
<a name="ln-476"></a><span class="k">        if</span> <span class="p">(</span><span class="n">z1</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">ulpmin</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">z2</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">ulppls</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1810</span>
<a name="ln-477"></a><span class="c">!1800    continue</span>
<a name="ln-478"></a>        <span class="n">fails</span><span class="o">=</span><span class="n">fails</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-479"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1801</span><span class="p">)</span>
<a name="ln-480"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1802</span><span class="p">)</span>
<a name="ln-481"></a>        <span class="n">xx</span><span class="o">=</span><span class="n">z1</span><span class="o">-</span><span class="n">ulpmin</span>
<a name="ln-482"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1803</span><span class="p">)</span> <span class="n">ulpmin</span><span class="p">,</span> <span class="n">xx</span>
<a name="ln-483"></a>        <span class="n">xx</span><span class="o">=</span><span class="n">z2</span><span class="o">-</span><span class="n">ulppls</span>
<a name="ln-484"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1804</span><span class="p">)</span> <span class="n">ulppls</span><span class="p">,</span> <span class="n">xx</span>
<a name="ln-485"></a><span class="mi">1801</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE: precision test is inconsistent.&#39;</span><span class="p">)</span>
<a name="ln-486"></a><span class="mi">1802</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; PLEASE NOTIFY KARPINSKI !&#39;</span><span class="p">)</span>
<a name="ln-487"></a><span class="mi">1803</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; ulpmin =  &#39;</span><span class="p">,</span> <span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;    z1 - ulpmin = &#39;</span><span class="p">,</span> <span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-488"></a><span class="mi">1804</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; ulppls =  &#39;</span><span class="p">,</span> <span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;    z1 - ulppls = &#39;</span><span class="p">,</span> <span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-489"></a>        <span class="k">return</span>
<a name="ln-490"></a><span class="mi">1810</span>    <span class="k">continue</span>
<a name="ln-491"></a><span class="k">        if</span> <span class="p">(</span><span class="n">z1</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">z2</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1830</span>
<a name="ln-492"></a><span class="c">!1820    continue</span>
<a name="ln-493"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1821</span><span class="p">)</span>     <span class="nb">radix</span>
<a name="ln-494"></a><span class="nb">        </span><span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1822</span><span class="p">)</span>
<a name="ln-495"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1823</span><span class="p">)</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span>
<a name="ln-496"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1824</span><span class="p">)</span>
<a name="ln-497"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1825</span><span class="p">)</span>
<a name="ln-498"></a><span class="mi">1821</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Because of an unusual radix  b =&#39;</span><span class="p">,</span> <span class="n">f4</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-499"></a><span class="mi">1822</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; or exact rational arithmetic,&#39;</span><span class="p">)</span>
<a name="ln-500"></a><span class="mi">1823</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; a result  z1 =&#39;</span><span class="p">,</span><span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">,</span><span class="s1">&#39;  or  z2 =&#39;</span><span class="p">,</span><span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-501"></a><span class="mi">1824</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; of an extra-precision test is inconsistent.&#39;</span><span class="p">)</span>
<a name="ln-502"></a><span class="mi">1825</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; PLEASE NOTIFY KARPINSKI !&#39;</span><span class="p">)</span>
<a name="ln-503"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">z1</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">z2</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1850</span>
<a name="ln-504"></a><span class="mi">1830</span>    <span class="k">continue</span>
<a name="ln-505"></a><span class="k">        </span><span class="n">x</span> <span class="o">=</span> <span class="n">z1</span><span class="o">/</span><span class="n">ulpmin</span>
<a name="ln-506"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">z2</span><span class="o">/</span><span class="n">ulppls</span>
<a name="ln-507"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">x</span><span class="p">)</span> <span class="n">x</span><span class="o">=</span><span class="n">y</span>
<a name="ln-508"></a><span class="c">!1840    continue</span>
<a name="ln-509"></a>        <span class="n">q</span> <span class="o">=</span> <span class="o">-</span><span class="nb">alog</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="ln-510"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1841</span><span class="p">)</span>
<a name="ln-511"></a>        <span class="n">xx</span><span class="o">=</span><span class="n">q</span><span class="o">/</span><span class="nb">alog</span><span class="p">(</span><span class="nb">radix</span><span class="p">)</span>
<a name="ln-512"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1842</span><span class="p">)</span> <span class="n">xx</span>
<a name="ln-513"></a>        <span class="n">xx</span><span class="o">=</span><span class="n">q</span><span class="o">/</span><span class="nb">alog</span><span class="p">(</span><span class="n">fp8</span><span class="o">+</span><span class="n">fp2</span><span class="p">)</span>
<a name="ln-514"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1843</span><span class="p">)</span> <span class="n">xx</span>
<a name="ln-515"></a><span class="mi">1841</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Some subexpressions appear to be calculated extra-precisely&#39;</span><span class="p">)</span>
<a name="ln-516"></a><span class="mi">1842</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; with about   &#39;</span><span class="p">,</span><span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">,</span><span class="s1">&#39; extra base b digits, i.e.&#39;</span><span class="p">)</span>
<a name="ln-517"></a><span class="mi">1843</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; roughly &#39;</span><span class="p">,</span><span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">,</span><span class="s1">&#39; extra significant decimals.&#39;</span><span class="p">)</span>
<a name="ln-518"></a><span class="mi">1850</span>    <span class="k">continue</span>
<a name="ln-519"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1851</span><span class="p">)</span>
<a name="ln-520"></a><span class="mi">1851</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; That feature is not tested further by this program.&#39;</span><span class="p">)</span>
<a name="ln-521"></a>        <span class="k">return</span>
<a name="ln-522"></a><span class="k">        end subroutine </span><span class="n">extra</span>
<a name="ln-523"></a><span class="c">!#######################################################################</span>
<a name="ln-524"></a><span class="c">!---</span>
<a name="ln-525"></a>      <span class="k">subroutine </span><span class="n">guard</span>
<a name="ln-526"></a>      <span class="k">implicit none</span>
<a name="ln-527"></a><span class="c">!</span>
<a name="ln-528"></a><span class="c">!</span>
<a name="ln-529"></a><span class="c">!        ... LOCAL VARIABLES</span>
<a name="ln-530"></a>        <span class="kt">real </span><span class="n">r</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span>
<a name="ln-531"></a><span class="c">!        ... CONSTANTS</span>
<a name="ln-532"></a>        <span class="kt">real </span><span class="n">b9</span>
<a name="ln-533"></a><span class="c">!</span>
<a name="ln-534"></a>        <span class="n">b9</span> <span class="o">=</span> <span class="nb">radix</span> <span class="o">-</span> <span class="n">ulppls</span>
<a name="ln-535"></a><span class="c">!</span>
<a name="ln-536"></a><span class="c">!1040    continue</span>
<a name="ln-537"></a>        <span class="n">mulgrd</span> <span class="o">=</span> <span class="mf">1.0</span>
<a name="ln-538"></a>        <span class="n">divgrd</span> <span class="o">=</span> <span class="mf">1.0</span>
<a name="ln-539"></a>        <span class="n">subgrd</span> <span class="o">=</span> <span class="mf">1.0</span>
<a name="ln-540"></a><span class="c">!</span>
<a name="ln-541"></a><span class="c">!1880    continue</span>
<a name="ln-542"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">radix</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">fp2</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1920</span>
<a name="ln-543"></a><span class="c">!1890    continue</span>
<a name="ln-544"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">w</span> <span class="o">/</span> <span class="p">(</span><span class="nb">radix</span> <span class="o">*</span> <span class="nb">radix</span><span class="p">)</span>
<a name="ln-545"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">fp1</span>
<a name="ln-546"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">x</span>
<a name="ln-547"></a>        <span class="n">t</span> <span class="o">=</span> <span class="n">z</span> <span class="o">+</span> <span class="n">ulppls</span>
<a name="ln-548"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">t</span> <span class="o">-</span> <span class="n">z</span>
<a name="ln-549"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">ulppls</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1910</span>
<a name="ln-550"></a><span class="c">!1900    continue</span>
<a name="ln-551"></a>        <span class="n">fails</span> <span class="o">=</span> <span class="n">fails</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-552"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1905</span><span class="p">)</span>
<a name="ln-553"></a><span class="mi">1905</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE: subtraction is not normalized so  x=y  does not imply  x+z=y+z !&#39;</span><span class="p">)</span>
<a name="ln-554"></a>        <span class="k">goto </span><span class="mi">1920</span>
<a name="ln-555"></a><span class="mi">1910</span>    <span class="k">continue</span>
<a name="ln-556"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1911</span><span class="p">)</span>
<a name="ln-557"></a><span class="mi">1911</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Subtraction appears to be normalized as it should.&#39;</span><span class="p">)</span>
<a name="ln-558"></a><span class="mi">1920</span>    <span class="k">continue</span>
<a name="ln-559"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1930</span><span class="p">)</span>
<a name="ln-560"></a><span class="mi">1930</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Checking for guard digits in multiply divide and subtract.&#39;</span><span class="p">)</span>
<a name="ln-561"></a><span class="c">!1940    continue</span>
<a name="ln-562"></a>        <span class="n">y</span><span class="o">=</span><span class="n">onemin</span><span class="o">*</span><span class="n">fp1</span>
<a name="ln-563"></a>        <span class="n">z</span><span class="o">=</span><span class="n">fp1</span><span class="o">*</span><span class="n">onemin</span>
<a name="ln-564"></a>        <span class="n">x</span><span class="o">=</span><span class="n">onemin</span><span class="o">-</span><span class="n">half</span>
<a name="ln-565"></a>        <span class="n">y</span><span class="o">=</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">half</span><span class="p">)</span><span class="o">-</span><span class="n">x</span>
<a name="ln-566"></a>        <span class="n">z</span><span class="o">=</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">half</span><span class="p">)</span><span class="o">-</span><span class="n">x</span>
<a name="ln-567"></a>        <span class="n">x</span><span class="o">=</span><span class="n">fp1</span><span class="o">+</span><span class="n">ulppls</span>
<a name="ln-568"></a>        <span class="n">t</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="nb">radix</span>
<a name="ln-569"></a><span class="c">!1950    continue</span>
<a name="ln-570"></a>        <span class="n">r</span> <span class="o">=</span> <span class="nb">radix</span> <span class="o">*</span> <span class="n">x</span>
<a name="ln-571"></a>        <span class="n">x</span><span class="o">=</span><span class="n">t</span><span class="o">-</span><span class="nb">radix</span>
<a name="ln-572"></a><span class="nb">        </span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">-</span><span class="nb">radix</span><span class="o">*</span><span class="n">ulppls</span>
<a name="ln-573"></a>        <span class="n">t</span><span class="o">=</span><span class="n">r</span><span class="o">-</span><span class="nb">radix</span>
<a name="ln-574"></a><span class="nb">        </span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="o">-</span><span class="nb">radix</span><span class="o">*</span><span class="n">ulppls</span>
<a name="ln-575"></a>        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="nb">radix</span><span class="o">-</span><span class="n">fp1</span><span class="p">)</span>
<a name="ln-576"></a>        <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="nb">radix</span><span class="o">-</span><span class="n">fp1</span><span class="p">)</span>
<a name="ln-577"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">y</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">z</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">t</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span><span class="k">goto </span><span class="mi">1980</span>
<a name="ln-578"></a><span class="c">!1960    continue</span>
<a name="ln-579"></a>        <span class="n">sdefct</span><span class="o">=</span><span class="n">sdefct</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-580"></a><span class="c">!1970    continue</span>
<a name="ln-581"></a>        <span class="n">mulgrd</span><span class="o">=</span><span class="n">fp0</span>
<a name="ln-582"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1971</span><span class="p">)</span>
<a name="ln-583"></a><span class="mi">1971</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; SERIOUS DEFECT: multiplication lacks a guard digit violating  1*x = x .&#39;</span><span class="p">)</span>
<a name="ln-584"></a><span class="mi">1980</span>    <span class="k">continue</span>
<a name="ln-585"></a><span class="k">        </span><span class="n">z</span> <span class="o">=</span> <span class="nb">radix</span> <span class="o">*</span> <span class="n">ulppls</span>
<a name="ln-586"></a>        <span class="n">x</span><span class="o">=</span><span class="n">fp1</span><span class="o">+</span><span class="n">z</span>
<a name="ln-587"></a>        <span class="n">y</span><span class="o">=</span> <span class="nb">abs</span><span class="p">((</span><span class="n">x</span><span class="o">+</span><span class="n">z</span><span class="p">)</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">ulppls</span>
<a name="ln-588"></a>        <span class="n">x</span><span class="o">=</span><span class="n">fp1</span><span class="o">-</span><span class="n">ulppls</span>
<a name="ln-589"></a>        <span class="n">z</span><span class="o">=</span> <span class="nb">abs</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">ulppls</span><span class="p">)</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">ulpmin</span>
<a name="ln-590"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">z</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2000</span>
<a name="ln-591"></a><span class="c">!1990    continue</span>
<a name="ln-592"></a>        <span class="n">fails</span><span class="o">=</span><span class="n">fails</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-593"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">1991</span><span class="p">)</span>
<a name="ln-594"></a><span class="mi">1991</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE: multiplication  gets too many last digits wrong.&#39;</span><span class="p">)</span>
<a name="ln-595"></a><span class="mi">2000</span>    <span class="k">continue</span>
<a name="ln-596"></a><span class="k">        </span><span class="n">y</span><span class="o">=</span><span class="n">fp1</span><span class="o">-</span><span class="n">ulppls</span>
<a name="ln-597"></a>        <span class="n">x</span><span class="o">=</span><span class="n">fp1</span><span class="o">+</span><span class="n">ulppls</span>
<a name="ln-598"></a>        <span class="n">z</span><span class="o">=</span><span class="n">fp1</span><span class="o">/</span><span class="n">y</span>
<a name="ln-599"></a>        <span class="n">y</span><span class="o">=</span><span class="n">z</span><span class="o">-</span><span class="n">x</span>
<a name="ln-600"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">fp1</span><span class="o">/</span><span class="n">fp3</span>
<a name="ln-601"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">fp3</span><span class="o">/</span><span class="n">fp9</span>
<a name="ln-602"></a>        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">-</span><span class="n">z</span>
<a name="ln-603"></a>        <span class="n">t</span> <span class="o">=</span> <span class="n">fp9</span><span class="o">/</span><span class="n">fp27</span>
<a name="ln-604"></a><span class="c">!2010    continue</span>
<a name="ln-605"></a>        <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="o">-</span><span class="n">t</span>
<a name="ln-606"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">y</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">z</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2040</span>
<a name="ln-607"></a><span class="c">!2020    continue</span>
<a name="ln-608"></a>        <span class="n">defect</span><span class="o">=</span><span class="n">defect</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-609"></a><span class="c">!2030    continue</span>
<a name="ln-610"></a>        <span class="n">divgrd</span><span class="o">=</span><span class="n">fp0</span>
<a name="ln-611"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2031</span><span class="p">)</span>
<a name="ln-612"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2032</span><span class="p">)</span>
<a name="ln-613"></a><span class="mi">2031</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; DEFECT: division lacks a guard digit so error can exceed 1 ulp&#39;</span><span class="p">)</span>
<a name="ln-614"></a><span class="mi">2032</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; or  1/3  and  3/9  and  9/27  may disagree.&#39;</span><span class="p">)</span>
<a name="ln-615"></a><span class="mi">2040</span>    <span class="k">continue</span>
<a name="ln-616"></a><span class="k">        </span><span class="n">y</span><span class="o">=</span><span class="n">onemin</span><span class="o">/</span><span class="n">fp1</span>
<a name="ln-617"></a>        <span class="n">x</span><span class="o">=</span><span class="n">onemin</span><span class="o">-</span><span class="n">half</span>
<a name="ln-618"></a>        <span class="n">y</span><span class="o">=</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">half</span><span class="p">)</span><span class="o">-</span><span class="n">x</span>
<a name="ln-619"></a>        <span class="n">x</span><span class="o">=</span><span class="n">fp1</span><span class="o">+</span><span class="n">ulppls</span>
<a name="ln-620"></a>        <span class="n">t</span><span class="o">=</span><span class="n">x</span><span class="o">/</span><span class="n">fp1</span>
<a name="ln-621"></a>        <span class="n">x</span><span class="o">=</span><span class="n">t</span><span class="o">-</span><span class="n">x</span>
<a name="ln-622"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">y</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2070</span>
<a name="ln-623"></a><span class="c">!2050    continue</span>
<a name="ln-624"></a>        <span class="n">sdefct</span> <span class="o">=</span> <span class="n">sdefct</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-625"></a>        <span class="n">defect</span> <span class="o">=</span> <span class="n">defect</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">divgrd</span>
<a name="ln-626"></a><span class="c">!2060    continue</span>
<a name="ln-627"></a>        <span class="n">divgrd</span><span class="o">=</span><span class="n">fp0</span>
<a name="ln-628"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">2061</span><span class="p">)</span>
<a name="ln-629"></a><span class="mi">2061</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; SERIOUS DEFECT:  division lacks a guard digit violating  x/1 = x .&#39;</span><span class="p">)</span>
<a name="ln-630"></a><span class="mi">2070</span>    <span class="k">continue</span>
<a name="ln-631"></a><span class="k">        </span><span class="n">x</span><span class="o">=</span><span class="n">fp1</span><span class="o">/</span><span class="p">(</span><span class="n">fp1</span><span class="o">+</span><span class="n">ulppls</span><span class="p">)</span>
<a name="ln-632"></a>        <span class="n">y</span><span class="o">=</span><span class="n">x</span><span class="o">-</span><span class="n">half</span><span class="o">-</span><span class="n">half</span>
<a name="ln-633"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2100</span>
<a name="ln-634"></a><span class="c">!2080    continue</span>
<a name="ln-635"></a>        <span class="n">sdefct</span><span class="o">=</span><span class="n">sdefct</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-636"></a><span class="c">!2090    continue</span>
<a name="ln-637"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">2091</span><span class="p">)</span>
<a name="ln-638"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">2092</span><span class="p">)</span>
<a name="ln-639"></a><span class="mi">2091</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; VERY SERIOUS DEFECT:  computed value of  1/1.00...001&#39;</span><span class="p">)</span>
<a name="ln-640"></a><span class="mi">2092</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; is not less than  1 .&#39;</span><span class="p">)</span>
<a name="ln-641"></a><span class="mi">2100</span>    <span class="k">continue</span>
<a name="ln-642"></a><span class="k">        </span><span class="n">x</span><span class="o">=</span><span class="n">fp1</span><span class="o">-</span><span class="n">ulppls</span>
<a name="ln-643"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">fp1</span> <span class="o">+</span> <span class="nb">radix</span> <span class="o">*</span> <span class="n">ulppls</span>
<a name="ln-644"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="nb">radix</span>
<a name="ln-645"></a><span class="nb">        </span><span class="n">t</span> <span class="o">=</span> <span class="n">y</span> <span class="o">*</span> <span class="nb">radix</span>
<a name="ln-646"></a><span class="nb">        </span><span class="n">r</span> <span class="o">=</span> <span class="n">z</span> <span class="o">/</span> <span class="nb">radix</span>
<a name="ln-647"></a><span class="nb">        </span><span class="n">s</span> <span class="o">=</span> <span class="n">t</span> <span class="o">/</span> <span class="nb">radix</span>
<a name="ln-648"></a><span class="nb">        </span><span class="n">x</span> <span class="o">=</span> <span class="n">r</span> <span class="o">-</span> <span class="n">x</span>
<a name="ln-649"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">s</span> <span class="o">-</span> <span class="n">y</span>
<a name="ln-650"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">y</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2130</span>
<a name="ln-651"></a><span class="c">!2110    continue</span>
<a name="ln-652"></a>        <span class="n">fails</span> <span class="o">=</span> <span class="n">fails</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-653"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">2120</span><span class="p">)</span>
<a name="ln-654"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">2121</span><span class="p">)</span>
<a name="ln-655"></a><span class="mi">2120</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE: multiplication  and/or  division&#39;</span><span class="p">)</span>
<a name="ln-656"></a><span class="mi">2121</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; gets too many last digits wrong.&#39;</span><span class="p">)</span>
<a name="ln-657"></a><span class="mi">2130</span>    <span class="k">continue</span>
<a name="ln-658"></a><span class="k">        </span><span class="n">y</span> <span class="o">=</span> <span class="n">fp1</span><span class="o">-</span><span class="n">ulpmin</span>
<a name="ln-659"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">fp1</span><span class="o">-</span><span class="n">onemin</span>
<a name="ln-660"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">fp1</span><span class="o">-</span><span class="n">y</span>
<a name="ln-661"></a>        <span class="n">t</span> <span class="o">=</span> <span class="nb">radix</span> <span class="o">-</span> <span class="n">ulppls</span>
<a name="ln-662"></a>        <span class="n">z</span> <span class="o">=</span> <span class="nb">radix</span> <span class="o">-</span> <span class="n">b9</span>
<a name="ln-663"></a>        <span class="n">t</span> <span class="o">=</span> <span class="nb">radix</span> <span class="o">-</span> <span class="n">t</span>
<a name="ln-664"></a><span class="c">!2140    continue</span>
<a name="ln-665"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">ulpmin</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">y</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">ulpmin</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">z</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">ulppls</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="n">t</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">ulppls</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2230</span>
<a name="ln-666"></a><span class="c">!2150    continue</span>
<a name="ln-667"></a>        <span class="n">sdefct</span><span class="o">=</span><span class="n">sdefct</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-668"></a><span class="c">!2160    continue</span>
<a name="ln-669"></a>        <span class="n">subgrd</span><span class="o">=</span><span class="n">fp0</span>
<a name="ln-670"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">2161</span><span class="p">)</span>
<a name="ln-671"></a><span class="mi">2161</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; SERIOUS DEFECT: subtraction lacks a guard digit so cancellation is obscured.&#39;</span><span class="p">)</span>
<a name="ln-672"></a><span class="c">!2170    continue</span>
<a name="ln-673"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">onemin</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">onemin</span><span class="o">-</span><span class="n">fp1</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-674"></a><span class="c">!2180    continue</span>
<a name="ln-675"></a>        <span class="n">sdefct</span><span class="o">=</span><span class="n">sdefct</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-676"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">2190</span><span class="p">)</span>
<a name="ln-677"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">2191</span><span class="p">)</span>
<a name="ln-678"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">2200</span><span class="p">)</span>
<a name="ln-679"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">2210</span><span class="p">)</span>
<a name="ln-680"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">2220</span><span class="p">)</span>
<a name="ln-681"></a><span class="mi">2190</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; VERY SERIOUS DEFECT:&#39;</span><span class="p">)</span>
<a name="ln-682"></a><span class="mi">2191</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;   comparison alleges  (1-ulpmin) &lt; 1  although&#39;</span><span class="p">)</span>
<a name="ln-683"></a><span class="mi">2200</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;   subtraction yields  (1-ulpmin) - 1 = 0, thereby vitiating&#39;</span><span class="p">)</span>
<a name="ln-684"></a><span class="mi">2210</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;   such precautions against division by zero as&#39;</span><span class="p">)</span>
<a name="ln-685"></a><span class="mi">2220</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;   ...  if (x=1.0) then ..... else .../(x-1.0)...&#39;</span><span class="p">)</span>
<a name="ln-686"></a><span class="c">!</span>
<a name="ln-687"></a><span class="mi">2230</span>    <span class="k">continue</span>
<a name="ln-688"></a><span class="k">        if</span> <span class="p">(</span><span class="n">mulgrd</span> <span class="o">*</span> <span class="n">divgrd</span> <span class="o">*</span> <span class="n">subgrd</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp1</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">2231</span><span class="p">)</span>
<a name="ln-689"></a><span class="mi">2231</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; These operations appear to have guard digits as they should.&#39;</span><span class="p">)</span>
<a name="ln-690"></a>        <span class="k">return</span>
<a name="ln-691"></a><span class="k">        end subroutine </span><span class="n">guard</span>
<a name="ln-692"></a><span class="c">!#######################################################################</span>
<a name="ln-693"></a><span class="c">!---</span>
<a name="ln-694"></a>        <span class="k">subroutine </span><span class="n">intro</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-695"></a><span class="c">!CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC</span>
<a name="ln-696"></a><span class="c">!</span>
<a name="ln-697"></a><span class="c">!</span>
<a name="ln-698"></a><span class="c">!</span>
<a name="ln-699"></a><span class="c">!</span>
<a name="ln-700"></a><span class="c">!       PRINT THE LARGE BANNER INTRODUCTION - GOES ON FOR SEVERAL</span>
<a name="ln-701"></a><span class="c">!       PAGES</span>
<a name="ln-702"></a><span class="c">!</span>
<a name="ln-703"></a><span class="c">!</span>
<a name="ln-704"></a><span class="c">!</span>
<a name="ln-705"></a><span class="c">!CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC</span>
<a name="ln-706"></a>      <span class="k">implicit none</span>
<a name="ln-707"></a><span class="k">        </span><span class="kt">integer </span><span class="n">miles</span>
<a name="ln-708"></a><span class="c">!        ... NUMBER OF MILESTONE TO PRINTOUT AS WE GO ALONG</span>
<a name="ln-709"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">170</span><span class="p">)</span>
<a name="ln-710"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">180</span><span class="p">)</span>
<a name="ln-711"></a>        <span class="k">call </span><span class="n">page</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-712"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">190</span><span class="p">)</span>
<a name="ln-713"></a>        <span class="k">call </span><span class="n">page</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-714"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<a name="ln-715"></a><span class="mi">170</span>     <span class="k">format</span><span class="p">(</span>                                                         <span class="p">&amp;</span>
<a name="ln-716"></a>     <span class="p">&amp;</span>    <span class="s1">&#39; Lest this program stop prematurely, i.e. before displaying&#39;</span> <span class="p">&amp;</span>
<a name="ln-717"></a>     <span class="p">&amp;</span>   <span class="o">/</span><span class="s1">&#39;   &quot;End of Test&quot;   &#39;</span>                                         <span class="p">&amp;</span>
<a name="ln-718"></a>     <span class="p">&amp;</span>   <span class="o">/</span><span class="s1">&#39; try to persuade the computer NOT to terminate execution&#39;</span>    <span class="p">&amp;</span>
<a name="ln-719"></a>     <span class="p">&amp;</span>   <span class="o">/</span><span class="s1">&#39; whenever an error such as Over/Underflow or Division by&#39;</span>    <span class="p">&amp;</span>
<a name="ln-720"></a>     <span class="p">&amp;</span>   <span class="o">/</span><span class="s1">&#39; Zero occurs, but rather to persevere with a surrogate value&#39;</span><span class="p">&amp;</span>
<a name="ln-721"></a>     <span class="p">&amp;</span>   <span class="o">/</span><span class="s1">&#39; after, perhaps, displaying some warning.  If persuasion&#39;</span>    <span class="p">&amp;</span>
<a name="ln-722"></a>     <span class="p">&amp;</span>   <span class="o">/</span><span class="s1">&#39; avails naught, don&#39;&#39;t despair but run this program anyway&#39;</span><span class="p">)</span>
<a name="ln-723"></a><span class="mi">180</span>     <span class="k">format</span><span class="p">(</span>                                                         <span class="p">&amp;</span>
<a name="ln-724"></a>     <span class="p">&amp;</span>    <span class="s1">&#39; to see how many milestones it passes, and then run it&#39;</span>      <span class="p">&amp;</span>
<a name="ln-725"></a>     <span class="p">&amp;</span>   <span class="o">/</span><span class="s1">&#39; again.  It should pick up just beyond the error and&#39;</span>        <span class="p">&amp;</span>
<a name="ln-726"></a>     <span class="p">&amp;</span>   <span class="o">/</span><span class="s1">&#39; continue.  If it does not, it needs further debugging.&#39;</span>     <span class="p">&amp;</span>
<a name="ln-727"></a>     <span class="p">&amp;</span>  <span class="o">//</span><span class="s1">&#39; Users are invited to help debug and augment this program&#39;</span>   <span class="p">&amp;</span>
<a name="ln-728"></a>     <span class="p">&amp;</span>   <span class="o">/</span><span class="s1">&#39; so that it will cope with unanticipated and newly found&#39;</span>    <span class="p">&amp;</span>
<a name="ln-729"></a>     <span class="p">&amp;</span>   <span class="o">/</span><span class="s1">&#39; compilers and arithmetic pathologies.&#39;</span><span class="p">)</span>
<a name="ln-730"></a><span class="mi">190</span>     <span class="k">format</span><span class="p">(</span>                                                         <span class="p">&amp;</span>
<a name="ln-731"></a>     <span class="p">&amp;</span>   <span class="o">/</span><span class="s1">&#39; Please send suggestions and interesting results to&#39;</span>         <span class="p">&amp;</span>
<a name="ln-732"></a>     <span class="p">&amp;</span>        <span class="o">/</span><span class="mi">9</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;Richard Karpinski&#39;</span>                                   <span class="p">&amp;</span>
<a name="ln-733"></a>     <span class="p">&amp;</span>        <span class="o">/</span><span class="mi">9</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;Computer Center U-76&#39;</span>                                <span class="p">&amp;</span>
<a name="ln-734"></a>     <span class="p">&amp;</span>        <span class="o">/</span><span class="mi">9</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;University of California&#39;</span>                            <span class="p">&amp;</span>
<a name="ln-735"></a>     <span class="p">&amp;</span>        <span class="o">/</span><span class="mi">9</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;San Francisco, CA 94143-0704&#39;</span>                        <span class="p">&amp;</span>
<a name="ln-736"></a>     <span class="p">&amp;</span>        <span class="o">/</span><span class="mi">9</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;USA&#39;</span><span class="o">/</span>                                                <span class="p">&amp;</span>
<a name="ln-737"></a>     <span class="p">&amp;</span>        <span class="o">/</span><span class="s1">&#39; In doing so, please include the following information:&#39;</span><span class="p">&amp;</span>
<a name="ln-738"></a>     <span class="p">&amp;</span>        <span class="o">/</span><span class="mi">9</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;Precision:   Single;&#39;</span><span class="o">/</span><span class="mi">9</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;Version: 31 July 1986;&#39;</span>    <span class="p">&amp;</span>
<a name="ln-739"></a>     <span class="p">&amp;</span>        <span class="o">/</span><span class="mi">9</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;Computer:&#39;</span><span class="o">//</span><span class="mi">9</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;Compiler:&#39;</span><span class="o">//</span><span class="mi">9</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;Optimization level:&#39;</span><span class="o">/</span><span class="p">&amp;</span>
<a name="ln-740"></a>     <span class="p">&amp;</span>        <span class="o">/</span><span class="mi">9</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;Other relevant compiler options:&#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-741"></a><span class="mi">200</span>     <span class="k">format</span><span class="p">(</span>                                                         <span class="p">&amp;</span>
<a name="ln-742"></a>     <span class="p">&amp;</span>        <span class="o">/</span><span class="s1">&#39; BASIC version (C) 1983 by Prof. W. M. Kahan.&#39;</span>          <span class="p">&amp;</span>
<a name="ln-743"></a>     <span class="p">&amp;</span>        <span class="o">/</span><span class="s1">&#39; Translated to FORTRAN by T. Quarles and G. Taylor.&#39;</span>    <span class="p">&amp;</span>
<a name="ln-744"></a>     <span class="p">&amp;</span>        <span class="o">/</span><span class="s1">&#39; Modified to ANSI 66/ANSI 77 compatible subset by&#39;</span>      <span class="p">&amp;</span>
<a name="ln-745"></a>     <span class="p">&amp;</span>        <span class="o">/</span><span class="s1">&#39; Daniel Feenberg and David Gay.&#39;</span>                        <span class="p">&amp;</span>
<a name="ln-746"></a>     <span class="p">&amp;</span>        <span class="o">/</span><span class="s1">&#39; You may redistribute this program freely if you&#39;</span>       <span class="p">&amp;</span>
<a name="ln-747"></a>     <span class="p">&amp;</span>        <span class="o">/</span><span class="s1">&#39; acknowledge the source.&#39;</span><span class="p">)</span>
<a name="ln-748"></a><span class="c">!#####################################################################</span>
<a name="ln-749"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">480</span><span class="p">)</span>
<a name="ln-750"></a>        <span class="k">call </span><span class="n">page</span> <span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-751"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">530</span><span class="p">)</span>
<a name="ln-752"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">590</span><span class="p">)</span>
<a name="ln-753"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">640</span><span class="p">)</span>
<a name="ln-754"></a><span class="mi">480</span>     <span class="k">format</span><span class="p">(</span><span class="o">//</span>                                                       <span class="p">&amp;</span>
<a name="ln-755"></a>     <span class="p">&amp;</span>  <span class="s1">&#39; Running this program should reveal these characteristics:&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-756"></a>     <span class="p">&amp;</span>  <span class="s1">&#39; b = radix ( 1, 2, 4, 8, 10, 16, 100, 256, or ... ) .&#39;</span><span class="o">/</span>        <span class="p">&amp;</span>
<a name="ln-757"></a>     <span class="p">&amp;</span>  <span class="s1">&#39; p = precision, the number of significant  b-digits carried.&#39;</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-758"></a>     <span class="p">&amp;</span>  <span class="s1">&#39; u2 = b/b^p = one ulp (unit in the last place) of 1.000xxx..&#39;</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-759"></a>     <span class="p">&amp;</span>  <span class="s1">&#39; u1 = 1/b^p = one ulp of numbers a little less than 1.0.&#39;</span><span class="p">)</span>
<a name="ln-760"></a><span class="mi">530</span>     <span class="k">format</span><span class="p">(</span><span class="s1">&#39; g1, g2, g3 tell whether adequate guard digits are carried;&#39;</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-761"></a>     <span class="p">&amp;</span>  <span class="s1">&#39; 1 = yes, 0 = no;  g1 for mult.,  g2 for div., g3 for subt.&#39;</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-762"></a>     <span class="p">&amp;</span>  <span class="s1">&#39; r1,r2,r3,r4  tell whether arithmetic is rounded or chopped;&#39;</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-763"></a>     <span class="p">&amp;</span>  <span class="s1">&#39; 0=chopped, 1=correctly rounded, -1=some other rounding;&#39;</span><span class="o">/</span>     <span class="p">&amp;</span>
<a name="ln-764"></a>     <span class="p">&amp;</span>  <span class="s1">&#39; r1 for mult., r2 for div., r3 for add/subt., r4 for sqrt.&#39;</span><span class="o">/</span>   <span class="p">&amp;</span>
<a name="ln-765"></a>     <span class="p">&amp;</span>  <span class="s1">&#39; s=1 when a sticky bit is used correctly in rounding; else s=0 &amp;</span>
<a name="ln-766"></a><span class="s1">     &amp;.&#39;</span><span class="p">)</span>
<a name="ln-767"></a><span class="mi">590</span>     <span class="k">format</span><span class="p">(</span><span class="s1">&#39; u0 = an underflow threshold.&#39;</span><span class="o">/</span>                         <span class="p">&amp;</span>
<a name="ln-768"></a>     <span class="p">&amp;</span> <span class="s1">&#39; e0 and z0 tell whether underflow is abrupt, gradual or fuzzy&#39;</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-769"></a>     <span class="p">&amp;</span> <span class="s1">&#39; v = an overflow threshold, roughly.&#39;</span><span class="o">/</span>                          <span class="p">&amp;</span>
<a name="ln-770"></a>     <span class="p">&amp;</span> <span class="s1">&#39; v0  tells, roughly, whether  infinity  is represented.&#39;</span><span class="o">/</span>       <span class="p">&amp;</span>
<a name="ln-771"></a>     <span class="p">&amp;</span> <span class="s1">&#39; Comparisons are checked for consistency with subtraction&#39;</span><span class="p">)</span>
<a name="ln-772"></a><span class="mi">640</span>     <span class="k">format</span><span class="p">(</span><span class="s1">&#39;        and for contamination by pseudo-zeros.&#39;</span><span class="o">/</span>        <span class="p">&amp;</span>
<a name="ln-773"></a>     <span class="p">&amp;</span> <span class="s1">&#39; Sqrt is tested. so is  y^x  for (mostly) integers  x .&#39;</span><span class="o">/</span>       <span class="p">&amp;</span>
<a name="ln-774"></a>     <span class="p">&amp;</span> <span class="s1">&#39; Extra-precise subexpressions are revealed but not yet tested.&#39;</span> <span class="p">&amp;</span>
<a name="ln-775"></a>     <span class="p">&amp;</span> <span class="o">/</span><span class="s1">&#39; Decimal-binary conversion is not yet tested for accuracy.&#39;</span><span class="p">)</span>
<a name="ln-776"></a><span class="c">!#####################################################################</span>
<a name="ln-777"></a>        <span class="k">call </span><span class="n">page</span> <span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-778"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">690</span><span class="p">)</span>
<a name="ln-779"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">760</span><span class="p">)</span>
<a name="ln-780"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">780</span><span class="p">)</span>
<a name="ln-781"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">820</span><span class="p">)</span>
<a name="ln-782"></a><span class="mi">690</span>     <span class="k">format</span><span class="p">(</span><span class="s1">&#39; The program attempts to discriminate among:&#39;</span><span class="o">/</span>          <span class="p">&amp;</span>
<a name="ln-783"></a>     <span class="p">&amp;</span>         <span class="s1">&#39;     &gt;FLAWs, like lack of a sticky bit, &#39;</span><span class="o">/</span>              <span class="p">&amp;</span>
<a name="ln-784"></a>     <span class="p">&amp;</span>         <span class="s1">&#39;     &gt;SERIOUS DEFECTs, like lack of a guard digit, and&#39;</span><span class="o">/</span><span class="p">&amp;</span>
<a name="ln-785"></a>     <span class="p">&amp;</span>         <span class="s1">&#39;     &gt;FAILUREs, like  2+2 = 5 .&#39;</span><span class="o">/</span>                       <span class="p">&amp;</span>
<a name="ln-786"></a>     <span class="p">&amp;</span>         <span class="s1">&#39; Failures may confound subsequent diagnoses.&#39;</span><span class="p">)</span>
<a name="ln-787"></a><span class="mi">760</span>     <span class="k">format</span><span class="p">(</span><span class="o">/</span>                                                        <span class="p">&amp;</span>
<a name="ln-788"></a>     <span class="p">&amp;</span>  <span class="s1">&#39; The diagnostic capabilities of this program go beyond an&#39;</span><span class="o">/</span>    <span class="p">&amp;</span>
<a name="ln-789"></a>     <span class="p">&amp;</span>  <span class="s1">&#39; earlier program called  &quot;Machar&quot;, which can be found at the&#39;</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-790"></a>     <span class="p">&amp;</span><span class="s1">&#39; end of the book &quot;Software Manual for the Elementary Functions&quot;&#39;</span><span class="p">)</span>
<a name="ln-791"></a><span class="mi">780</span>     <span class="k">format</span><span class="p">(</span>                                                         <span class="p">&amp;</span>
<a name="ln-792"></a>     <span class="p">&amp;</span>  <span class="s1">&#39; (1980) by W. J. Cody and W. Waite. Although both programs&#39;</span><span class="o">/</span>   <span class="p">&amp;</span>
<a name="ln-793"></a>     <span class="p">&amp;</span>  <span class="s1">&#39; try to discover the radix (b), precision (p) and         &#39;</span><span class="o">/</span>   <span class="p">&amp;</span>
<a name="ln-794"></a>     <span class="p">&amp;</span>  <span class="s1">&#39; range (over/underflow thresholds) of the arithmetic, this&#39;</span><span class="o">/</span>   <span class="p">&amp;</span>
<a name="ln-795"></a>     <span class="p">&amp;</span>  <span class="s1">&#39; program tries to cope with a wider variety of pathologies&#39;</span><span class="p">)</span>
<a name="ln-796"></a><span class="mi">820</span>     <span class="k">format</span><span class="p">(</span>                                                         <span class="p">&amp;</span>
<a name="ln-797"></a>     <span class="p">&amp;</span>  <span class="s1">&#39; and to say how well the arithmetic is implemented.&#39;</span><span class="o">/</span>          <span class="p">&amp;</span>
<a name="ln-798"></a>     <span class="p">&amp;</span>  <span class="s1">&#39; The program is based upon a conventional radix&#39;</span><span class="o">/</span>              <span class="p">&amp;</span>
<a name="ln-799"></a>     <span class="p">&amp;</span>  <span class="s1">&#39; representation for floating-point numbers,&#39;</span><span class="o">/</span>                  <span class="p">&amp;</span>
<a name="ln-800"></a>     <span class="p">&amp;</span>  <span class="s1">&#39; but also allows for logarithmic encoding (b = 1)&#39;</span><span class="o">/</span>            <span class="p">&amp;</span>
<a name="ln-801"></a>     <span class="p">&amp;</span>  <span class="s1">&#39; as used by certain early wang machines.&#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-802"></a>        <span class="k">return</span>
<a name="ln-803"></a><span class="k">        end subroutine </span><span class="n">intro</span>
<a name="ln-804"></a><span class="c">!#######################################################################</span>
<a name="ln-805"></a><span class="c">!---</span>
<a name="ln-806"></a>        <span class="k">subroutine </span><span class="n">logit</span> <span class="p">(</span><span class="n">mile</span><span class="p">)</span>
<a name="ln-807"></a>      <span class="k">implicit none</span>
<a name="ln-808"></a><span class="c">!</span>
<a name="ln-809"></a>        <span class="kt">integer </span><span class="n">mile</span>
<a name="ln-810"></a><span class="c">!        ... MILESTONE REACHED - PASSED THROUGH BY THE SUCCESSFUL CODE</span>
<a name="ln-811"></a><span class="c">!</span>
<a name="ln-812"></a><span class="c">!        THIS ROUTINE FORCES A CHECKPOINT BY  WRITING ALL GLOBAL</span>
<a name="ln-813"></a><span class="c">!        INFORMATION TO A FILE FOR LATER RESTARTING.</span>
<a name="ln-814"></a><span class="c">!</span>
<a name="ln-815"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">fp0</span><span class="p">,</span><span class="n">fp1</span><span class="p">,</span><span class="n">fp2</span><span class="p">,</span><span class="n">fp3</span><span class="p">,</span><span class="n">fp4</span><span class="p">,</span><span class="n">fp8</span><span class="p">,</span><span class="n">fp9</span><span class="p">,</span><span class="n">fp27</span><span class="p">,</span><span class="n">fp32</span><span class="p">,</span><span class="n">half</span><span class="p">,</span><span class="n">minus1</span>
<a name="ln-816"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">fails</span><span class="p">,</span><span class="n">sdefct</span><span class="p">,</span><span class="n">defect</span><span class="p">,</span><span class="n">flaws</span><span class="p">,</span><span class="nb">radix</span><span class="p">,</span><span class="n">ulppls</span><span class="p">,</span><span class="n">ulpmin</span><span class="p">,</span><span class="n">precis</span>
<a name="ln-817"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">w</span><span class="p">,</span> <span class="n">mulgrd</span><span class="p">,</span><span class="n">divgrd</span><span class="p">,</span> <span class="n">subgrd</span><span class="p">,</span><span class="n">a1</span><span class="p">,</span><span class="n">onemin</span>
<a name="ln-818"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">c1</span><span class="p">,</span> <span class="n">h1</span><span class="p">,</span> <span class="n">minpos</span><span class="p">,</span> <span class="n">nulps</span><span class="p">,</span> <span class="n">uflthr</span><span class="p">,</span> <span class="n">phony0</span><span class="p">,</span> <span class="n">ieee</span>
<a name="ln-819"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r3</span><span class="p">,</span> <span class="n">r4</span><span class="p">,</span> <span class="n">sticky</span>
<a name="ln-820"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">pgnumb</span><span class="p">,</span><span class="n">mile</span>
<a name="ln-821"></a>        <span class="k">rewind </span><span class="mi">4</span>
<a name="ln-822"></a>        <span class="k">return</span>
<a name="ln-823"></a><span class="k">        end subroutine </span><span class="n">logit</span>
<a name="ln-824"></a><span class="c">!#######################################################################</span>
<a name="ln-825"></a><span class="c">!---</span>
<a name="ln-826"></a><span class="c">!       SUBROUTINE TO TEST IF  Y = X</span>
<a name="ln-827"></a><span class="c">!</span>
<a name="ln-828"></a>        <span class="k">subroutine </span><span class="n">cmpxy</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<a name="ln-829"></a>      <span class="k">implicit none</span>
<a name="ln-830"></a><span class="c">!</span>
<a name="ln-831"></a><span class="c">!</span>
<a name="ln-832"></a>        <span class="kt">real </span><span class="n">fp0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">xx</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span>
<a name="ln-833"></a>        <span class="kt">integer </span><span class="n">q</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-834"></a>        <span class="k">data </span><span class="n">fp0</span><span class="o">/</span><span class="mf">0.e0</span><span class="o">/</span>
<a name="ln-835"></a>        <span class="n">y</span><span class="o">=</span><span class="n">z</span><span class="o">**</span><span class="n">q</span>
<a name="ln-836"></a><span class="c">!4040    continue</span>
<a name="ln-837"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">x</span><span class="p">)</span> <span class="k">goto </span><span class="mi">4080</span>
<a name="ln-838"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4050</span>
<a name="ln-839"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">q</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4050</span>
<a name="ln-840"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">40401</span><span class="p">)</span> <span class="n">z</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">y</span>
<a name="ln-841"></a><span class="mi">40401</span>   <span class="k">format</span><span class="p">(</span><span class="s1">&#39; WARNING: computed  (&#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;)^(&#39;</span><span class="p">,</span><span class="n">i3</span><span class="p">,</span><span class="s1">&#39;) = &#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-842"></a>        <span class="n">go</span> <span class="n">to</span> <span class="mi">40601</span>
<a name="ln-843"></a><span class="mi">4050</span>    <span class="k">continue</span>
<a name="ln-844"></a><span class="k">        if</span> <span class="p">(</span><span class="n">n</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">4070</span>
<a name="ln-845"></a><span class="c">!4060    continue</span>
<a name="ln-846"></a>        <span class="n">defect</span> <span class="o">=</span> <span class="n">defect</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-847"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">4061</span><span class="p">)</span> <span class="n">z</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">y</span>
<a name="ln-848"></a><span class="mi">40601</span>   <span class="k">continue</span>
<a name="ln-849"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">4062</span><span class="p">)</span> <span class="n">x</span>
<a name="ln-850"></a>        <span class="n">xx</span><span class="o">=</span><span class="n">y</span><span class="o">-</span><span class="n">x</span>
<a name="ln-851"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">4063</span><span class="p">)</span> <span class="n">xx</span>
<a name="ln-852"></a><span class="mi">4061</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; DEFECT: computed  (&#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;)^(&#39;</span><span class="p">,</span><span class="n">i3</span><span class="p">,</span><span class="s1">&#39;) = &#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-853"></a><span class="mi">4062</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;    compares unequal to correct &#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-854"></a><span class="mi">4063</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;    they differ by  &#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-855"></a><span class="c">!                       INCREMENT COUNT OF DISCREPANCIES</span>
<a name="ln-856"></a><span class="mi">4070</span>    <span class="k">continue</span>
<a name="ln-857"></a><span class="k">        </span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-858"></a><span class="mi">4080</span>    <span class="k">continue</span>
<a name="ln-859"></a><span class="k">        return</span>
<a name="ln-860"></a><span class="k">        end subroutine </span><span class="n">cmpxy</span>
<a name="ln-861"></a><span class="c">!#######################################################################</span>
<a name="ln-862"></a><span class="c">!---</span>
<a name="ln-863"></a><span class="c">!       SUBROUTINE TO PRINT N AND PAUSE IF N &gt; 0.</span>
<a name="ln-864"></a><span class="c">!</span>
<a name="ln-865"></a>        <span class="k">subroutine </span><span class="n">prt2</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">miles</span><span class="p">)</span>
<a name="ln-866"></a>      <span class="k">implicit none</span>
<a name="ln-867"></a><span class="k">        </span><span class="kt">integer </span><span class="n">n</span><span class="p">,</span> <span class="n">miles</span>
<a name="ln-868"></a><span class="c">!4290    continue</span>
<a name="ln-869"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">4291</span><span class="p">)</span>
<a name="ln-870"></a><span class="mi">4291</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; No discrepancies found.&#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-871"></a><span class="c">!4310    continue</span>
<a name="ln-872"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">page</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-873"></a><span class="c">!       ---- PAUSE ----</span>
<a name="ln-874"></a><span class="c">!4320    continue</span>
<a name="ln-875"></a>        <span class="k">return</span>
<a name="ln-876"></a><span class="k">        end subroutine </span><span class="n">prt2</span>
<a name="ln-877"></a><span class="c">!#######################################################################</span>
<a name="ln-878"></a><span class="c">!---</span>
<a name="ln-879"></a><span class="c">!       SUBROUTINE TO COMPARE  Z^I  WITH  X = Z*Z*...*Z  ( I TIMES )</span>
<a name="ln-880"></a><span class="c">!</span>
<a name="ln-881"></a>        <span class="k">subroutine </span><span class="n">pwrcmp</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<a name="ln-882"></a>      <span class="k">implicit none</span>
<a name="ln-883"></a><span class="c">!</span>
<a name="ln-884"></a><span class="c">!</span>
<a name="ln-885"></a>        <span class="kt">real </span><span class="n">x</span><span class="p">,</span> <span class="n">z</span>
<a name="ln-886"></a>        <span class="kt">integer </span><span class="n">i</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-887"></a>        <span class="kt">real </span><span class="n">y</span>
<a name="ln-888"></a>        <span class="kt">integer </span><span class="n">q</span>
<a name="ln-889"></a><span class="mi">3990</span>    <span class="k">continue</span>
<a name="ln-890"></a><span class="k">        </span><span class="n">y</span> <span class="o">=</span> <span class="n">z</span> <span class="o">**</span> <span class="n">i</span>
<a name="ln-891"></a>        <span class="n">q</span> <span class="o">=</span> <span class="n">i</span>
<a name="ln-892"></a><span class="c">!                               TEST WHETHER  Y=X</span>
<a name="ln-893"></a>        <span class="k">call </span><span class="n">cmpxy</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<a name="ln-894"></a><span class="c">!4000    continue</span>
<a name="ln-895"></a>        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-896"></a><span class="c">!                               WITH  X = Z^M</span>
<a name="ln-897"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">m</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-898"></a><span class="c">!4010    continue</span>
<a name="ln-899"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">z</span> <span class="o">*</span> <span class="n">x</span>
<a name="ln-900"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">w</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3990</span>
<a name="ln-901"></a><span class="c">!4020    continue</span>
<a name="ln-902"></a>        <span class="k">return</span>
<a name="ln-903"></a><span class="k">        end subroutine </span><span class="n">pwrcmp</span>
<a name="ln-904"></a><span class="c">!#######################################################################</span>
<a name="ln-905"></a><span class="c">!---</span>
<a name="ln-906"></a><span class="c">!       SUBROUTINE TO PRINT COUNT  N  OF DISCREPANCIES</span>
<a name="ln-907"></a><span class="c">!</span>
<a name="ln-908"></a>        <span class="k">subroutine </span><span class="n">prtcnt</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a name="ln-909"></a>      <span class="k">implicit none</span>
<a name="ln-910"></a><span class="k">        </span><span class="kt">integer </span><span class="n">n</span>
<a name="ln-911"></a><span class="c">!4100    continue</span>
<a name="ln-912"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">4101</span><span class="p">)</span> <span class="n">n</span>
<a name="ln-913"></a><span class="mi">4101</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Similar discrepancies have occurred &#39;</span><span class="p">,</span><span class="n">i4</span><span class="p">,</span><span class="s1">&#39; times.&#39;</span><span class="p">)</span>
<a name="ln-914"></a><span class="c">!4110    continue</span>
<a name="ln-915"></a>        <span class="k">return</span>
<a name="ln-916"></a><span class="k">        end subroutine </span><span class="n">prtcnt</span>
<a name="ln-917"></a><span class="c">!#######################################################################</span>
<a name="ln-918"></a><span class="c">!---</span>
<a name="ln-919"></a>        <span class="k">subroutine </span><span class="n">badsqr</span><span class="p">(</span><span class="n">sflag</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<a name="ln-920"></a>      <span class="k">implicit none</span>
<a name="ln-921"></a><span class="k">        </span><span class="kt">integer </span><span class="n">sflag</span>
<a name="ln-922"></a><span class="c">!        ... INTEGER FLAG TO INDICATE NEED TO USE PREFIX &quot;SERIOUS&quot;</span>
<a name="ln-923"></a>        <span class="kt">real </span><span class="n">z</span>
<a name="ln-924"></a><span class="c">!        ... SQUARE OF SQUARE ROOT OF Z (WRONG)</span>
<a name="ln-925"></a>        <span class="kt">real </span><span class="n">y</span>
<a name="ln-926"></a><span class="c">!        ... REAL NUMBER WHOSE SQUARE ROOT SQUARED IS WRONG</span>
<a name="ln-927"></a>        <span class="k">if</span><span class="p">(</span><span class="n">sflag</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">5745</span>
<a name="ln-928"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5740</span><span class="p">)</span> <span class="n">z</span>
<a name="ln-929"></a><span class="mi">5740</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; DEFECT:  comparison alleges that what prints as  z = &#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-930"></a>        <span class="n">go</span> <span class="n">to</span> <span class="mi">5748</span>
<a name="ln-931"></a><span class="mi">5745</span>    <span class="k">continue</span>
<a name="ln-932"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5747</span><span class="p">)</span> <span class="n">z</span>
<a name="ln-933"></a><span class="mi">5747</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; SERIOUS DEFECT:  comparison alleges that what prints as z = &#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-934"></a><span class="mi">5748</span>    <span class="k">continue</span>
<a name="ln-935"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5749</span><span class="p">)</span> <span class="n">y</span>
<a name="ln-936"></a><span class="mi">5749</span>    <span class="k">format</span><span class="p">(</span><span class="mi">17</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;is too far from  sqrt(z)^2 = &#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-937"></a>        <span class="k">return</span>
<a name="ln-938"></a><span class="k">        end subroutine </span><span class="n">badsqr</span>
<a name="ln-939"></a><span class="c">!#######################################################################</span>
<a name="ln-940"></a><span class="c">!---</span>
<a name="ln-941"></a>        <span class="k">subroutine </span><span class="n">overf</span> <span class="p">(</span><span class="n">miles</span><span class="p">,</span> <span class="n">from</span><span class="p">)</span>
<a name="ln-942"></a>      <span class="k">implicit none</span>
<a name="ln-943"></a><span class="c">!</span>
<a name="ln-944"></a><span class="c">!        ... NUMBER OF MILESTONES PASSED</span>
<a name="ln-945"></a>        <span class="kt">integer </span><span class="n">miles</span>
<a name="ln-946"></a><span class="c">!        ... COUNTER OF MILESTONES PREVIOUSLY REACHED</span>
<a name="ln-947"></a>        <span class="kt">integer </span><span class="n">from</span>
<a name="ln-948"></a><span class="c">!</span>
<a name="ln-949"></a><span class="c">!        ... LOCAL VARIABLES</span>
<a name="ln-950"></a>        <span class="kt">integer </span><span class="n">i</span>
<a name="ln-951"></a>        <span class="kt">real </span><span class="n">v9</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">temp</span>
<a name="ln-952"></a><span class="c">!        ... SATURATION VALUE AFTER FLOATING POINT OVERFLOW</span>
<a name="ln-953"></a>        <span class="kt">real </span><span class="n">sat</span>
<a name="ln-954"></a><span class="c">!        ... OVERFLOW THRESHOLD</span>
<a name="ln-955"></a>        <span class="kt">real </span><span class="n">v</span>
<a name="ln-956"></a><span class="c">!        ... FLAG TO INDICATE WHETHER DEFECT IS SERIOUS OR NOT</span>
<a name="ln-957"></a>        <span class="kt">integer </span><span class="n">zflag</span>
<a name="ln-958"></a><span class="c">!</span>
<a name="ln-959"></a>        <span class="kt">integer </span><span class="n">i0</span>
<a name="ln-960"></a><span class="c">!</span>
<a name="ln-961"></a><span class="c">!       IBM        SIGN-MAGNITUDE, SATURATION VALUE, NO TRAP</span>
<a name="ln-962"></a><span class="c">!       PRIME      TWOS-COMPLEMENT, SATURATION VALUE, NO TRAP</span>
<a name="ln-963"></a><span class="c">!       VAX        SIGN-MAGNITUDE, TRAP</span>
<a name="ln-964"></a><span class="c">!       ELXSI      SIGN-MAGNITUDE, TRAP OR INFINITY SYMBOL IF NO TRAP</span>
<a name="ln-965"></a><span class="c">!       CDC        SIGN-MAGNITUDE, INFINITY SYMBOL, NO TRAP</span>
<a name="ln-966"></a><span class="c">!</span>
<a name="ln-967"></a><span class="c">!           CALL TO UNIX TO ENABLE TRAPS (FAULTS)</span>
<a name="ln-968"></a><span class="c">!           ON FP UNDERFLOW AND FIXED POINT OVERFLOW</span>
<a name="ln-969"></a><span class="c">!</span>
<a name="ln-970"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">5500</span>
<a name="ln-971"></a><span class="c">!</span>
<a name="ln-972"></a><span class="c">!           REASSIGN VALUES TO VARIABLES USING THE LOG FILE,</span>
<a name="ln-973"></a><span class="c">!           THEN GO TO RESTART POINT</span>
<a name="ln-974"></a><span class="c">!</span>
<a name="ln-975"></a>        <span class="k">read</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">sat</span><span class="p">,</span><span class="n">v9</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">zflag</span>
<a name="ln-976"></a>        <span class="k">rewind </span><span class="mi">3</span>
<a name="ln-977"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">161</span><span class="p">)</span> <span class="k">goto </span><span class="mi">5582</span>
<a name="ln-978"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">170</span><span class="p">)</span> <span class="k">goto </span><span class="mi">5680</span>
<a name="ln-979"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">175</span><span class="p">)</span> <span class="k">goto </span><span class="mi">5810</span>
<a name="ln-980"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">201</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">from</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="mi">205</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">5999</span>
<a name="ln-981"></a>        <span class="k">call </span><span class="n">badmil</span>
<a name="ln-982"></a><span class="c">!</span>
<a name="ln-983"></a><span class="mi">5500</span>    <span class="k">continue</span>
<a name="ln-984"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5510</span><span class="p">)</span>
<a name="ln-985"></a><span class="mi">5510</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Searching for overflow threshold:&#39;</span><span class="p">)</span>
<a name="ln-986"></a>        <span class="n">miles</span> <span class="o">=</span> <span class="mi">161</span>
<a name="ln-987"></a>        <span class="k">call </span><span class="n">logit</span> <span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-988"></a><span class="c">!</span>
<a name="ln-989"></a><span class="c">!                  SET Y TO -1 * A LARGE POWER OF THE RADIX</span>
<a name="ln-990"></a><span class="c">!5520    continue</span>
<a name="ln-991"></a>        <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="n">c1</span>
<a name="ln-992"></a>        <span class="n">v9</span> <span class="o">=</span> <span class="n">h1</span> <span class="o">*</span> <span class="n">y</span>
<a name="ln-993"></a><span class="c">!</span>
<a name="ln-994"></a><span class="c">!                  MULTIPLY BY RADIX (H1) UNTIL OVERFLOW OCCURS</span>
<a name="ln-995"></a><span class="c">!</span>
<a name="ln-996"></a><span class="mi">5530</span>    <span class="k">continue</span>
<a name="ln-997"></a><span class="k">        </span><span class="n">v</span> <span class="o">=</span> <span class="n">y</span>
<a name="ln-998"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">v9</span>
<a name="ln-999"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">sat</span><span class="p">,</span><span class="n">v9</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">zflag</span>
<a name="ln-1000"></a>        <span class="k">rewind </span><span class="mi">3</span>
<a name="ln-1001"></a>        <span class="n">v9</span> <span class="o">=</span> <span class="n">h1</span> <span class="o">*</span> <span class="n">y</span>
<a name="ln-1002"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">v9</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">y</span><span class="p">)</span> <span class="k">goto </span><span class="mi">5530</span>
<a name="ln-1003"></a><span class="c">!</span>
<a name="ln-1004"></a><span class="c">!       SYSTEM DOES NOT TRAP ON OVERFLOW</span>
<a name="ln-1005"></a><span class="c">!</span>
<a name="ln-1006"></a><span class="c">!           POSSIBILITIES:</span>
<a name="ln-1007"></a><span class="c">!               V9 &gt; Y,  V9 IS THE VALUE RETURNED AFTER OVERFLOW</span>
<a name="ln-1008"></a><span class="c">!                        Y IS THE LARGEST POWER OF THE RADIX</span>
<a name="ln-1009"></a><span class="c">!                        V IS THE SECOND LARGEST POWER OF THE RADIX</span>
<a name="ln-1010"></a><span class="c">!</span>
<a name="ln-1011"></a><span class="c">!               V9 == Y, BOTH ARE SATURATION VALUE</span>
<a name="ln-1012"></a><span class="c">!                        V IS THE LARGEST POWER OF THE RADIX</span>
<a name="ln-1013"></a><span class="c">!</span>
<a name="ln-1014"></a><span class="c">!               V9 == Y, BOTH ARE INFINITY SYMBOL</span>
<a name="ln-1015"></a><span class="c">!                        V IS THE LARGEST POWER OF THE RADIX</span>
<a name="ln-1016"></a><span class="c">!</span>
<a name="ln-1017"></a><span class="c">!       TEST 1: VALUE RETURNED AFTER OVERFLOW SHRINKS IN MAGNITUDE</span>
<a name="ln-1018"></a><span class="c">!</span>
<a name="ln-1019"></a><span class="c">!5540    continue</span>
<a name="ln-1020"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">v9</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">y</span><span class="p">)</span> <span class="k">goto </span><span class="mi">5545</span>
<a name="ln-1021"></a>        <span class="n">sdefct</span> <span class="o">=</span> <span class="n">sdefct</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1022"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">5541</span><span class="p">)</span> <span class="n">y</span><span class="p">,</span> <span class="n">v9</span>
<a name="ln-1023"></a><span class="mi">5541</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; SERIOUS DEFECT: overflow past  &#39;</span><span class="p">,</span> <span class="mi">1</span><span class="n">pe16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;  shrinks to &#39;</span><span class="p">,</span> <span class="mi">1</span><span class="n">pe16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1024"></a><span class="c">!</span>
<a name="ln-1025"></a><span class="c">!       TEST 2: TWO&#39;S COMPLEMENT MACHINE SATURATES AT NEGATIVE</span>
<a name="ln-1026"></a><span class="c">!               LARGEST POWER OF THE RADIX</span>
<a name="ln-1027"></a><span class="c">!               NEED TO DISTINGUISH SYSTEM WITH OVERFLOW SYMBOLS</span>
<a name="ln-1028"></a><span class="c">!               FROM ONE WITHOUT THEM</span>
<a name="ln-1029"></a><span class="c">!</span>
<a name="ln-1030"></a><span class="mi">5545</span>    <span class="k">continue</span>
<a name="ln-1031"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5546</span><span class="p">)</span> <span class="n">y</span>
<a name="ln-1032"></a><span class="mi">5546</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Can &quot; z = -y &quot; overflow?  trying it on  y = &#39;</span><span class="p">,</span><span class="mi">1</span><span class="n">pe16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1033"></a>        <span class="n">sat</span> <span class="o">=</span> <span class="o">-</span><span class="n">y</span>
<a name="ln-1034"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="n">y</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">v</span> <span class="o">+</span> <span class="n">sat</span><span class="p">)</span> <span class="k">goto </span><span class="mi">5560</span>
<a name="ln-1035"></a><span class="c">!5550    continue</span>
<a name="ln-1036"></a>        <span class="n">flaws</span> <span class="o">=</span> <span class="n">flaws</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1037"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">5551</span><span class="p">)</span>
<a name="ln-1038"></a><span class="mi">5551</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Finds a FLAW:  -(-y) differs from y.&#39;</span><span class="p">)</span>
<a name="ln-1039"></a>        <span class="k">goto </span><span class="mi">5590</span>
<a name="ln-1040"></a><span class="mi">5560</span>    <span class="k">continue</span>
<a name="ln-1041"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">5561</span><span class="p">)</span>
<a name="ln-1042"></a><span class="mi">5561</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Seems O.K.&#39;</span><span class="p">)</span>
<a name="ln-1043"></a>        <span class="k">goto </span><span class="mi">5590</span>
<a name="ln-1044"></a><span class="c">!</span>
<a name="ln-1045"></a><span class="c">!       RESTART POINT FOR SYSTEMS THAT TRAP ON OVERFLOW</span>
<a name="ln-1046"></a><span class="c">!</span>
<a name="ln-1047"></a><span class="c">!             V9 = Y =  -(LARGEST POWER OF RADIX)</span>
<a name="ln-1048"></a><span class="c">!             V      =  -(SECOND LARGEST POWER OF RADIX)</span>
<a name="ln-1049"></a><span class="c">!</span>
<a name="ln-1050"></a><span class="c">!       TEST 2: TWO&#39;S COMPLEMENT MACHINE</span>
<a name="ln-1051"></a><span class="c">!</span>
<a name="ln-1052"></a><span class="mi">5582</span>    <span class="k">continue</span>
<a name="ln-1053"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5583</span><span class="p">)</span> <span class="n">y</span>
<a name="ln-1054"></a><span class="mi">5583</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Can &quot; z = -y &quot; overflow?  trying it on  y = &#39;</span><span class="p">,</span><span class="mi">1</span><span class="n">pe16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1055"></a><span class="c">!</span>
<a name="ln-1056"></a><span class="c">!           PUT SOMETHING HERE TO HANDLE THE TRAP</span>
<a name="ln-1057"></a><span class="c">!</span>
<a name="ln-1058"></a>        <span class="n">sat</span> <span class="o">=</span> <span class="o">-</span><span class="n">y</span>
<a name="ln-1059"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="n">y</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">v</span> <span class="o">+</span> <span class="n">sat</span><span class="p">)</span> <span class="k">goto </span><span class="mi">5585</span>
<a name="ln-1060"></a>        <span class="n">flaws</span> <span class="o">=</span> <span class="n">flaws</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1061"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">5584</span><span class="p">)</span>
<a name="ln-1062"></a><span class="mi">5584</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  Finds a FLAW:  -(-y) differs from y.&#39;</span><span class="p">)</span>
<a name="ln-1063"></a>        <span class="k">goto </span><span class="mi">5587</span>
<a name="ln-1064"></a><span class="mi">5585</span>    <span class="k">continue</span>
<a name="ln-1065"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">5586</span><span class="p">)</span>
<a name="ln-1066"></a><span class="mi">5586</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Seems O.K.&#39;</span><span class="p">)</span>
<a name="ln-1067"></a><span class="c">!</span>
<a name="ln-1068"></a><span class="c">!           THIS CODE WORKS FOR A SIGN-MAGNITUDE MACHINE,</span>
<a name="ln-1069"></a><span class="c">!           BUT FAILS FOR A TWOS-COMPLEMENT ONE</span>
<a name="ln-1070"></a><span class="c">!</span>
<a name="ln-1071"></a><span class="mi">5587</span>    <span class="k">continue</span>
<a name="ln-1072"></a><span class="k">        </span><span class="n">v</span> <span class="o">=</span> <span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="n">h1</span> <span class="o">*</span> <span class="n">ulppls</span> <span class="o">-</span> <span class="n">h1</span><span class="p">)</span>
<a name="ln-1073"></a>        <span class="n">v</span> <span class="o">=</span> <span class="n">v</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="p">((</span><span class="n">fp1</span> <span class="o">-</span> <span class="n">h1</span><span class="p">)</span> <span class="o">*</span> <span class="n">ulppls</span><span class="p">)</span>
<a name="ln-1074"></a><span class="c">!</span>
<a name="ln-1075"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">5588</span><span class="p">)</span> <span class="n">v</span>
<a name="ln-1076"></a><span class="mi">5588</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Overflow threshold is  v = &#39;</span><span class="p">,</span><span class="mi">1</span><span class="n">pe16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1077"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">5589</span><span class="p">)</span>
<a name="ln-1078"></a><span class="mi">5589</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; There is no saturation value because&#39;</span><span class="o">/</span><span class="s1">&#39; the system traps on overflow.&#39;</span><span class="p">)</span>
<a name="ln-1079"></a>        <span class="k">goto </span><span class="mi">5640</span>
<a name="ln-1080"></a><span class="c">!</span>
<a name="ln-1081"></a><span class="c">!       NON-TRAPPING SYSTEMS (CONTINUED)</span>
<a name="ln-1082"></a><span class="c">!</span>
<a name="ln-1083"></a><span class="mi">5590</span>    <span class="k">continue</span>
<a name="ln-1084"></a><span class="k">        </span><span class="n">y</span> <span class="o">=</span> <span class="n">v</span> <span class="o">*</span> <span class="p">(</span><span class="n">h1</span> <span class="o">*</span> <span class="n">ulppls</span> <span class="o">-</span> <span class="n">h1</span><span class="p">)</span>
<a name="ln-1085"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">v</span> <span class="o">*</span> <span class="p">((</span><span class="n">fp1</span> <span class="o">-</span> <span class="n">h1</span><span class="p">)</span> <span class="o">*</span> <span class="n">ulppls</span><span class="p">)</span>
<a name="ln-1086"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">sat</span><span class="p">)</span> <span class="n">y</span> <span class="o">=</span> <span class="n">z</span>
<a name="ln-1087"></a><span class="c">!5600    continue</span>
<a name="ln-1088"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">sat</span><span class="p">)</span> <span class="n">v</span> <span class="o">=</span> <span class="n">y</span>
<a name="ln-1089"></a><span class="c">!</span>
<a name="ln-1090"></a><span class="c">!                  THE OVERFLOW THRESHOLD EQUALS THE SATURATION VALUE</span>
<a name="ln-1091"></a><span class="c">!                  IF THE LATTER BEHAVES AS A NUMBER RATHER THAN AN</span>
<a name="ln-1092"></a><span class="c">!                  OVERFLOW SYMBOL.  AN OVERFLOW SYMBOL IS NOT</span>
<a name="ln-1093"></a><span class="c">!                  CHANGED WHEN ANY NUMBER IS ADDED TO OR SUBTRACTED</span>
<a name="ln-1094"></a><span class="c">!                  FROM IT.</span>
<a name="ln-1095"></a><span class="c">!</span>
<a name="ln-1096"></a><span class="c">!5610    continue</span>
<a name="ln-1097"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">sat</span> <span class="o">-</span> <span class="n">v</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">sat</span><span class="p">)</span> <span class="n">v</span> <span class="o">=</span> <span class="n">sat</span>
<a name="ln-1098"></a><span class="c">!</span>
<a name="ln-1099"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">5620</span><span class="p">)</span> <span class="n">v</span>
<a name="ln-1100"></a><span class="mi">5620</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Overflow threshold is  v = &#39;</span><span class="p">,</span><span class="mi">1</span><span class="n">pe16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1101"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">5630</span><span class="p">)</span> <span class="n">sat</span>
<a name="ln-1102"></a><span class="mi">5630</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Overflow saturates at  sat = &#39;</span><span class="p">,</span><span class="mi">1</span><span class="n">pe16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1103"></a><span class="c">!</span>
<a name="ln-1104"></a><span class="c">!</span>
<a name="ln-1105"></a><span class="c">!</span>
<a name="ln-1106"></a><span class="mi">5640</span>    <span class="k">continue</span>
<a name="ln-1107"></a><span class="k">        </span><span class="n">miles</span> <span class="o">=</span> <span class="mi">163</span>
<a name="ln-1108"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">5641</span><span class="p">)</span>
<a name="ln-1109"></a><span class="mi">5641</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; No overflow should be signaled for  v*1 = &#39;</span><span class="p">)</span>
<a name="ln-1110"></a>        <span class="n">temp</span> <span class="o">=</span> <span class="n">v</span> <span class="o">*</span> <span class="n">fp1</span>
<a name="ln-1111"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">5642</span><span class="p">)</span> <span class="n">temp</span>
<a name="ln-1112"></a><span class="mi">5642</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;                                           &#39;</span><span class="p">,</span><span class="mi">1</span><span class="n">pe16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1113"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">5643</span><span class="p">)</span>
<a name="ln-1114"></a><span class="mi">5643</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;                            nor for  v/1 = &#39;</span><span class="p">)</span>
<a name="ln-1115"></a>        <span class="n">temp</span> <span class="o">=</span> <span class="n">v</span> <span class="o">/</span> <span class="n">fp1</span>
<a name="ln-1116"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">5644</span><span class="p">)</span> <span class="n">temp</span>
<a name="ln-1117"></a><span class="mi">5644</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;                                           &#39;</span><span class="p">,</span><span class="mi">1</span><span class="n">pe16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1118"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5649</span><span class="p">)</span>
<a name="ln-1119"></a><span class="mi">5649</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Any overflow signal separating this  *  from one above is a DEFECT.&#39;</span><span class="p">)</span>
<a name="ln-1120"></a><span class="c">!</span>
<a name="ln-1121"></a><span class="c">!       NEED TO ADD CODE HERE TO HANDLE OVERFLOWS JUST ABOVE</span>
<a name="ln-1122"></a><span class="c">!</span>
<a name="ln-1123"></a><span class="c">!</span>
<a name="ln-1124"></a><span class="c">!</span>
<a name="ln-1125"></a><span class="c">!5650    continue</span>
<a name="ln-1126"></a>        <span class="n">miles</span><span class="o">=</span><span class="mi">170</span>
<a name="ln-1127"></a><span class="c">!</span>
<a name="ln-1128"></a><span class="c">!       PROBLEM: SAT NOT DEFINED IF WE TRAPPED ON OVERFLOW ABOVE</span>
<a name="ln-1129"></a><span class="c">!</span>
<a name="ln-1130"></a><span class="c">!5660    continue</span>
<a name="ln-1131"></a>        <span class="k">if</span> <span class="p">(</span><span class="o">-</span><span class="n">v</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">v</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="o">-</span><span class="n">sat</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">sat</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="o">-</span><span class="n">uflthr</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">v</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">uflthr</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">v</span><span class="p">)</span> <span class="k">goto </span><span class="mi">5680</span>
<a name="ln-1132"></a><span class="c">!5670    continue</span>
<a name="ln-1133"></a>        <span class="n">fails</span> <span class="o">=</span> <span class="n">fails</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1134"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5672</span><span class="p">)</span>
<a name="ln-1135"></a><span class="mi">5672</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE: comparisons are confused by overflow.&#39;</span><span class="p">)</span>
<a name="ln-1136"></a><span class="c">!</span>
<a name="ln-1137"></a><span class="c">!</span>
<a name="ln-1138"></a><span class="c">!</span>
<a name="ln-1139"></a><span class="mi">5680</span>    <span class="k">continue</span>
<a name="ln-1140"></a><span class="k">        </span><span class="n">miles</span> <span class="o">=</span> <span class="mi">175</span>
<a name="ln-1141"></a>        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1142"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">uflthr</span>
<a name="ln-1143"></a><span class="mi">5700</span>    <span class="k">continue</span>
<a name="ln-1144"></a><span class="k">        </span><span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1145"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">5770</span>
<a name="ln-1146"></a><span class="c">!5710    continue</span>
<a name="ln-1147"></a>        <span class="n">v9</span><span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<a name="ln-1148"></a>        <span class="n">y</span><span class="o">=</span><span class="n">v9</span><span class="o">*</span><span class="n">v9</span>
<a name="ln-1149"></a>        <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="p">(</span><span class="n">y</span><span class="o">/</span><span class="p">(</span><span class="n">fp1</span><span class="o">-</span><span class="nb">radix</span> <span class="o">*</span> <span class="n">nulps</span><span class="p">)</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">z</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">y</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="p">(</span><span class="n">fp1</span><span class="o">+</span><span class="nb">radix</span><span class="o">*</span><span class="n">nulps</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="p">))</span> <span class="k">goto </span><span class="mi">5770</span>
<a name="ln-1150"></a><span class="c">!5720    continue</span>
<a name="ln-1151"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">v9</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">ulpmin</span><span class="p">)</span> <span class="k">goto </span><span class="mi">5750</span>
<a name="ln-1152"></a><span class="c">!5730    continue</span>
<a name="ln-1153"></a>        <span class="n">zflag</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1154"></a>        <span class="n">defect</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="n">defect</span>
<a name="ln-1155"></a>        <span class="k">goto </span><span class="mi">5760</span>
<a name="ln-1156"></a><span class="mi">5750</span>    <span class="k">continue</span>
<a name="ln-1157"></a><span class="k">        </span><span class="n">zflag</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1158"></a>        <span class="n">sdefct</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="n">sdefct</span>
<a name="ln-1159"></a><span class="mi">5760</span>    <span class="k">continue</span>
<a name="ln-1160"></a><span class="k">        call </span><span class="n">badsqr</span><span class="p">(</span><span class="n">zflag</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<a name="ln-1161"></a><span class="mi">5770</span>    <span class="k">continue</span>
<a name="ln-1162"></a><span class="k">        goto</span> <span class="p">(</span><span class="mi">5780</span><span class="p">,</span> <span class="mi">5790</span><span class="p">,</span> <span class="mi">5800</span><span class="p">),</span><span class="n">i</span>
<a name="ln-1163"></a><span class="mi">5780</span>    <span class="k">continue</span>
<a name="ln-1164"></a><span class="k">        </span><span class="n">z</span> <span class="o">=</span> <span class="n">minpos</span>
<a name="ln-1165"></a>        <span class="k">goto </span><span class="mi">5700</span>
<a name="ln-1166"></a><span class="mi">5790</span>    <span class="k">continue</span>
<a name="ln-1167"></a><span class="k">        </span><span class="n">z</span> <span class="o">=</span> <span class="n">phony0</span>
<a name="ln-1168"></a>        <span class="k">goto </span><span class="mi">5700</span>
<a name="ln-1169"></a><span class="c">!</span>
<a name="ln-1170"></a><span class="c">!</span>
<a name="ln-1171"></a><span class="c">!</span>
<a name="ln-1172"></a><span class="mi">5800</span>    <span class="k">continue</span>
<a name="ln-1173"></a><span class="k">        </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1174"></a>        <span class="n">z</span><span class="o">=</span><span class="n">v</span>
<a name="ln-1175"></a><span class="mi">5810</span>    <span class="k">continue</span>
<a name="ln-1176"></a><span class="k">        </span><span class="n">miles</span><span class="o">=</span><span class="mi">180</span>
<a name="ln-1177"></a><span class="c">!5820    continue</span>
<a name="ln-1178"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">radix</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mf">2.</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">precis</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">5</span><span class="mf">6.</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">phony0</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">0.</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="o">-</span><span class="n">fp0</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">5850</span>
<a name="ln-1179"></a><span class="c">!5830    continue</span>
<a name="ln-1180"></a>        <span class="n">fails</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="n">fails</span>
<a name="ln-1181"></a><span class="c">! FAILURE: ATTEMPTS TO EVALUATE  SQR(OVERFLOW THRESHOLD V)  IN DOUBLE</span>
<a name="ln-1182"></a><span class="c">! PRECISION IN  BASIC  ON THE  IBM PC  DISPLAY THE WORD  &quot; OVERFLOW &quot;</span>
<a name="ln-1183"></a><span class="c">! AND THEN DISABLE THE KEYBOARD !  THIS IS DISASTROUS.</span>
<a name="ln-1184"></a>        <span class="k">goto </span><span class="mi">5920</span>
<a name="ln-1185"></a><span class="c">!</span>
<a name="ln-1186"></a><span class="c">!</span>
<a name="ln-1187"></a><span class="c">!</span>
<a name="ln-1188"></a><span class="mi">5850</span>    <span class="k">continue</span>
<a name="ln-1189"></a><span class="k">        </span><span class="n">v9</span> <span class="o">=</span>  <span class="nb">sqrt</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<a name="ln-1190"></a>        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">fp1</span> <span class="o">-</span> <span class="nb">radix</span> <span class="o">*</span> <span class="n">nulps</span><span class="p">)</span> <span class="o">*</span> <span class="n">v9</span>
<a name="ln-1191"></a>        <span class="n">v9</span> <span class="o">=</span> <span class="n">v9</span> <span class="o">*</span> <span class="n">x</span>
<a name="ln-1192"></a>        <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="p">(</span><span class="n">v9</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="p">(</span><span class="n">fp1</span><span class="o">-</span><span class="n">fp2</span><span class="o">*</span><span class="nb">radix</span><span class="o">*</span><span class="n">nulps</span><span class="p">)</span><span class="o">*</span><span class="n">z</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">v9</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">z</span><span class="p">))</span> <span class="k">goto </span><span class="mi">5900</span>
<a name="ln-1193"></a><span class="c">!5860    continue</span>
<a name="ln-1194"></a>        <span class="n">y</span><span class="o">=</span><span class="n">v9</span>
<a name="ln-1195"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">w</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">5880</span>
<a name="ln-1196"></a><span class="c">!5870    continue</span>
<a name="ln-1197"></a>        <span class="n">zflag</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1198"></a>        <span class="n">defect</span> <span class="o">=</span> <span class="n">defect</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1199"></a>        <span class="k">goto </span><span class="mi">5890</span>
<a name="ln-1200"></a><span class="mi">5880</span>    <span class="k">continue</span>
<a name="ln-1201"></a><span class="k">        </span><span class="n">zflag</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1202"></a>        <span class="n">sdefct</span> <span class="o">=</span> <span class="n">sdefct</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1203"></a><span class="mi">5890</span>    <span class="k">continue</span>
<a name="ln-1204"></a><span class="k">        </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1205"></a>        <span class="k">call </span><span class="n">badsqr</span><span class="p">(</span><span class="n">zflag</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<a name="ln-1206"></a><span class="mi">5900</span>    <span class="k">continue</span>
<a name="ln-1207"></a><span class="k">        if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">5920</span>
<a name="ln-1208"></a><span class="c">!5910    continue</span>
<a name="ln-1209"></a>        <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1210"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">sat</span>
<a name="ln-1211"></a>        <span class="k">goto </span><span class="mi">5850</span>
<a name="ln-1212"></a><span class="c">!</span>
<a name="ln-1213"></a><span class="c">!</span>
<a name="ln-1214"></a><span class="c">!</span>
<a name="ln-1215"></a><span class="mi">5920</span>    <span class="k">continue</span>
<a name="ln-1216"></a><span class="k">        </span><span class="n">miles</span> <span class="o">=</span> <span class="mi">190</span>
<a name="ln-1217"></a>        <span class="k">call </span><span class="n">page</span> <span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-1218"></a><span class="c">!5940    continue</span>
<a name="ln-1219"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">uflthr</span> <span class="o">*</span> <span class="n">v</span>
<a name="ln-1220"></a>        <span class="n">y</span> <span class="o">=</span> <span class="nb">radix</span> <span class="o">*</span> <span class="nb">radix</span>
<a name="ln-1221"></a><span class="nb">        </span><span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="n">fp1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">x</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">y</span><span class="p">)</span> <span class="k">goto </span><span class="mi">5990</span>
<a name="ln-1222"></a><span class="c">!5950    continue</span>
<a name="ln-1223"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="n">ulpmin</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">x</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">y</span> <span class="o">/</span> <span class="n">ulpmin</span><span class="p">)</span> <span class="k">goto </span><span class="mi">5970</span>
<a name="ln-1224"></a><span class="c">!5960    continue</span>
<a name="ln-1225"></a>        <span class="n">defect</span> <span class="o">=</span> <span class="n">defect</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1226"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">5961</span><span class="p">)</span> <span class="n">x</span>
<a name="ln-1227"></a><span class="mi">5961</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; DEFECT: badly unbalanced range;  UFLTHR * V  =&#39;</span><span class="p">,</span> <span class="n">e13</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39; IS TOO FAR FROM 1.&#39;</span><span class="p">)</span>
<a name="ln-1228"></a>        <span class="k">goto </span><span class="mi">5990</span>
<a name="ln-1229"></a><span class="mi">5970</span>    <span class="k">continue</span>
<a name="ln-1230"></a><span class="k">        </span><span class="n">flaws</span> <span class="o">=</span> <span class="n">flaws</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1231"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">5971</span><span class="p">)</span> <span class="n">x</span>
<a name="ln-1232"></a><span class="mi">5971</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FLAW: unbalanced range;  UFLTHR * V  =&#39;</span><span class="p">,</span> <span class="n">e13</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39; IS TOO FAR FROM 1.&#39;</span><span class="p">)</span>
<a name="ln-1233"></a><span class="c">!</span>
<a name="ln-1234"></a><span class="c">!                               TEST  X/X   VS.  1</span>
<a name="ln-1235"></a><span class="mi">5990</span>    <span class="k">continue</span>
<a name="ln-1236"></a><span class="k">        </span><span class="n">i0</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1237"></a>        <span class="n">go</span> <span class="n">to</span> <span class="mi">6000</span>
<a name="ln-1238"></a><span class="mi">5999</span>    <span class="k">continue</span>
<a name="ln-1239"></a><span class="k">        </span><span class="n">i0</span> <span class="o">=</span> <span class="n">from</span> <span class="o">-</span> <span class="mi">200</span>
<a name="ln-1240"></a><span class="c">!</span>
<a name="ln-1241"></a><span class="mi">6000</span>    <span class="k">do </span><span class="mi">6100</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i0</span><span class="p">,</span> <span class="mi">5</span>
<a name="ln-1242"></a><span class="c">!6010    continue</span>
<a name="ln-1243"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">onemin</span>
<a name="ln-1244"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="n">x</span> <span class="o">=</span> <span class="n">fp1</span> <span class="o">+</span> <span class="n">ulppls</span>
<a name="ln-1245"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">3</span><span class="p">)</span> <span class="n">x</span> <span class="o">=</span> <span class="n">v</span>
<a name="ln-1246"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">4</span><span class="p">)</span> <span class="n">x</span> <span class="o">=</span> <span class="n">uflthr</span>
<a name="ln-1247"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">5</span><span class="p">)</span> <span class="n">x</span> <span class="o">=</span> <span class="nb">radix</span>
<a name="ln-1248"></a><span class="nb">        </span><span class="n">miles</span> <span class="o">=</span> <span class="mi">200</span> <span class="o">+</span> <span class="n">i</span>
<a name="ln-1249"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">miles</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">6050</span>
<a name="ln-1250"></a>        <span class="n">sdefct</span> <span class="o">=</span> <span class="n">sdefct</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1251"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">6011</span><span class="p">)</span> <span class="n">x</span>
<a name="ln-1252"></a><span class="mi">6011</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; SERIOUS DEFECT: x/x traps when x = &#39;</span><span class="p">,</span><span class="n">e13</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1253"></a>        <span class="n">go</span> <span class="n">to</span> <span class="mi">6100</span>
<a name="ln-1254"></a><span class="mi">6050</span>    <span class="k">continue</span>
<a name="ln-1255"></a><span class="k">        </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
<a name="ln-1256"></a>        <span class="k">call </span><span class="n">logit</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-1257"></a>        <span class="n">v9</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">/</span> <span class="n">x</span> <span class="o">-</span> <span class="n">half</span><span class="p">)</span> <span class="o">-</span> <span class="n">half</span>
<a name="ln-1258"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">v9</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">6100</span>
<a name="ln-1259"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">v9</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="o">-</span><span class="n">ulpmin</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">i</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mi">5</span><span class="p">)</span> <span class="k">goto </span><span class="mi">6080</span>
<a name="ln-1260"></a><span class="c">!6070    continue</span>
<a name="ln-1261"></a>        <span class="n">fails</span> <span class="o">=</span> <span class="n">fails</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1262"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">6071</span><span class="p">)</span> <span class="n">x</span>
<a name="ln-1263"></a><span class="mi">6071</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE:  x/x differs from 1 when x = &#39;</span><span class="p">,</span><span class="n">e13</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1264"></a>        <span class="k">goto </span><span class="mi">6090</span>
<a name="ln-1265"></a><span class="mi">6080</span>    <span class="k">continue</span>
<a name="ln-1266"></a><span class="k">        </span><span class="n">sdefct</span> <span class="o">=</span> <span class="n">sdefct</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1267"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">6081</span><span class="p">)</span> <span class="n">x</span>
<a name="ln-1268"></a><span class="mi">6081</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; SERIOUS DEFECT:  x/x differs from 1 when x = &#39;</span><span class="p">,</span><span class="n">e13</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1269"></a><span class="mi">6090</span>    <span class="k">continue</span>
<a name="ln-1270"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">6091</span><span class="p">)</span> <span class="n">v9</span>
<a name="ln-1271"></a><span class="mi">6091</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;           instead,  x/x - 1/2 - 1/2 = &#39;</span><span class="p">,</span><span class="n">e13</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1272"></a><span class="mi">6100</span>    <span class="k">continue</span>
<a name="ln-1273"></a><span class="k">        return</span>
<a name="ln-1274"></a><span class="k">        end subroutine </span><span class="n">overf</span>
<a name="ln-1275"></a><span class="c">!#######################################################################</span>
<a name="ln-1276"></a><span class="c">!---</span>
<a name="ln-1277"></a>        <span class="k">subroutine </span><span class="n">page</span><span class="p">(</span><span class="n">mile</span><span class="p">)</span>
<a name="ln-1278"></a>      <span class="k">implicit none</span>
<a name="ln-1279"></a><span class="c">!</span>
<a name="ln-1280"></a>        <span class="kt">integer </span><span class="n">mile</span>
<a name="ln-1281"></a><span class="c">!        ... MILESTONE REACHED - PASSED THROUGH BY THE SUCCESSFUL CODE</span>
<a name="ln-1282"></a><span class="c">!</span>
<a name="ln-1283"></a><span class="c">!        THIS PROGRAM RUNS INTERACTIVELY PUTTING ALL OUTPUT TO A SCREEN.</span>
<a name="ln-1284"></a><span class="c">!        THE NEXT SUBPROGRAM PAUSES, ALLOWING YOU TO READ THE SCREEN OR</span>
<a name="ln-1285"></a><span class="c">!        COPY IT.</span>
<a name="ln-1286"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">110</span><span class="p">)</span>
<a name="ln-1287"></a><span class="mi">110</span>     <span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="s1">&#39; To continue diagnosis, press return.&#39;</span><span class="p">)</span>
<a name="ln-1288"></a>        <span class="k">read</span><span class="p">(</span><span class="n">in</span><span class="p">,</span><span class="mi">111</span><span class="p">)</span>
<a name="ln-1289"></a><span class="mi">111</span>     <span class="k">format</span> <span class="p">(</span><span class="n">a4</span><span class="p">)</span>
<a name="ln-1290"></a>        <span class="n">pgnumb</span><span class="o">=</span><span class="n">pgnumb</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1291"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">112</span><span class="p">)</span> <span class="n">mile</span><span class="p">,</span> <span class="n">pgnumb</span>
<a name="ln-1292"></a><span class="mi">112</span>     <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Diagnosis resumes after milestone  #&#39;</span><span class="p">,</span><span class="n">i5</span><span class="p">,</span><span class="s1">&#39;,    ... page &#39;</span><span class="p">,</span><span class="n">i5</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1293"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">fp0</span><span class="p">,</span><span class="n">fp1</span><span class="p">,</span><span class="n">fp2</span><span class="p">,</span><span class="n">fp3</span><span class="p">,</span><span class="n">fp4</span><span class="p">,</span><span class="n">fp8</span><span class="p">,</span><span class="n">fp9</span><span class="p">,</span><span class="n">fp27</span><span class="p">,</span><span class="n">fp32</span><span class="p">,</span><span class="n">half</span><span class="p">,</span><span class="n">minus1</span>
<a name="ln-1294"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">fails</span><span class="p">,</span><span class="n">sdefct</span><span class="p">,</span><span class="n">defect</span><span class="p">,</span><span class="n">flaws</span><span class="p">,</span><span class="nb">radix</span><span class="p">,</span><span class="n">ulppls</span><span class="p">,</span><span class="n">ulpmin</span><span class="p">,</span><span class="n">precis</span>
<a name="ln-1295"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">w</span><span class="p">,</span> <span class="n">mulgrd</span><span class="p">,</span><span class="n">divgrd</span><span class="p">,</span> <span class="n">subgrd</span><span class="p">,</span><span class="n">a1</span><span class="p">,</span><span class="n">onemin</span>
<a name="ln-1296"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">c1</span><span class="p">,</span> <span class="n">h1</span><span class="p">,</span> <span class="n">minpos</span><span class="p">,</span> <span class="n">nulps</span><span class="p">,</span> <span class="n">uflthr</span><span class="p">,</span> <span class="n">phony0</span><span class="p">,</span> <span class="n">ieee</span>
<a name="ln-1297"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r3</span><span class="p">,</span> <span class="n">r4</span><span class="p">,</span> <span class="n">sticky</span>
<a name="ln-1298"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">pgnumb</span><span class="p">,</span><span class="n">mile</span>
<a name="ln-1299"></a>        <span class="k">rewind </span><span class="mi">4</span>
<a name="ln-1300"></a>        <span class="n">mile</span><span class="o">=</span><span class="n">mile</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1301"></a>        <span class="k">return</span>
<a name="ln-1302"></a><span class="k">        end subroutine </span><span class="n">page</span>
<a name="ln-1303"></a><span class="c">!#######################################################################</span>
<a name="ln-1304"></a><span class="c">!---</span>
<a name="ln-1305"></a>        <span class="k">subroutine </span><span class="n">partuf</span> <span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">zname</span><span class="p">,</span> <span class="n">miles</span><span class="p">,</span> <span class="n">partu</span><span class="p">,</span> <span class="n">restrt</span><span class="p">)</span>
<a name="ln-1306"></a>      <span class="k">implicit none</span>
<a name="ln-1307"></a><span class="k">        </span><span class="kt">logical </span><span class="n">restrt</span>
<a name="ln-1308"></a><span class="c">!</span>
<a name="ln-1309"></a><span class="c">!</span>
<a name="ln-1310"></a>        <span class="kt">integer </span><span class="n">partu</span>
<a name="ln-1311"></a><span class="c">!        ... FLAG TO INDICATE THE PRESENCE OF PARTIAL UNDERFLOW</span>
<a name="ln-1312"></a>        <span class="kt">real </span><span class="n">z</span>
<a name="ln-1313"></a><span class="c">!        ... VALUE TO TEST FOR PARTIAL UNDERFLOW</span>
<a name="ln-1314"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">zname</span>
<a name="ln-1315"></a><span class="c">!        ... NAME OF THE VARIABLE Z (IN A8 FORMAT) FOR OUTPUT</span>
<a name="ln-1316"></a>        <span class="kt">integer </span><span class="n">miles</span>
<a name="ln-1317"></a><span class="c">!        ... NUMBER OF MILESTONE REACHED SO FAR FOR OUTPUT</span>
<a name="ln-1318"></a>        <span class="kt">real </span><span class="n">dummy</span>
<a name="ln-1319"></a><span class="c">!        ... TEMPORARY VARIABLE TO HOLD A RESULT THAT MAY ACTUALLY</span>
<a name="ln-1320"></a><span class="c">!        ... UNDERFLOW</span>
<a name="ln-1321"></a>        <span class="kt">real </span><span class="n">multp1</span>
<a name="ln-1322"></a><span class="c">!        ... TEMP. VARIABLE TO HOLD RESULT OF TEST FOR UNDERFLOW ON</span>
<a name="ln-1323"></a><span class="c">!        ... MULT BY 1</span>
<a name="ln-1324"></a>        <span class="kt">real </span><span class="n">multp2</span>
<a name="ln-1325"></a><span class="c">!        ... TEMP. VARIABLE TO HOLD RESULT OF TEST FOR UNDERFLOW ON</span>
<a name="ln-1326"></a><span class="c">!        ... 1 * SMALL</span>
<a name="ln-1327"></a>        <span class="kt">real </span><span class="n">divtmp</span>
<a name="ln-1328"></a><span class="c">!        ... TEMP. VARIABLE TO HOLD RESULT OF TEST FOR UNDERFLOW ON</span>
<a name="ln-1329"></a><span class="c">!        ... DIV BY 1</span>
<a name="ln-1330"></a><span class="c">!       ___ SUBROUTINE TO TEST  Z  FOR PARTIAL UNDERFLOW ___</span>
<a name="ln-1331"></a><span class="c">!4640    continue</span>
<a name="ln-1332"></a>        <span class="n">partu</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1333"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">restrt</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4740</span>
<a name="ln-1334"></a>        <span class="k">call </span><span class="n">logit</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-1335"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">4850</span>
<a name="ln-1336"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">4660</span><span class="p">)</span> <span class="n">zname</span><span class="p">,</span> <span class="n">zname</span><span class="p">,</span> <span class="n">zname</span><span class="p">,</span> <span class="n">zname</span>
<a name="ln-1337"></a><span class="mi">4660</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Since comparison denies  &#39;</span><span class="p">,</span><span class="n">a8</span><span class="p">,</span><span class="s1">&#39; = 0,&#39;</span><span class="o">/</span><span class="s1">&#39;  evaluating  (&#39;</span><span class="p">,</span><span class="n">a8</span><span class="p">,</span><span class="s1">&#39; + &#39;</span><span class="p">,</span><span class="n">a8</span><span class="p">,</span><span class="s1">&#39;) / &#39;</span><span class="p">,</span><span class="n">a8</span><span class="p">,</span><span class="s1">&#39;  should be safe;&#39;</span><span class="p">)</span>
<a name="ln-1338"></a>        <span class="n">dummy</span> <span class="o">=</span> <span class="p">(</span><span class="n">z</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span> <span class="o">/</span> <span class="n">z</span>
<a name="ln-1339"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">4665</span><span class="p">)</span> <span class="n">zname</span><span class="p">,</span> <span class="n">zname</span><span class="p">,</span> <span class="n">zname</span><span class="p">,</span> <span class="n">dummy</span>
<a name="ln-1340"></a><span class="mi">4665</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; what the machine gets for  (&#39;</span><span class="p">,</span><span class="n">a8</span><span class="p">,</span><span class="s1">&#39; + &#39;</span><span class="p">,</span><span class="n">a8</span><span class="p">,</span><span class="s1">&#39;) / &#39;</span><span class="p">,</span><span class="n">a8</span><span class="p">,</span><span class="s1">&#39;  is&#39;</span><span class="o">/</span><span class="mi">10</span><span class="n">x</span><span class="p">,</span> <span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1341"></a>        <span class="k">if</span> <span class="p">(</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dummy</span><span class="o">-</span><span class="n">fp2</span><span class="p">)</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="nb">radix</span><span class="o">*</span><span class="n">ulppls</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4750</span>
<a name="ln-1342"></a><span class="c">!4670    continue</span>
<a name="ln-1343"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">dummy</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">fp1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">dummy</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp2</span><span class="p">)</span> <span class="k">goto </span><span class="mi">4740</span>
<a name="ln-1344"></a>        <span class="n">partu</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1345"></a>        <span class="n">defect</span><span class="o">=</span><span class="n">defect</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1346"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4675</span><span class="p">)</span>
<a name="ln-1347"></a><span class="mi">4675</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; This is a DEFECT.&#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1348"></a>        <span class="k">goto </span><span class="mi">4760</span>
<a name="ln-1349"></a><span class="mi">4740</span>    <span class="k">continue</span>
<a name="ln-1350"></a><span class="k">        </span><span class="n">partu</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1351"></a>        <span class="n">sdefct</span><span class="o">=</span><span class="n">sdefct</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1352"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4745</span><span class="p">)</span>
<a name="ln-1353"></a><span class="mi">4745</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; This is a VERY SERIOUS DEFECT.&#39;</span><span class="p">)</span>
<a name="ln-1354"></a>        <span class="k">goto </span><span class="mi">4760</span>
<a name="ln-1355"></a><span class="mi">4750</span>    <span class="k">continue</span>
<a name="ln-1356"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4751</span><span class="p">)</span>
<a name="ln-1357"></a><span class="mi">4751</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; This is O.K. provided over/underflow has not just been signaled.&#39;</span><span class="p">)</span>
<a name="ln-1358"></a><span class="mi">4760</span>    <span class="k">continue</span>
<a name="ln-1359"></a><span class="k">        </span><span class="n">multp1</span><span class="o">=</span><span class="n">z</span><span class="o">*</span><span class="n">fp1</span>
<a name="ln-1360"></a>        <span class="n">multp2</span><span class="o">=</span><span class="n">fp1</span><span class="o">*</span><span class="n">z</span>
<a name="ln-1361"></a>        <span class="n">divtmp</span><span class="o">=</span><span class="n">z</span><span class="o">/</span><span class="n">fp1</span>
<a name="ln-1362"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">multp1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">z</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">multp2</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">z</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">divtmp</span><span class="p">)</span><span class="n">go</span> <span class="n">to</span> <span class="mi">4840</span>
<a name="ln-1363"></a><span class="c">!4770    continue</span>
<a name="ln-1364"></a>        <span class="n">partu</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1365"></a>        <span class="n">defect</span><span class="o">=</span><span class="n">defect</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1366"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4780</span><span class="p">)</span><span class="n">zname</span><span class="p">,</span><span class="n">z</span>
<a name="ln-1367"></a><span class="mi">4780</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; DEFECT:  what prints as  &#39;</span><span class="p">,</span><span class="n">a8</span><span class="p">,</span><span class="s1">&#39; =&#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39; compares different from&#39;</span><span class="p">)</span>
<a name="ln-1368"></a><span class="c">!4790    continue</span>
<a name="ln-1369"></a>        <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="p">(</span><span class="n">z</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">multp1</span><span class="p">))</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4795</span><span class="p">)</span><span class="n">zname</span><span class="p">,</span><span class="n">multp1</span>
<a name="ln-1370"></a><span class="mi">4795</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;           &#39;</span><span class="p">,</span><span class="n">a8</span><span class="p">,</span><span class="s1">&#39;*1 = &#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1371"></a><span class="c">!4800    continue</span>
<a name="ln-1372"></a>        <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="p">(</span><span class="n">z</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">multp2</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">multp2</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">multp1</span><span class="p">))</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4805</span><span class="p">)</span> <span class="n">zname</span><span class="p">,</span><span class="n">multp2</span>
<a name="ln-1373"></a><span class="mi">4805</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;           1*&#39;</span><span class="p">,</span><span class="n">a8</span><span class="p">,</span><span class="s1">&#39; = &#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1374"></a><span class="c">!4810    continue</span>
<a name="ln-1375"></a>        <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="p">(</span><span class="n">z</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">divtmp</span><span class="p">))</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4815</span><span class="p">)</span><span class="n">zname</span><span class="p">,</span><span class="n">divtmp</span>
<a name="ln-1376"></a><span class="mi">4815</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;           &#39;</span><span class="p">,</span><span class="n">a8</span><span class="p">,</span><span class="s1">&#39;/1 = &#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1377"></a><span class="c">!4820    continue</span>
<a name="ln-1378"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">multp2</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">multp1</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4840</span>
<a name="ln-1379"></a><span class="c">!4830    continue</span>
<a name="ln-1380"></a>        <span class="n">defect</span><span class="o">=</span><span class="n">defect</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1381"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4831</span><span class="p">)</span>
<a name="ln-1382"></a><span class="mi">4831</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; DEFECT: multiplication does not commute; comparison alleges that&#39;</span><span class="p">)</span>
<a name="ln-1383"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4833</span><span class="p">)</span><span class="n">zname</span><span class="p">,</span><span class="n">multp2</span><span class="p">,</span><span class="n">zname</span><span class="p">,</span><span class="n">multp1</span>
<a name="ln-1384"></a><span class="mi">4833</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;         1*&#39;</span><span class="p">,</span><span class="n">a8</span><span class="p">,</span><span class="s1">&#39; =&#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;  differs from  &#39;</span><span class="p">,</span><span class="n">a8</span><span class="p">,</span><span class="s1">&#39;*1 =&#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1385"></a><span class="mi">4840</span>    <span class="k">continue</span>
<a name="ln-1386"></a><span class="k">        if</span> <span class="p">(</span><span class="n">partu</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">page</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-1387"></a><span class="c">!       ---- PAUSE ----</span>
<a name="ln-1388"></a><span class="mi">4850</span>    <span class="k">continue</span>
<a name="ln-1389"></a><span class="k">        return</span>
<a name="ln-1390"></a><span class="k">        end subroutine </span><span class="n">partuf</span>
<a name="ln-1391"></a><span class="c">!#######################################################################</span>
<a name="ln-1392"></a>        <span class="k">subroutine </span><span class="n">power</span><span class="p">(</span><span class="n">miles</span><span class="p">,</span><span class="n">from</span><span class="p">)</span>
<a name="ln-1393"></a>      <span class="k">implicit none</span>
<a name="ln-1394"></a><span class="c">!---</span>
<a name="ln-1395"></a><span class="c">!</span>
<a name="ln-1396"></a>        <span class="kt">integer </span><span class="n">miles</span><span class="p">,</span><span class="n">from</span>
<a name="ln-1397"></a><span class="c">!       ... LOCAL VARIABLES</span>
<a name="ln-1398"></a>        <span class="kt">integer </span><span class="n">i</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n1</span>
<a name="ln-1399"></a>        <span class="kt">integer </span><span class="n">numtry</span>
<a name="ln-1400"></a>        <span class="kt">real </span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">a</span>
<a name="ln-1401"></a><span class="c">!       ... CONSTANTS</span>
<a name="ln-1402"></a>        <span class="kt">real </span><span class="n">fp0</span><span class="p">,</span> <span class="n">fp1</span><span class="p">,</span> <span class="n">fp2</span><span class="p">,</span> <span class="n">fp3</span><span class="p">,</span> <span class="n">fp4</span><span class="p">,</span> <span class="n">fp8</span><span class="p">,</span> <span class="n">minus1</span>
<a name="ln-1403"></a><span class="c">!</span>
<a name="ln-1404"></a>        <span class="n">fp0</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-1405"></a>        <span class="n">fp1</span> <span class="o">=</span> <span class="mf">1.0</span>
<a name="ln-1406"></a>        <span class="n">fp2</span> <span class="o">=</span> <span class="n">fp1</span> <span class="o">+</span> <span class="n">fp1</span>
<a name="ln-1407"></a>        <span class="n">fp3</span> <span class="o">=</span> <span class="n">fp2</span> <span class="o">+</span> <span class="n">fp1</span>
<a name="ln-1408"></a>        <span class="n">fp4</span> <span class="o">=</span> <span class="n">fp3</span> <span class="o">+</span> <span class="n">fp1</span>
<a name="ln-1409"></a>        <span class="n">fp8</span> <span class="o">=</span> <span class="n">fp4</span> <span class="o">+</span> <span class="n">fp4</span>
<a name="ln-1410"></a>        <span class="n">minus1</span> <span class="o">=</span> <span class="o">-</span><span class="n">fp1</span>
<a name="ln-1411"></a>        <span class="n">a</span> <span class="o">=</span> <span class="n">fp1</span> <span class="o">/</span> <span class="n">a1</span>
<a name="ln-1412"></a>        <span class="n">numtry</span> <span class="o">=</span> <span class="mi">20</span>
<a name="ln-1413"></a><span class="c">!</span>
<a name="ln-1414"></a><span class="c">!3970    continue</span>
<a name="ln-1415"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">3971</span><span class="p">)</span>
<a name="ln-1416"></a><span class="mi">3971</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Testing powers  z^i  for small integers  z  and  i :&#39;</span><span class="p">)</span>
<a name="ln-1417"></a>        <span class="k">if</span><span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">90</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">3972</span><span class="p">)</span>
<a name="ln-1418"></a><span class="mi">3972</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Start with 0.**0 .&#39;</span><span class="p">)</span>
<a name="ln-1419"></a><span class="c">!4120    continue</span>
<a name="ln-1420"></a>        <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1421"></a>        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1422"></a>        <span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="n">fp0</span>
<a name="ln-1423"></a>        <span class="n">m</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-1424"></a>        <span class="k">if</span><span class="p">(</span><span class="n">from</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">90</span><span class="p">)</span> <span class="k">goto </span><span class="mi">4160</span>
<a name="ln-1425"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">badmil</span>
<a name="ln-1426"></a><span class="c">!                       TEST POWERS OF ZERO</span>
<a name="ln-1427"></a><span class="mi">4130</span>    <span class="k">continue</span>
<a name="ln-1428"></a><span class="k">        </span><span class="n">x</span> <span class="o">=</span> <span class="n">fp1</span>
<a name="ln-1429"></a>        <span class="k">call </span><span class="n">pwrcmp</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<a name="ln-1430"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">10</span><span class="p">)</span> <span class="k">goto </span><span class="mi">4150</span>
<a name="ln-1431"></a><span class="c">!4140    continue</span>
<a name="ln-1432"></a>        <span class="n">i</span> <span class="o">=</span> <span class="mi">1023</span>
<a name="ln-1433"></a>        <span class="k">call </span><span class="n">pwrcmp</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<a name="ln-1434"></a><span class="mi">4150</span>    <span class="k">continue</span>
<a name="ln-1435"></a><span class="k">        if</span> <span class="p">(</span><span class="n">z</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">minus1</span><span class="p">)</span> <span class="k">goto  </span><span class="mi">4170</span>
<a name="ln-1436"></a><span class="c">!                       IF (-1)^N IS INVALID, REPLACE &#39;MINUS1&#39; BY &#39;FP1&#39;</span>
<a name="ln-1437"></a><span class="mi">4160</span>    <span class="k">continue</span>
<a name="ln-1438"></a><span class="k">        </span><span class="n">z</span> <span class="o">=</span> <span class="n">minus1</span>
<a name="ln-1439"></a>        <span class="n">i</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>
<a name="ln-1440"></a>        <span class="k">goto </span><span class="mi">4130</span>
<a name="ln-1441"></a><span class="c">!                       PRINT  N  IF  N &gt; 0.</span>
<a name="ln-1442"></a><span class="mi">4170</span>    <span class="k">continue</span>
<a name="ln-1443"></a><span class="k">        call </span><span class="n">prtcnt</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a name="ln-1444"></a><span class="c">!4180    continue</span>
<a name="ln-1445"></a>        <span class="n">n1</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-1446"></a>        <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1447"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">a1</span>
<a name="ln-1448"></a>        <span class="n">m</span> <span class="o">=</span>   <span class="nb">int</span><span class="p">(</span><span class="n">fp2</span> <span class="o">*</span> <span class="nb">alog</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">/</span> <span class="nb">alog</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1449"></a><span class="c">!</span>
<a name="ln-1450"></a><span class="c">!                       LOOP</span>
<a name="ln-1451"></a><span class="c">!</span>
<a name="ln-1452"></a><span class="mi">4190</span>    <span class="k">continue</span>
<a name="ln-1453"></a><span class="k">        </span><span class="n">x</span> <span class="o">=</span> <span class="n">z</span>
<a name="ln-1454"></a>        <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1455"></a>        <span class="k">call </span><span class="n">pwrcmp</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<a name="ln-1456"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">a</span><span class="p">)</span> <span class="k">goto </span><span class="mi">4210</span>
<a name="ln-1457"></a><span class="c">!4200    continue</span>
<a name="ln-1458"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">a</span>
<a name="ln-1459"></a>        <span class="k">goto </span><span class="mi">4190</span>
<a name="ln-1460"></a><span class="c">!</span>
<a name="ln-1461"></a><span class="c">!       POWERS OF RADIX  B  HAVE BEEN TESTED; NEXT TRY A FEW PRIMES.</span>
<a name="ln-1462"></a><span class="c">!</span>
<a name="ln-1463"></a><span class="mi">4210</span>    <span class="k">continue</span>
<a name="ln-1464"></a><span class="k">        </span><span class="n">miles</span><span class="o">=</span><span class="mi">100</span>
<a name="ln-1465"></a><span class="c">!4220    continue</span>
<a name="ln-1466"></a>        <span class="n">m</span> <span class="o">=</span> <span class="n">numtry</span>
<a name="ln-1467"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">fp3</span>
<a name="ln-1468"></a><span class="mi">4230</span>    <span class="k">continue</span>
<a name="ln-1469"></a><span class="k">        </span><span class="n">x</span> <span class="o">=</span> <span class="n">z</span>
<a name="ln-1470"></a>        <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1471"></a>        <span class="k">call </span><span class="n">pwrcmp</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<a name="ln-1472"></a><span class="mi">4240</span>    <span class="k">continue</span>
<a name="ln-1473"></a><span class="k">        </span><span class="n">z</span> <span class="o">=</span> <span class="n">z</span> <span class="o">+</span> <span class="n">fp2</span>
<a name="ln-1474"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">fp3</span> <span class="o">*</span> <span class="nb">aint</span> <span class="p">(</span><span class="n">z</span> <span class="o">/</span> <span class="n">fp3</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">z</span><span class="p">)</span> <span class="k">goto </span><span class="mi">4240</span>
<a name="ln-1475"></a><span class="c">!4250    continue</span>
<a name="ln-1476"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">fp8</span> <span class="o">*</span> <span class="n">fp3</span><span class="p">)</span> <span class="k">goto </span><span class="mi">4230</span>
<a name="ln-1477"></a><span class="c">!4260    continue</span>
<a name="ln-1478"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4261</span><span class="p">)</span>
<a name="ln-1479"></a><span class="mi">4261</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Error like this may invalidate financial&#39;</span><span class="o">/</span><span class="s1">&#39; calculations involving interest rates.&#39;</span><span class="p">)</span>
<a name="ln-1480"></a><span class="c">!4270    continue</span>
<a name="ln-1481"></a>        <span class="k">call </span><span class="n">prtcnt</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a name="ln-1482"></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="n">n1</span>
<a name="ln-1483"></a>        <span class="k">call </span><span class="n">prt2</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">miles</span><span class="p">)</span>
<a name="ln-1484"></a>        <span class="k">return</span>
<a name="ln-1485"></a><span class="k">        end subroutine </span><span class="n">power</span>
<a name="ln-1486"></a><span class="c">!#######################################################################</span>
<a name="ln-1487"></a><span class="c">!---</span>
<a name="ln-1488"></a>        <span class="k">subroutine </span><span class="n">radx</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-1489"></a>      <span class="k">implicit none</span>
<a name="ln-1490"></a><span class="c">!</span>
<a name="ln-1491"></a><span class="c">!</span>
<a name="ln-1492"></a>        <span class="kt">integer </span><span class="n">miles</span>
<a name="ln-1493"></a><span class="c">!        ... COUNT OF MILESTONES PASSED</span>
<a name="ln-1494"></a>        <span class="kt">real </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span>
<a name="ln-1495"></a><span class="c">!        ... SCRATCH VARIABLES</span>
<a name="ln-1496"></a>        <span class="kt">real </span><span class="n">ulpmsv</span><span class="p">,</span><span class="n">radsav</span>
<a name="ln-1497"></a><span class="c">!        ... TEMPS TO SAVE ULPMIN, ULPPLS, RADIX, PRECIS IN WHILE</span>
<a name="ln-1498"></a><span class="c">!        ... RECOMPUTING</span>
<a name="ln-1499"></a>        <span class="kt">real </span><span class="n">third</span><span class="p">,</span><span class="n">sixth</span>
<a name="ln-1500"></a><span class="c">!        ... TEMPS TO HOLD APPROX VALUES OF 1/3 AND 1/6 IN WHILE</span>
<a name="ln-1501"></a><span class="c">!        ... ACCUMULATING ERROR FOR RADIX COMPUTATIONS.</span>
<a name="ln-1502"></a>        <span class="kt">real </span><span class="n">b9</span><span class="p">,</span> <span class="n">t8</span>
<a name="ln-1503"></a>        <span class="kt">integer </span><span class="n">i</span>
<a name="ln-1504"></a><span class="c">!</span>
<a name="ln-1505"></a>        <span class="n">t8</span> <span class="o">=</span> <span class="mi">24</span><span class="mf">0.0</span>
<a name="ln-1506"></a><span class="c">!</span>
<a name="ln-1507"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1160</span><span class="p">)</span>
<a name="ln-1508"></a><span class="mi">1160</span>    <span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="s1">&#39; Searching for radix and precision...&#39;</span><span class="p">)</span>
<a name="ln-1509"></a><span class="c">!       LOOKING FOR W TO BE BIG ENOUGH TO MAKE 1 INSIGNIFICANT AT THE</span>
<a name="ln-1510"></a><span class="c">!       PRECISION AVAILABLE.  INCREASE BY POWERS OF 2 UNTIL WE FIND IT.</span>
<a name="ln-1511"></a><span class="c">!1170    continue</span>
<a name="ln-1512"></a>        <span class="n">w</span><span class="o">=</span><span class="n">fp1</span>
<a name="ln-1513"></a><span class="mi">1180</span>    <span class="k">continue</span>
<a name="ln-1514"></a><span class="k">        </span><span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="o">+</span><span class="n">w</span>
<a name="ln-1515"></a>        <span class="n">y</span><span class="o">=</span><span class="n">w</span><span class="o">+</span><span class="n">fp1</span>
<a name="ln-1516"></a>        <span class="n">z</span><span class="o">=</span><span class="n">y</span><span class="o">-</span><span class="n">w</span>
<a name="ln-1517"></a>        <span class="n">y</span><span class="o">=</span><span class="n">z</span><span class="o">-</span><span class="n">fp1</span>
<a name="ln-1518"></a>        <span class="k">if</span> <span class="p">((</span><span class="o">-</span><span class="n">fp1</span><span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1180</span>
<a name="ln-1519"></a><span class="c">!       ... NOW  W  IS JUST BIG ENOUGH THAT  |((W+1)-W)-1| &gt;= 1 ...</span>
<a name="ln-1520"></a><span class="c">!        I.E. 1 IS INSIGNIFICANT RELATIVE TO W.</span>
<a name="ln-1521"></a><span class="c">!1200    continue</span>
<a name="ln-1522"></a>        <span class="n">precis</span><span class="o">=</span><span class="n">fp0</span>
<a name="ln-1523"></a>        <span class="n">y</span><span class="o">=</span><span class="n">fp1</span>
<a name="ln-1524"></a><span class="mi">1210</span>    <span class="k">continue</span>
<a name="ln-1525"></a><span class="k">        </span><span class="nb">radix</span><span class="o">=</span><span class="n">w</span><span class="o">+</span><span class="n">y</span>
<a name="ln-1526"></a>        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">+</span><span class="n">y</span>
<a name="ln-1527"></a>        <span class="nb">radix</span><span class="o">=</span><span class="nb">radix</span><span class="o">-</span><span class="n">w</span>
<a name="ln-1528"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">radix</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1210</span>
<a name="ln-1529"></a><span class="c">!</span>
<a name="ln-1530"></a><span class="c">!1220    continue</span>
<a name="ln-1531"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">radix</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="n">fp2</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1235</span>
<a name="ln-1532"></a>        <span class="nb">radix</span> <span class="o">=</span> <span class="n">fp1</span>
<a name="ln-1533"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1230</span><span class="p">)</span>     <span class="nb">radix</span>
<a name="ln-1534"></a><span class="mi">1230</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Radix = &#39;</span><span class="p">,</span><span class="n">f7</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-1535"></a>        <span class="k">goto </span><span class="mi">1270</span>
<a name="ln-1536"></a><span class="c">!          BASE IS 1, SO IT IS NOT CHARACTERIZED BY A PRECISION, SO</span>
<a name="ln-1537"></a><span class="c">!          DON&#39;T BOTHER TO HUNT FOR IT..</span>
<a name="ln-1538"></a><span class="c">!</span>
<a name="ln-1539"></a><span class="c">!</span>
<a name="ln-1540"></a><span class="c">!               ... RADIX &gt;= 2 ...</span>
<a name="ln-1541"></a><span class="c">!        NOW TRY TO FIND THE PRECISION (# SIG. DIGITS)</span>
<a name="ln-1542"></a><span class="mi">1235</span>    <span class="k">continue</span>
<a name="ln-1543"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1236</span><span class="p">)</span> <span class="nb">radix</span>
<a name="ln-1544"></a><span class="mi">1236</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Radix = &#39;</span><span class="p">,</span><span class="n">f4</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-1545"></a><span class="c">!1240    continue</span>
<a name="ln-1546"></a>        <span class="n">w</span><span class="o">=</span><span class="n">fp1</span>
<a name="ln-1547"></a><span class="mi">1250</span>    <span class="k">continue</span>
<a name="ln-1548"></a><span class="k">        </span><span class="n">precis</span><span class="o">=</span><span class="n">precis</span><span class="o">+</span><span class="n">fp1</span>
<a name="ln-1549"></a>        <span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="o">*</span><span class="nb">radix</span>
<a name="ln-1550"></a><span class="nb">        </span><span class="n">y</span><span class="o">=</span><span class="n">w</span><span class="o">+</span><span class="n">fp1</span>
<a name="ln-1551"></a>        <span class="n">z</span><span class="o">=</span><span class="n">y</span><span class="o">-</span><span class="n">w</span>
<a name="ln-1552"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp1</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1250</span>
<a name="ln-1553"></a><span class="c">!        ... NOW  W = RADIX^PRECIS  IS BARELY TOO BIG TO SATISFY</span>
<a name="ln-1554"></a><span class="c">!        ... (W+1)-W = 1  .</span>
<a name="ln-1555"></a><span class="mi">1270</span>    <span class="k">continue</span>
<a name="ln-1556"></a><span class="k">        </span><span class="n">ulpmin</span><span class="o">=</span><span class="n">fp1</span><span class="o">/</span><span class="n">w</span>
<a name="ln-1557"></a>        <span class="n">ulppls</span><span class="o">=</span><span class="nb">radix</span><span class="o">*</span><span class="n">ulpmin</span>
<a name="ln-1558"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1271</span><span class="p">)</span> <span class="n">ulpmin</span>
<a name="ln-1559"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1280</span><span class="p">)</span>
<a name="ln-1560"></a><span class="mi">1271</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Closest relative separation found is &#39;</span><span class="p">,</span><span class="mi">1</span><span class="n">pe16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1561"></a><span class="mi">1280</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Recalculating radix and precision &#39;</span><span class="p">)</span>
<a name="ln-1562"></a><span class="c">!1290    continue</span>
<a name="ln-1563"></a>        <span class="n">radsav</span><span class="o">=</span><span class="nb">radix</span>
<a name="ln-1564"></a><span class="nb">        </span><span class="n">ulpmsv</span><span class="o">=</span><span class="n">ulpmin</span>
<a name="ln-1565"></a><span class="c">!                                               ...  SAVE OLD VALUES</span>
<a name="ln-1566"></a><span class="c">!1300    continue</span>
<a name="ln-1567"></a>        <span class="n">x</span><span class="o">=</span><span class="n">fp4</span><span class="o">/</span><span class="mf">3.0e0</span>
<a name="ln-1568"></a>        <span class="n">third</span><span class="o">=</span><span class="n">x</span><span class="o">-</span><span class="n">fp1</span>
<a name="ln-1569"></a>        <span class="n">sixth</span><span class="o">=</span><span class="p">(</span><span class="n">fp1</span><span class="o">/</span><span class="n">fp2</span><span class="p">)</span><span class="o">-</span><span class="n">third</span>
<a name="ln-1570"></a>        <span class="n">x</span><span class="o">=</span><span class="n">sixth</span><span class="o">+</span><span class="n">sixth</span>
<a name="ln-1571"></a>        <span class="n">x</span><span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">third</span><span class="p">)</span>
<a name="ln-1572"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">ulppls</span><span class="p">)</span> <span class="n">x</span><span class="o">=</span><span class="n">ulppls</span>
<a name="ln-1573"></a><span class="c">!       ... NOW  X = (UNKNOWN NO.) ULPS OF  1 + ...</span>
<a name="ln-1574"></a><span class="mi">1320</span>    <span class="k">continue</span>
<a name="ln-1575"></a><span class="k">        </span><span class="n">ulppls</span><span class="o">=</span><span class="n">x</span>
<a name="ln-1576"></a>        <span class="n">y</span><span class="o">=</span><span class="p">(</span><span class="n">fp1</span><span class="o">/</span><span class="n">fp2</span><span class="p">)</span><span class="o">*</span><span class="n">ulppls</span><span class="o">+</span><span class="mf">3.2e1</span><span class="o">*</span><span class="n">ulppls</span><span class="o">*</span><span class="n">ulppls</span>
<a name="ln-1577"></a>        <span class="n">y</span><span class="o">=</span><span class="n">fp1</span><span class="o">+</span><span class="n">y</span>
<a name="ln-1578"></a>        <span class="n">x</span><span class="o">=</span><span class="n">y</span><span class="o">-</span><span class="n">fp1</span>
<a name="ln-1579"></a><span class="c">!       X=&gt; ((X/2) + EPSILON) MOD (1 ULP OF 1+)</span>
<a name="ln-1580"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ulppls</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">x</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">x</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1320</span>
<a name="ln-1581"></a><span class="c">!        IF X DOES NOT UNDERFLOW TO 0, THEN IT IS STILL (UNKNOWN) * ULP</span>
<a name="ln-1582"></a><span class="c">!        SO TRY AGAIN....  OTHERWISE, PREVIOUS VALUE (ULPPLS) IS 1 ULP</span>
<a name="ln-1583"></a><span class="c">!       ... NOW  ULPPLS = 1 ULP OF  1 + ...</span>
<a name="ln-1584"></a><span class="c">!1340    continue</span>
<a name="ln-1585"></a>        <span class="n">x</span><span class="o">=</span><span class="n">fp2</span><span class="o">/</span><span class="mf">3.0e0</span>
<a name="ln-1586"></a>        <span class="n">sixth</span><span class="o">=</span><span class="n">x</span><span class="o">-</span><span class="p">(</span><span class="n">fp1</span><span class="o">/</span><span class="n">fp2</span><span class="p">)</span>
<a name="ln-1587"></a>        <span class="n">third</span><span class="o">=</span><span class="n">sixth</span><span class="o">+</span><span class="n">sixth</span>
<a name="ln-1588"></a>        <span class="n">x</span><span class="o">=</span><span class="n">third</span><span class="o">-</span><span class="p">(</span><span class="n">fp1</span><span class="o">/</span><span class="n">fp2</span><span class="p">)</span>
<a name="ln-1589"></a>        <span class="n">x</span><span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">sixth</span><span class="p">)</span>
<a name="ln-1590"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">ulpmin</span><span class="p">)</span> <span class="n">x</span><span class="o">=</span><span class="n">ulpmin</span>
<a name="ln-1591"></a><span class="c">!       ... NOW  X = (UNKNOWN NO.) ULPS OF  1 - ...</span>
<a name="ln-1592"></a><span class="mi">1360</span>    <span class="k">continue</span>
<a name="ln-1593"></a><span class="k">        </span><span class="n">ulpmin</span><span class="o">=</span><span class="n">x</span>
<a name="ln-1594"></a>        <span class="n">y</span><span class="o">=</span><span class="p">(</span><span class="n">fp1</span><span class="o">/</span><span class="n">fp2</span><span class="p">)</span><span class="o">*</span><span class="n">ulpmin</span><span class="o">+</span><span class="mf">3.2e1</span><span class="o">*</span><span class="n">ulpmin</span><span class="o">*</span><span class="n">ulpmin</span>
<a name="ln-1595"></a>        <span class="n">y</span><span class="o">=</span><span class="p">(</span><span class="n">fp1</span><span class="o">/</span><span class="n">fp2</span><span class="p">)</span><span class="o">-</span><span class="n">y</span>
<a name="ln-1596"></a>        <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">fp1</span><span class="o">/</span><span class="n">fp2</span><span class="p">)</span><span class="o">+</span><span class="n">y</span>
<a name="ln-1597"></a>        <span class="n">y</span><span class="o">=</span><span class="p">(</span><span class="n">fp1</span><span class="o">/</span><span class="n">fp2</span><span class="p">)</span><span class="o">-</span><span class="n">x</span>
<a name="ln-1598"></a>        <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">fp1</span><span class="o">/</span><span class="n">fp2</span><span class="p">)</span><span class="o">+</span><span class="n">y</span>
<a name="ln-1599"></a><span class="c">!        X =&gt; (X/2 = EPSILON) MOD (1 ULP OF 1-)</span>
<a name="ln-1600"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ulpmin</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">x</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">x</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1360</span>
<a name="ln-1601"></a><span class="c">!       ... NOW  ULPMIN = 1 ULP OF  1 - ...</span>
<a name="ln-1602"></a><span class="c">!</span>
<a name="ln-1603"></a><span class="c">!       NOW TO SUMMARIZE THE RESULTS</span>
<a name="ln-1604"></a><span class="c">!</span>
<a name="ln-1605"></a><span class="c">!1380    continue</span>
<a name="ln-1606"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ulpmin</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">ulpmsv</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1381</span><span class="p">)</span>
<a name="ln-1607"></a><span class="mi">1381</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; confirms closest relative separation .&#39;</span><span class="p">)</span>
<a name="ln-1608"></a><span class="c">!1390    continue</span>
<a name="ln-1609"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ulpmin</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">ulpmsv</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1391</span><span class="p">)</span> <span class="n">ulpmin</span>
<a name="ln-1610"></a><span class="mi">1391</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; gets better closest relative separation = &#39;</span><span class="p">,</span> <span class="n">e13</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1611"></a><span class="c">!1400    continue</span>
<a name="ln-1612"></a>        <span class="n">w</span><span class="o">=</span><span class="n">fp1</span><span class="o">/</span><span class="n">ulpmin</span>
<a name="ln-1613"></a>        <span class="n">onemin</span> <span class="o">=</span> <span class="p">(</span><span class="n">half</span> <span class="o">-</span> <span class="n">ulpmin</span><span class="p">)</span> <span class="o">+</span> <span class="n">half</span>
<a name="ln-1614"></a><span class="c">!       ... = 1 - ULPMIN = NEXTAFTER(1.0, 0)</span>
<a name="ln-1615"></a><span class="c">!1410    continue</span>
<a name="ln-1616"></a>        <span class="nb">radix</span><span class="o">=</span><span class="nb">aint</span><span class="p">(.</span><span class="mi">01</span> <span class="o">+</span> <span class="n">ulppls</span><span class="o">/</span><span class="n">ulpmin</span><span class="p">)</span>
<a name="ln-1617"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">radix</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">radsav</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1411</span><span class="p">)</span>
<a name="ln-1618"></a><span class="mi">1411</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Radix confirmed.&#39;</span><span class="p">)</span>
<a name="ln-1619"></a><span class="c">!1420    continue</span>
<a name="ln-1620"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">radix</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">radsav</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1421</span><span class="p">)</span> <span class="nb">radix</span>
<a name="ln-1621"></a><span class="mi">1421</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; mystery: recalculated radix = &#39;</span><span class="p">,</span> <span class="n">e13</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1622"></a><span class="c">!</span>
<a name="ln-1623"></a><span class="c">!       ... RADICES 1, 2 AND 10 PASS MUSTER</span>
<a name="ln-1624"></a><span class="c">!</span>
<a name="ln-1625"></a><span class="c">!1430    continue</span>
<a name="ln-1626"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">radix</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp2</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">radix</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">1.0e1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">radix</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp1</span><span class="p">)</span><span class="k">goto </span><span class="mi">1470</span>
<a name="ln-1627"></a><span class="c">!1440    continue</span>
<a name="ln-1628"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">radix</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">1.6e1</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1460</span>
<a name="ln-1629"></a><span class="c">!1450    continue</span>
<a name="ln-1630"></a>        <span class="n">flaws</span><span class="o">=</span><span class="n">flaws</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1631"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1451</span><span class="p">)</span> <span class="nb">radix</span>
<a name="ln-1632"></a><span class="mi">1451</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FLAW: radix =&#39;</span><span class="p">,</span><span class="n">f4</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39; is not so good as 2 or 10.&#39;</span><span class="p">)</span>
<a name="ln-1633"></a>        <span class="k">goto </span><span class="mi">1470</span>
<a name="ln-1634"></a><span class="mi">1460</span>    <span class="k">continue</span>
<a name="ln-1635"></a><span class="k">        </span><span class="n">defect</span><span class="o">=</span><span class="n">defect</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1636"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1461</span><span class="p">)</span> <span class="nb">radix</span>
<a name="ln-1637"></a><span class="mi">1461</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; DEFECT: radix =&#39;</span><span class="p">,</span><span class="n">f4</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39; is so big that roundoff propagates capriciously.&#39;</span><span class="p">)</span>
<a name="ln-1638"></a><span class="mi">1470</span>    <span class="k">continue</span>
<a name="ln-1639"></a><span class="k">        </span><span class="n">miles</span><span class="o">=</span><span class="mi">20</span>
<a name="ln-1640"></a><span class="c">!       TEST FOR FUZZY COMPARISON ... ==================================</span>
<a name="ln-1641"></a><span class="c">!1480    continue</span>
<a name="ln-1642"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">onemin</span><span class="o">-</span><span class="n">half</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">half</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1510</span>
<a name="ln-1643"></a><span class="c">!1490    continue</span>
<a name="ln-1644"></a>        <span class="n">fails</span><span class="o">=</span><span class="n">fails</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1645"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1500</span><span class="p">)</span>
<a name="ln-1646"></a><span class="mi">1500</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE: (1-u1)-1/2 &lt; 1/2  is false, so this program may malfunction.&#39;</span><span class="p">)</span>
<a name="ln-1647"></a><span class="mi">1510</span>    <span class="k">continue</span>
<a name="ln-1648"></a><span class="k">        </span><span class="n">x</span><span class="o">=</span><span class="n">onemin</span>
<a name="ln-1649"></a>        <span class="n">i</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1650"></a><span class="mi">1520</span>    <span class="k">continue</span>
<a name="ln-1651"></a><span class="k">        </span><span class="n">y</span><span class="o">=</span><span class="n">x</span><span class="o">-</span><span class="n">half</span>
<a name="ln-1652"></a>        <span class="n">z</span><span class="o">=</span><span class="n">y</span><span class="o">-</span><span class="n">half</span>
<a name="ln-1653"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">fp1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">z</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1540</span>
<a name="ln-1654"></a><span class="c">!1530    continue</span>
<a name="ln-1655"></a>        <span class="n">fails</span><span class="o">=</span><span class="n">fails</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1656"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1535</span><span class="p">)</span>
<a name="ln-1657"></a><span class="mi">1535</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE: comparison is fuzzy; it alleges x=1 although&#39;</span><span class="p">)</span>
<a name="ln-1658"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1537</span><span class="p">)</span><span class="n">z</span>
<a name="ln-1659"></a><span class="mi">1537</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;         subtraction yields  (x - 1/2) - 1/2 = &#39;</span><span class="p">,</span><span class="n">d16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1660"></a><span class="mi">1540</span>    <span class="k">continue</span>
<a name="ln-1661"></a><span class="k">        if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1560</span>
<a name="ln-1662"></a><span class="c">!1550    continue</span>
<a name="ln-1663"></a>        <span class="n">x</span><span class="o">=</span><span class="n">fp1</span><span class="o">+</span><span class="n">ulppls</span>
<a name="ln-1664"></a>        <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1665"></a>        <span class="k">goto </span><span class="mi">1520</span>
<a name="ln-1666"></a><span class="mi">1560</span>    <span class="k">continue</span>
<a name="ln-1667"></a><span class="k">        </span><span class="n">miles</span><span class="o">=</span><span class="mi">25</span>
<a name="ln-1668"></a><span class="c">!       END OF TEST FOR FUZZY COMPARISON.===============================</span>
<a name="ln-1669"></a><span class="c">!1570    continue</span>
<a name="ln-1670"></a>        <span class="n">b9</span> <span class="o">=</span> <span class="nb">radix</span> <span class="o">-</span> <span class="n">fp1</span>
<a name="ln-1671"></a>        <span class="n">b9</span><span class="o">=</span><span class="p">(</span><span class="n">b9</span><span class="o">-</span><span class="n">ulppls</span><span class="p">)</span><span class="o">+</span><span class="n">fp1</span>
<a name="ln-1672"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">radix</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp1</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1610</span>
<a name="ln-1673"></a><span class="c">!       ... B9 = NEXTAFTER(RADIX, 0)</span>
<a name="ln-1674"></a><span class="c">!1580    continue</span>
<a name="ln-1675"></a>        <span class="n">x</span><span class="o">=-</span><span class="n">t8</span><span class="o">*</span><span class="nb">alog</span><span class="p">(</span><span class="n">ulpmin</span><span class="p">)</span><span class="o">/</span><span class="nb">alog</span><span class="p">(</span><span class="nb">radix</span><span class="p">)</span>
<a name="ln-1676"></a>        <span class="n">y</span><span class="o">=</span><span class="nb">aint</span><span class="p">(</span><span class="n">half</span><span class="o">+</span><span class="n">x</span><span class="p">)</span>
<a name="ln-1677"></a>        <span class="k">if</span> <span class="p">(</span>  <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">fp4</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">fp1</span> <span class="p">)</span> <span class="n">x</span><span class="o">=</span><span class="n">y</span>
<a name="ln-1678"></a><span class="c">!1590    continue</span>
<a name="ln-1679"></a>        <span class="n">precis</span> <span class="o">=</span> <span class="n">x</span><span class="o">/</span><span class="n">t8</span>
<a name="ln-1680"></a>        <span class="n">y</span><span class="o">=</span><span class="nb">aint</span><span class="p">(</span><span class="n">half</span> <span class="o">+</span> <span class="n">precis</span><span class="p">)</span>
<a name="ln-1681"></a>        <span class="k">if</span> <span class="p">(</span>  <span class="nb">abs</span><span class="p">(</span><span class="n">precis</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">t8</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">half</span> <span class="p">)</span> <span class="n">precis</span><span class="o">=</span><span class="n">y</span>
<a name="ln-1682"></a><span class="c">!       PURIFY INTEGERS.</span>
<a name="ln-1683"></a><span class="c">!1600    continue</span>
<a name="ln-1684"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">precis</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="nb">aint</span><span class="p">(</span><span class="n">precis</span><span class="p">))</span> <span class="k">goto </span><span class="mi">1640</span>
<a name="ln-1685"></a><span class="mi">1610</span>    <span class="k">continue</span>
<a name="ln-1686"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1611</span><span class="p">)</span>
<a name="ln-1687"></a><span class="mi">1611</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Precision cannot be characterized by an integer number of sig. digits;&#39;</span><span class="p">)</span>
<a name="ln-1688"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">radix</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp1</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1625</span>
<a name="ln-1689"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1620</span><span class="p">)</span>
<a name="ln-1690"></a><span class="mi">1620</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Logarithmic encoding (radix=1) has precision characterized solely by  u1 .&#39;</span><span class="p">)</span>
<a name="ln-1691"></a>        <span class="k">goto </span><span class="mi">1650</span>
<a name="ln-1692"></a><span class="mi">1625</span>    <span class="k">continue</span>
<a name="ln-1693"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1630</span><span class="p">)</span>
<a name="ln-1694"></a><span class="mi">1630</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; but, by itself, this is a minor flaw.&#39;</span><span class="p">)</span>
<a name="ln-1695"></a><span class="mi">1640</span>    <span class="k">continue</span>
<a name="ln-1696"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1641</span><span class="p">)</span> <span class="nb">radix</span><span class="p">,</span><span class="n">precis</span>
<a name="ln-1697"></a><span class="mi">1641</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; The number of significant digits of radix &#39;</span><span class="p">,</span><span class="n">f4</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39; is &#39;</span> <span class="p">,</span> <span class="n">f6</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1698"></a><span class="mi">1650</span>    <span class="k">continue</span>
<a name="ln-1699"></a><span class="k">        if</span> <span class="p">(</span><span class="n">ulppls</span><span class="o">*</span><span class="n">fp9</span><span class="o">*</span><span class="n">fp9</span><span class="o">*</span><span class="n">t8</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">fp1</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">1670</span>
<a name="ln-1700"></a><span class="c">!1660    continue</span>
<a name="ln-1701"></a>        <span class="n">sdefct</span><span class="o">=</span><span class="n">sdefct</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1702"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1665</span><span class="p">)</span>
<a name="ln-1703"></a><span class="mi">1665</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; SERIOUS DEFECT: precision worse than  5 sig. dec. is usually inadequate.&#39;</span><span class="p">)</span>
<a name="ln-1704"></a><span class="mi">1670</span>    <span class="k">continue</span>
<a name="ln-1705"></a><span class="k">        return</span>
<a name="ln-1706"></a><span class="k">        end subroutine </span><span class="n">radx</span>
<a name="ln-1707"></a><span class="c">!#######################################################################</span>
<a name="ln-1708"></a><span class="c">!---</span>
<a name="ln-1709"></a>        <span class="k">subroutine </span><span class="n">round</span> <span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-1710"></a>      <span class="k">implicit none</span>
<a name="ln-1711"></a><span class="k">        </span><span class="kt">integer </span><span class="n">miles</span>
<a name="ln-1712"></a><span class="c">!</span>
<a name="ln-1713"></a><span class="c">!</span>
<a name="ln-1714"></a><span class="c">!</span>
<a name="ln-1715"></a><span class="c">!       ... LOCAL VARIABLES</span>
<a name="ln-1716"></a>        <span class="kt">real </span><span class="n">a</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z</span>
<a name="ln-1717"></a><span class="c">!       ... CONSTANTS</span>
<a name="ln-1718"></a>        <span class="kt">real </span><span class="n">b2</span><span class="p">,</span> <span class="n">t5</span><span class="p">,</span> <span class="n">b9</span>
<a name="ln-1719"></a><span class="c">!</span>
<a name="ln-1720"></a>        <span class="n">b2</span> <span class="o">=</span> <span class="nb">radix</span> <span class="o">/</span> <span class="n">fp2</span>
<a name="ln-1721"></a>        <span class="n">t5</span> <span class="o">=</span> <span class="n">fp1</span> <span class="o">+</span> <span class="n">half</span>
<a name="ln-1722"></a>        <span class="n">b9</span> <span class="o">=</span> <span class="p">((</span><span class="nb">radix</span> <span class="o">-</span> <span class="n">fp1</span><span class="p">)</span> <span class="o">-</span> <span class="n">ulppls</span><span class="p">)</span> <span class="o">+</span> <span class="n">fp1</span>
<a name="ln-1723"></a><span class="c">!</span>
<a name="ln-1724"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2250</span><span class="p">)</span>
<a name="ln-1725"></a><span class="mi">2250</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Checking for rounding in multiply, divide and add/subtract:&#39;</span><span class="p">)</span>
<a name="ln-1726"></a><span class="c">!2260    continue</span>
<a name="ln-1727"></a>        <span class="n">r1</span> <span class="o">=</span> <span class="n">minus1</span>
<a name="ln-1728"></a>        <span class="n">r2</span> <span class="o">=</span> <span class="n">minus1</span>
<a name="ln-1729"></a>        <span class="n">r3</span> <span class="o">=</span> <span class="n">minus1</span>
<a name="ln-1730"></a><span class="c">!               IS  RADIX  A POWER OF  2  OR  10 ?</span>
<a name="ln-1731"></a><span class="c">!2270    continue</span>
<a name="ln-1732"></a>        <span class="n">a1</span> <span class="o">=</span> <span class="n">fp2</span>
<a name="ln-1733"></a><span class="mi">2280</span>    <span class="k">continue</span>
<a name="ln-1734"></a><span class="k">        </span><span class="n">a</span> <span class="o">=</span> <span class="nb">radix</span>
<a name="ln-1735"></a><span class="mi">2290</span>    <span class="k">continue</span>
<a name="ln-1736"></a><span class="k">        </span><span class="n">x</span> <span class="o">=</span> <span class="n">a</span>
<a name="ln-1737"></a>        <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">a1</span>
<a name="ln-1738"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">aint</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">a</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2290</span>
<a name="ln-1739"></a><span class="c">!2300    continue</span>
<a name="ln-1740"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp1</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2340</span>
<a name="ln-1741"></a><span class="c">!               RADIX  IS A POWER OF  A1; IF RADIX=1 THEN  A1=2.</span>
<a name="ln-1742"></a><span class="c">!2310    continue</span>
<a name="ln-1743"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">a1</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp3</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2330</span>
<a name="ln-1744"></a><span class="c">!2320    continue</span>
<a name="ln-1745"></a>        <span class="n">a1</span> <span class="o">=</span> <span class="n">fp9</span> <span class="o">+</span> <span class="n">fp1</span>
<a name="ln-1746"></a>        <span class="k">goto </span><span class="mi">2280</span>
<a name="ln-1747"></a><span class="c">!               IS  RADIX  A POWER OF  10 ?</span>
<a name="ln-1748"></a><span class="mi">2330</span>    <span class="n">a1</span> <span class="o">=</span> <span class="nb">radix</span>
<a name="ln-1749"></a><span class="c">!               UNLESS  B  IS A POWER OF  A1  AND  A1 = 2 OR 10.</span>
<a name="ln-1750"></a><span class="mi">2340</span>    <span class="k">continue</span>
<a name="ln-1751"></a><span class="k">        </span><span class="n">a</span><span class="o">=</span><span class="n">fp1</span><span class="o">/</span><span class="n">a1</span>
<a name="ln-1752"></a>        <span class="n">x</span><span class="o">=</span><span class="n">a1</span>
<a name="ln-1753"></a>        <span class="n">y</span><span class="o">=</span><span class="n">a</span>
<a name="ln-1754"></a><span class="mi">2350</span>    <span class="k">continue</span>
<a name="ln-1755"></a><span class="k">        </span><span class="n">z</span><span class="o">=</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="n">half</span>
<a name="ln-1756"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">half</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2370</span>
<a name="ln-1757"></a><span class="c">!2360    continue</span>
<a name="ln-1758"></a>        <span class="n">fails</span><span class="o">=</span><span class="n">fails</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1759"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2361</span><span class="p">)</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span>
<a name="ln-1760"></a><span class="mi">2361</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE:  1/&#39;</span><span class="p">,</span><span class="n">e13</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39; = &#39;</span><span class="p">,</span><span class="n">e13</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;, and  &#39;</span><span class="p">,</span><span class="n">e13</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;*(1/&#39;</span><span class="p">,</span><span class="n">e13</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;) differs from  1.&#39;</span><span class="p">)</span>
<a name="ln-1761"></a><span class="mi">2370</span>    <span class="k">continue</span>
<a name="ln-1762"></a><span class="k">        if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="nb">radix</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2390</span>
<a name="ln-1763"></a><span class="c">!2380    continue</span>
<a name="ln-1764"></a>        <span class="n">x</span> <span class="o">=</span> <span class="nb">radix</span>
<a name="ln-1765"></a><span class="nb">        </span><span class="n">y</span> <span class="o">=</span> <span class="n">fp1</span> <span class="o">/</span> <span class="n">x</span>
<a name="ln-1766"></a>        <span class="k">goto </span><span class="mi">2350</span>
<a name="ln-1767"></a><span class="mi">2390</span>    <span class="k">continue</span>
<a name="ln-1768"></a><span class="k">        </span><span class="n">y2</span><span class="o">=</span><span class="n">fp1</span><span class="o">+</span><span class="n">ulppls</span>
<a name="ln-1769"></a>        <span class="n">y1</span><span class="o">=</span><span class="n">fp1</span><span class="o">-</span><span class="n">ulppls</span>
<a name="ln-1770"></a>        <span class="n">x</span><span class="o">=</span><span class="n">t5</span><span class="o">-</span><span class="n">ulppls</span>
<a name="ln-1771"></a>        <span class="n">y</span><span class="o">=</span><span class="n">t5</span><span class="o">+</span><span class="n">ulppls</span>
<a name="ln-1772"></a>        <span class="n">z</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">ulppls</span><span class="p">)</span><span class="o">*</span><span class="n">y2</span>
<a name="ln-1773"></a>        <span class="n">t</span><span class="o">=</span><span class="n">y</span><span class="o">*</span><span class="n">y1</span>
<a name="ln-1774"></a>        <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="o">-</span><span class="n">x</span>
<a name="ln-1775"></a>        <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="o">-</span><span class="n">x</span>
<a name="ln-1776"></a>        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">*</span><span class="n">y2</span>
<a name="ln-1777"></a>        <span class="n">y</span><span class="o">=</span><span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="n">ulppls</span><span class="p">)</span><span class="o">*</span><span class="n">y1</span>
<a name="ln-1778"></a>        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">-</span><span class="n">t5</span>
<a name="ln-1779"></a>        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">-</span><span class="n">t5</span>
<a name="ln-1780"></a>        <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="p">(</span> <span class="n">x</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">y</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">z</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">t</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">))</span> <span class="k">goto </span><span class="mi">2460</span>
<a name="ln-1781"></a><span class="c">!2400    continue</span>
<a name="ln-1782"></a>        <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">t5</span><span class="o">+</span><span class="n">ulppls</span><span class="p">)</span><span class="o">*</span><span class="n">y2</span>
<a name="ln-1783"></a>        <span class="n">y</span><span class="o">=</span><span class="n">t5</span><span class="o">-</span><span class="n">ulppls</span><span class="o">-</span><span class="n">ulppls</span>
<a name="ln-1784"></a>        <span class="n">z</span><span class="o">=</span><span class="n">t5</span><span class="o">+</span><span class="n">ulppls</span><span class="o">+</span><span class="n">ulppls</span>
<a name="ln-1785"></a>        <span class="n">t</span><span class="o">=</span><span class="p">(</span><span class="n">t5</span><span class="o">-</span><span class="n">ulppls</span><span class="p">)</span><span class="o">*</span><span class="n">y1</span>
<a name="ln-1786"></a>        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">-</span><span class="p">(</span><span class="n">z</span><span class="o">+</span><span class="n">ulppls</span><span class="p">)</span>
<a name="ln-1787"></a>        <span class="n">sticky</span> <span class="o">=</span> <span class="n">y</span> <span class="o">*</span> <span class="n">y1</span>
<a name="ln-1788"></a>        <span class="n">s1</span> <span class="o">=</span> <span class="n">z</span> <span class="o">*</span> <span class="n">y2</span>
<a name="ln-1789"></a>        <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">-</span> <span class="n">y</span>
<a name="ln-1790"></a>        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">ulppls</span><span class="o">-</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">sticky</span>
<a name="ln-1791"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">s1</span> <span class="o">-</span> <span class="p">(</span><span class="n">z</span><span class="o">+</span><span class="n">ulppls</span><span class="o">+</span><span class="n">ulppls</span><span class="p">)</span>
<a name="ln-1792"></a>        <span class="n">sticky</span> <span class="o">=</span> <span class="p">(</span><span class="n">y2</span><span class="o">+</span><span class="n">ulppls</span><span class="p">)</span> <span class="o">*</span> <span class="n">y1</span>
<a name="ln-1793"></a>        <span class="n">y1</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">*</span> <span class="n">y1</span>
<a name="ln-1794"></a>        <span class="n">sticky</span> <span class="o">=</span> <span class="n">sticky</span> <span class="o">-</span> <span class="n">y2</span>
<a name="ln-1795"></a>        <span class="n">y1</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">half</span>
<a name="ln-1796"></a><span class="c">!2410    continue</span>
<a name="ln-1797"></a>        <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">y</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">z</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">t</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">sticky</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">y1</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">half</span><span class="p">)</span> <span class="n">r1</span> <span class="o">=</span> <span class="n">fp1</span>
<a name="ln-1798"></a><span class="c">!2420    continue</span>
<a name="ln-1799"></a>        <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">ulppls</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">y</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">z</span><span class="o">+</span><span class="n">ulppls</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">t</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">sticky</span><span class="o">+</span><span class="n">ulppls</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">y1</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">half</span><span class="p">)</span><span class="n">r1</span><span class="o">=</span><span class="n">fp0</span>
<a name="ln-1800"></a><span class="c">!2430    continue</span>
<a name="ln-1801"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">r1</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2431</span><span class="p">)</span>
<a name="ln-1802"></a><span class="mi">2431</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Multiplication appears to be chopped.&#39;</span><span class="p">)</span>
<a name="ln-1803"></a><span class="c">!2440    continue</span>
<a name="ln-1804"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">r1</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp1</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2441</span><span class="p">)</span>
<a name="ln-1805"></a><span class="mi">2441</span>    <span class="k">format</span> <span class="p">(</span><span class="s1">&#39; Multiplication appears to be correctly rounded.&#39;</span><span class="p">)</span>
<a name="ln-1806"></a><span class="c">!2450    continue</span>
<a name="ln-1807"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">r1</span><span class="o">-</span><span class="n">mulgrd</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp1</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2451</span><span class="p">)</span>
<a name="ln-1808"></a><span class="mi">2451</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE: multiplication test is inconsistent; PLEASE NOTIFY KARPINSKI !&#39;</span><span class="p">)</span>
<a name="ln-1809"></a><span class="mi">2460</span>    <span class="k">continue</span>
<a name="ln-1810"></a><span class="k">        if</span> <span class="p">(</span><span class="n">r1</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">minus1</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2461</span><span class="p">)</span>
<a name="ln-1811"></a><span class="mi">2461</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Multiplication is neither chopped nor correctly rounded.&#39;</span><span class="p">)</span>
<a name="ln-1812"></a><span class="c">!2470    continue</span>
<a name="ln-1813"></a>        <span class="n">miles</span><span class="o">=</span><span class="mi">45</span>
<a name="ln-1814"></a><span class="c">!       ================================================================</span>
<a name="ln-1815"></a><span class="c">!2480    continue</span>
<a name="ln-1816"></a>        <span class="n">y2</span><span class="o">=</span><span class="n">fp1</span><span class="o">+</span><span class="n">ulppls</span>
<a name="ln-1817"></a>        <span class="n">y1</span><span class="o">=</span><span class="n">fp1</span><span class="o">-</span><span class="n">ulppls</span>
<a name="ln-1818"></a>        <span class="n">z</span><span class="o">=</span><span class="n">t5</span><span class="o">+</span><span class="n">ulppls</span><span class="o">+</span><span class="n">ulppls</span>
<a name="ln-1819"></a>        <span class="n">x</span><span class="o">=</span><span class="n">z</span><span class="o">/</span><span class="n">y2</span>
<a name="ln-1820"></a>        <span class="n">t</span><span class="o">=</span><span class="n">t5</span><span class="o">-</span><span class="n">ulppls</span><span class="o">-</span><span class="n">ulppls</span>
<a name="ln-1821"></a>        <span class="n">y</span><span class="o">=</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">ulppls</span><span class="p">)</span><span class="o">/</span><span class="n">y1</span>
<a name="ln-1822"></a>        <span class="n">z</span><span class="o">=</span><span class="p">(</span><span class="n">z</span><span class="o">+</span><span class="n">ulppls</span><span class="p">)</span><span class="o">/</span><span class="n">y2</span>
<a name="ln-1823"></a>        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">-</span><span class="n">t5</span>
<a name="ln-1824"></a>        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">-</span><span class="n">t</span>
<a name="ln-1825"></a>        <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="o">/</span><span class="n">y1</span>
<a name="ln-1826"></a>        <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="o">-</span><span class="p">(</span><span class="n">t5</span><span class="o">+</span><span class="n">ulppls</span><span class="p">)</span>
<a name="ln-1827"></a>        <span class="n">t</span><span class="o">=</span><span class="p">(</span><span class="n">ulppls</span><span class="o">-</span><span class="n">t5</span><span class="p">)</span><span class="o">+</span><span class="n">t</span>
<a name="ln-1828"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">x</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">y</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">z</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">t</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span><span class="k">goto </span><span class="mi">2540</span>
<a name="ln-1829"></a><span class="c">!2490    continue</span>
<a name="ln-1830"></a>        <span class="n">x</span><span class="o">=</span><span class="n">t5</span><span class="o">/</span><span class="n">y2</span>
<a name="ln-1831"></a>        <span class="n">y</span><span class="o">=</span><span class="n">t5</span><span class="o">-</span><span class="n">ulppls</span>
<a name="ln-1832"></a>        <span class="n">z</span><span class="o">=</span><span class="n">t5</span><span class="o">+</span><span class="n">ulppls</span>
<a name="ln-1833"></a>        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">-</span><span class="n">y</span>
<a name="ln-1834"></a>        <span class="n">t</span><span class="o">=</span><span class="n">t5</span><span class="o">/</span><span class="n">y1</span>
<a name="ln-1835"></a>        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">/</span><span class="n">y1</span>
<a name="ln-1836"></a>        <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="o">-</span><span class="p">(</span><span class="n">z</span><span class="o">+</span><span class="n">ulppls</span><span class="p">)</span>
<a name="ln-1837"></a>        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">-</span><span class="n">z</span>
<a name="ln-1838"></a>        <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="o">/</span><span class="n">y2</span>
<a name="ln-1839"></a>        <span class="n">y1</span><span class="o">=</span><span class="p">(</span><span class="n">y2</span><span class="o">+</span><span class="n">ulppls</span><span class="p">)</span><span class="o">/</span><span class="n">y2</span>
<a name="ln-1840"></a>        <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="o">-</span><span class="n">t5</span>
<a name="ln-1841"></a>        <span class="n">y2</span><span class="o">=</span><span class="n">y1</span><span class="o">-</span><span class="n">y2</span>
<a name="ln-1842"></a>        <span class="n">y1</span><span class="o">=</span><span class="p">(</span><span class="n">onemin</span><span class="o">-</span><span class="n">ulpmin</span><span class="p">)</span><span class="o">/</span><span class="n">onemin</span>
<a name="ln-1843"></a>        <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">y</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">z</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">t</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">y2</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">y1</span><span class="o">-</span><span class="n">half</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">onemin</span><span class="o">-</span><span class="n">half</span><span class="p">)</span> <span class="n">r2</span><span class="o">=</span><span class="n">fp1</span>
<a name="ln-1844"></a><span class="c">!2500    continue</span>
<a name="ln-1845"></a>        <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">y</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">z</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">t</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">y2</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">y1</span><span class="o">-</span><span class="n">half</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">onemin</span><span class="o">-</span><span class="n">half</span><span class="p">)</span> <span class="n">r2</span><span class="o">=</span><span class="n">fp0</span>
<a name="ln-1846"></a><span class="c">!2510    continue</span>
<a name="ln-1847"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">r2</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2511</span><span class="p">)</span>
<a name="ln-1848"></a><span class="mi">2511</span>    <span class="k">format</span> <span class="p">(</span><span class="s1">&#39; Division appears to be chopped.&#39;</span><span class="p">)</span>
<a name="ln-1849"></a><span class="c">!2520    continue</span>
<a name="ln-1850"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">r2</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp1</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2521</span><span class="p">)</span>
<a name="ln-1851"></a><span class="mi">2521</span>    <span class="k">format</span> <span class="p">(</span><span class="s1">&#39; Division appears to be correctly rounded.&#39;</span><span class="p">)</span>
<a name="ln-1852"></a><span class="c">!2530    continue</span>
<a name="ln-1853"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">r2</span><span class="o">-</span><span class="n">divgrd</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp1</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2531</span><span class="p">)</span>
<a name="ln-1854"></a><span class="mi">2531</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE:  division test is inconsistent; PLEASE NOTIFY KARPINSKI !&#39;</span><span class="p">)</span>
<a name="ln-1855"></a><span class="mi">2540</span>    <span class="k">continue</span>
<a name="ln-1856"></a><span class="k">        if</span> <span class="p">(</span><span class="n">r2</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">minus1</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2541</span><span class="p">)</span>
<a name="ln-1857"></a><span class="mi">2541</span>    <span class="k">format</span> <span class="p">(</span><span class="s1">&#39; Division is neither chopped nor correctly rounded.&#39;</span><span class="p">)</span>
<a name="ln-1858"></a><span class="c">!</span>
<a name="ln-1859"></a><span class="c">!       ================================================================</span>
<a name="ln-1860"></a><span class="c">!</span>
<a name="ln-1861"></a><span class="c">!2550    continue</span>
<a name="ln-1862"></a>        <span class="n">b1</span> <span class="o">=</span> <span class="n">fp1</span> <span class="o">/</span> <span class="nb">radix</span>
<a name="ln-1863"></a><span class="nb">        </span><span class="k">if</span> <span class="p">(</span><span class="n">b1</span> <span class="o">*</span> <span class="nb">radix</span> <span class="o">-</span> <span class="n">half</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">half</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2580</span>
<a name="ln-1864"></a><span class="c">!2560    continue</span>
<a name="ln-1865"></a>        <span class="n">fails</span><span class="o">=</span><span class="n">fails</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1866"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2570</span><span class="p">)</span>
<a name="ln-1867"></a><span class="mi">2570</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE:  radix * (1 / radix)  differs from  1.&#39;</span><span class="p">)</span>
<a name="ln-1868"></a><span class="mi">2580</span>    <span class="k">continue</span>
<a name="ln-1869"></a><span class="k">        </span><span class="n">miles</span><span class="o">=</span><span class="mi">50</span>
<a name="ln-1870"></a><span class="c">!</span>
<a name="ln-1871"></a><span class="c">!       ================================================================</span>
<a name="ln-1872"></a><span class="c">!</span>
<a name="ln-1873"></a><span class="c">!2590    continue</span>
<a name="ln-1874"></a>        <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">onemin</span> <span class="o">+</span> <span class="n">ulpmin</span><span class="p">)</span> <span class="o">-</span> <span class="n">half</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">half</span>         <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="p">(</span><span class="n">b9</span> <span class="o">+</span> <span class="n">ulppls</span><span class="p">)</span> <span class="o">-</span> <span class="n">fp1</span>  <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="nb">radix</span> <span class="o">-</span> <span class="n">fp1</span> <span class="p">)</span> <span class="k">goto </span><span class="mi">2610</span>
<a name="ln-1875"></a><span class="c">!2600    continue</span>
<a name="ln-1876"></a>        <span class="n">fails</span><span class="o">=</span><span class="n">fails</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1877"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2601</span><span class="p">)</span>
<a name="ln-1878"></a><span class="mi">2601</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE: incomplete carry-propagation in addition.&#39;</span><span class="p">)</span>
<a name="ln-1879"></a><span class="mi">2610</span>    <span class="k">continue</span>
<a name="ln-1880"></a><span class="k">        </span><span class="n">x</span> <span class="o">=</span> <span class="n">fp1</span> <span class="o">-</span> <span class="n">ulpmin</span> <span class="o">*</span> <span class="n">ulpmin</span>
<a name="ln-1881"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">fp1</span> <span class="o">+</span> <span class="n">ulppls</span> <span class="o">*</span> <span class="p">(</span><span class="n">fp1</span> <span class="o">-</span> <span class="n">ulppls</span><span class="p">)</span>
<a name="ln-1882"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">onemin</span> <span class="o">-</span> <span class="n">half</span>
<a name="ln-1883"></a>        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">half</span><span class="p">)</span> <span class="o">-</span> <span class="n">z</span>
<a name="ln-1884"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">fp1</span>
<a name="ln-1885"></a><span class="c">!2620    continue</span>
<a name="ln-1886"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">y</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2640</span>
<a name="ln-1887"></a><span class="c">!2630    continue</span>
<a name="ln-1888"></a>        <span class="n">r3</span> <span class="o">=</span> <span class="n">fp0</span>
<a name="ln-1889"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2631</span><span class="p">)</span>
<a name="ln-1890"></a><span class="mi">2631</span>    <span class="k">format</span> <span class="p">(</span><span class="s1">&#39; Add/subtract appears to be chopped.&#39;</span><span class="p">)</span>
<a name="ln-1891"></a><span class="mi">2640</span>    <span class="k">continue</span>
<a name="ln-1892"></a><span class="k">        if</span> <span class="p">(</span><span class="n">subgrd</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2710</span>
<a name="ln-1893"></a><span class="c">!2650    continue</span>
<a name="ln-1894"></a>        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">half</span> <span class="o">+</span> <span class="n">ulppls</span><span class="p">)</span> <span class="o">*</span> <span class="n">ulppls</span>
<a name="ln-1895"></a>        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">half</span> <span class="o">-</span> <span class="n">ulppls</span><span class="p">)</span> <span class="o">*</span> <span class="n">ulppls</span>
<a name="ln-1896"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">fp1</span> <span class="o">+</span> <span class="n">x</span>
<a name="ln-1897"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">fp1</span> <span class="o">+</span> <span class="n">y</span>
<a name="ln-1898"></a>        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">fp1</span> <span class="o">+</span> <span class="n">ulppls</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span>
<a name="ln-1899"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">fp1</span> <span class="o">-</span> <span class="n">y</span>
<a name="ln-1900"></a><span class="c">!2660    continue</span>
<a name="ln-1901"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">y</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2710</span>
<a name="ln-1902"></a><span class="c">!2670    continue</span>
<a name="ln-1903"></a>        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">half</span> <span class="o">+</span> <span class="n">ulppls</span><span class="p">)</span> <span class="o">*</span> <span class="n">ulpmin</span>
<a name="ln-1904"></a>        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">half</span> <span class="o">-</span> <span class="n">ulppls</span><span class="p">)</span> <span class="o">*</span> <span class="n">ulpmin</span>
<a name="ln-1905"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">fp1</span> <span class="o">-</span> <span class="n">x</span>
<a name="ln-1906"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">fp1</span> <span class="o">-</span> <span class="n">y</span>
<a name="ln-1907"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">onemin</span> <span class="o">-</span> <span class="n">x</span>
<a name="ln-1908"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">fp1</span> <span class="o">-</span> <span class="n">y</span>
<a name="ln-1909"></a><span class="c">!2680    continue</span>
<a name="ln-1910"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">y</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2710</span>
<a name="ln-1911"></a><span class="c">!2690    continue</span>
<a name="ln-1912"></a>        <span class="n">r3</span> <span class="o">=</span> <span class="n">minus1</span> <span class="o">-</span> <span class="n">fp2</span> <span class="o">*</span> <span class="n">r3</span>
<a name="ln-1913"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2691</span><span class="p">)</span>
<a name="ln-1914"></a><span class="mi">2691</span>    <span class="k">format</span> <span class="p">(</span><span class="s1">&#39; Add/subtract appears to be correctly rounded.&#39;</span><span class="p">)</span>
<a name="ln-1915"></a><span class="c">!2700    continue</span>
<a name="ln-1916"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">r3</span> <span class="o">-</span> <span class="n">subgrd</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp1</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2701</span><span class="p">)</span>
<a name="ln-1917"></a><span class="mi">2701</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE:  add/subtract test is inconsistent; PLEASE NOTIFY KARPINSKI !&#39;</span><span class="p">)</span>
<a name="ln-1918"></a><span class="mi">2710</span>    <span class="k">continue</span>
<a name="ln-1919"></a><span class="k">        if</span> <span class="p">(</span><span class="n">r3</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">minus1</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2711</span><span class="p">)</span>
<a name="ln-1920"></a><span class="mi">2711</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Add/subtract neither chopped nor correctly rounded.&#39;</span><span class="p">)</span>
<a name="ln-1921"></a><span class="c">!2720    continue</span>
<a name="ln-1922"></a>        <span class="n">s1</span> <span class="o">=</span> <span class="n">fp1</span>
<a name="ln-1923"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">fp1</span><span class="o">+</span><span class="n">half</span><span class="o">*</span><span class="p">(</span><span class="n">fp1</span><span class="o">+</span><span class="n">half</span><span class="p">)</span>
<a name="ln-1924"></a>        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">fp1</span><span class="o">+</span><span class="n">ulppls</span><span class="p">)</span><span class="o">*</span><span class="n">half</span>
<a name="ln-1925"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">y</span>
<a name="ln-1926"></a>        <span class="n">t</span> <span class="o">=</span> <span class="n">y</span><span class="o">-</span><span class="n">x</span>
<a name="ln-1927"></a>        <span class="n">sticky</span> <span class="o">=</span> <span class="n">z</span><span class="o">+</span><span class="n">t</span>
<a name="ln-1928"></a><span class="c">!2730    continue</span>
<a name="ln-1929"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">sticky</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2770</span>
<a name="ln-1930"></a><span class="c">!2740    continue</span>
<a name="ln-1931"></a>        <span class="n">s1</span><span class="o">=</span><span class="n">fp0</span>
<a name="ln-1932"></a>        <span class="n">flaws</span><span class="o">=</span><span class="n">flaws</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1933"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2750</span><span class="p">)</span> <span class="n">sticky</span>
<a name="ln-1934"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2760</span><span class="p">)</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<a name="ln-1935"></a><span class="mi">2750</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FLAW: nonzero  (x-y)+(y-x) = &#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39; when&#39;</span><span class="p">)</span>
<a name="ln-1936"></a><span class="mi">2760</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;      x = &#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;  and  y = &#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1937"></a><span class="c">!</span>
<a name="ln-1938"></a><span class="c">!       ================================================================</span>
<a name="ln-1939"></a><span class="c">!</span>
<a name="ln-1940"></a><span class="mi">2770</span>    <span class="k">continue</span>
<a name="ln-1941"></a><span class="k">        </span><span class="n">sticky</span> <span class="o">=</span> <span class="n">fp0</span>
<a name="ln-1942"></a>        <span class="k">if</span><span class="p">(</span><span class="n">mulgrd</span><span class="o">*</span><span class="n">divgrd</span><span class="o">*</span><span class="n">subgrd</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">fp1</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="n">r1</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">fp1</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="n">r2</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">fp1</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="n">r3</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">fp1</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="nb">aint</span><span class="p">(</span><span class="n">b2</span><span class="p">).</span><span class="n">ne</span><span class="p">.</span><span class="n">b2</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2890</span>
<a name="ln-1943"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2780</span><span class="p">)</span>
<a name="ln-1944"></a><span class="mi">2780</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; checking for sticky bit:&#39;</span><span class="p">)</span>
<a name="ln-1945"></a><span class="c">!2790    continue</span>
<a name="ln-1946"></a>        <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">half</span><span class="o">+</span><span class="n">ulpmin</span><span class="p">)</span><span class="o">*</span><span class="n">ulppls</span>
<a name="ln-1947"></a>        <span class="n">y</span><span class="o">=</span><span class="n">half</span><span class="o">*</span><span class="n">ulppls</span>
<a name="ln-1948"></a>        <span class="n">z</span><span class="o">=</span><span class="n">fp1</span><span class="o">+</span><span class="n">y</span>
<a name="ln-1949"></a>        <span class="n">t</span><span class="o">=</span><span class="n">fp1</span><span class="o">+</span><span class="n">x</span>
<a name="ln-1950"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">fp1</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">t</span><span class="o">-</span><span class="n">fp1</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">ulppls</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2890</span>
<a name="ln-1951"></a><span class="c">!2800    continue</span>
<a name="ln-1952"></a>        <span class="n">z</span><span class="o">=</span><span class="n">t</span><span class="o">+</span><span class="n">y</span>
<a name="ln-1953"></a>        <span class="n">y</span><span class="o">=</span><span class="n">z</span><span class="o">-</span><span class="n">x</span>
<a name="ln-1954"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">t</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">ulppls</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">y</span><span class="o">-</span><span class="n">t</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2890</span>
<a name="ln-1955"></a><span class="c">!2810    continue</span>
<a name="ln-1956"></a>        <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">half</span><span class="o">+</span><span class="n">ulpmin</span><span class="p">)</span><span class="o">*</span><span class="n">ulpmin</span>
<a name="ln-1957"></a>        <span class="n">y</span><span class="o">=</span><span class="n">half</span><span class="o">*</span><span class="n">ulpmin</span>
<a name="ln-1958"></a>        <span class="n">z</span><span class="o">=</span><span class="n">fp1</span><span class="o">-</span><span class="n">y</span>
<a name="ln-1959"></a>        <span class="n">t</span><span class="o">=</span><span class="n">fp1</span><span class="o">-</span><span class="n">x</span>
<a name="ln-1960"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">fp1</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">t</span><span class="o">-</span><span class="n">onemin</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2890</span>
<a name="ln-1961"></a><span class="c">!2820    continue</span>
<a name="ln-1962"></a>        <span class="n">z</span><span class="o">=</span><span class="p">(</span><span class="n">half</span><span class="o">-</span><span class="n">ulpmin</span><span class="p">)</span><span class="o">*</span><span class="n">ulpmin</span>
<a name="ln-1963"></a>        <span class="n">t</span><span class="o">=</span><span class="n">onemin</span><span class="o">-</span><span class="n">z</span>
<a name="ln-1964"></a>        <span class="n">q</span><span class="o">=</span><span class="n">onemin</span><span class="o">-</span><span class="n">y</span>
<a name="ln-1965"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">onemin</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">onemin</span><span class="o">-</span><span class="n">ulpmin</span><span class="p">)</span><span class="o">-</span><span class="n">q</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2890</span>
<a name="ln-1966"></a><span class="c">!2830    continue</span>
<a name="ln-1967"></a>        <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">fp1</span> <span class="o">+</span> <span class="n">ulppls</span><span class="p">)</span> <span class="o">*</span> <span class="n">t5</span>
<a name="ln-1968"></a>        <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">t5</span> <span class="o">+</span> <span class="n">ulppls</span><span class="p">)</span> <span class="o">-</span> <span class="n">z</span> <span class="o">+</span> <span class="n">ulppls</span>
<a name="ln-1969"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">fp1</span> <span class="o">+</span> <span class="n">half</span> <span class="o">/</span> <span class="nb">radix</span>
<a name="ln-1970"></a><span class="nb">        </span><span class="n">y</span> <span class="o">=</span> <span class="n">fp1</span> <span class="o">+</span> <span class="nb">radix</span> <span class="o">*</span> <span class="n">ulppls</span>
<a name="ln-1971"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
<a name="ln-1972"></a><span class="c">!2840    continue</span>
<a name="ln-1973"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="nb">radix</span> <span class="o">*</span> <span class="n">ulppls</span><span class="p">)</span> <span class="o">-</span> <span class="n">z</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2890</span>
<a name="ln-1974"></a><span class="c">!2850    continue</span>
<a name="ln-1975"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">radix</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp2</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2870</span>
<a name="ln-1976"></a><span class="c">!2860    continue</span>
<a name="ln-1977"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">fp2</span> <span class="o">+</span> <span class="n">ulppls</span>
<a name="ln-1978"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">fp2</span>
<a name="ln-1979"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">fp1</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">2890</span>
<a name="ln-1980"></a><span class="mi">2870</span>    <span class="k">continue</span>
<a name="ln-1981"></a><span class="k">        </span><span class="n">sticky</span> <span class="o">=</span> <span class="n">s1</span>
<a name="ln-1982"></a><span class="c">!2880    continue</span>
<a name="ln-1983"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">sticky</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp1</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2881</span><span class="p">)</span>
<a name="ln-1984"></a><span class="mi">2881</span>    <span class="k">format</span> <span class="p">(</span><span class="s1">&#39; Sticky bit appears to be used correctly.&#39;</span><span class="p">)</span>
<a name="ln-1985"></a><span class="mi">2890</span>    <span class="k">continue</span>
<a name="ln-1986"></a><span class="k">        if</span> <span class="p">(</span><span class="n">sticky</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span>  <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">2891</span><span class="p">)</span>
<a name="ln-1987"></a><span class="mi">2891</span>    <span class="k">format</span> <span class="p">(</span><span class="s1">&#39; Sticky bit used incorrectly or not at all.&#39;</span><span class="p">)</span>
<a name="ln-1988"></a><span class="c">!2900    continue</span>
<a name="ln-1989"></a>        <span class="k">if</span><span class="p">(</span><span class="n">mulgrd</span><span class="o">*</span><span class="n">divgrd</span><span class="o">*</span><span class="n">subgrd</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="n">r1</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="n">r2</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">fp0</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="n">r3</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">fp0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1990"></a><span class="k">           </span><span class="n">flaws</span><span class="o">=</span><span class="n">flaws</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1991"></a>           <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">29001</span><span class="p">)</span>
<a name="ln-1992"></a><span class="mi">29001</span>      <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FLAW: lack(s) of guard digits or failure(s) to correctly round or chop&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1993"></a>           <span class="p">&amp;</span> <span class="s1">&#39; (noted above) count as one flaw in the final tally below.&#39;</span><span class="p">)</span>
<a name="ln-1994"></a>           <span class="k">end if</span>
<a name="ln-1995"></a><span class="k">        return</span>
<a name="ln-1996"></a><span class="k">        end subroutine </span><span class="n">round</span>
<a name="ln-1997"></a><span class="c">!#######################################################################</span>
<a name="ln-1998"></a><span class="c">!---</span>
<a name="ln-1999"></a>        <span class="k">subroutine </span><span class="n">smlint</span><span class="p">(</span><span class="n">miles</span><span class="p">,</span><span class="n">from</span><span class="p">)</span>
<a name="ln-2000"></a><span class="c">!CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC</span>
<a name="ln-2001"></a><span class="c">!</span>
<a name="ln-2002"></a><span class="c">!</span>
<a name="ln-2003"></a><span class="c">!       TESTS ON SMALL INTEGERS</span>
<a name="ln-2004"></a><span class="c">!</span>
<a name="ln-2005"></a><span class="c">!</span>
<a name="ln-2006"></a><span class="c">!</span>
<a name="ln-2007"></a><span class="c">!</span>
<a name="ln-2008"></a><span class="c">!CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC</span>
<a name="ln-2009"></a>      <span class="k">implicit none</span>
<a name="ln-2010"></a><span class="c">!</span>
<a name="ln-2011"></a><span class="c">!</span>
<a name="ln-2012"></a>        <span class="kt">integer </span><span class="n">ipartu</span>
<a name="ln-2013"></a>        <span class="kt">integer </span><span class="n">miles</span>
<a name="ln-2014"></a>        <span class="kt">integer </span><span class="n">from</span>
<a name="ln-2015"></a><span class="c">!        ... INTEGER NUMBER IF MILESTONES REACHED</span>
<a name="ln-2016"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">charz</span>
<a name="ln-2017"></a><span class="c">!        ... CHARACTER CONSTANT &#39;Z&#39;</span>
<a name="ln-2018"></a>        <span class="kt">real </span><span class="n">minone</span>
<a name="ln-2019"></a><span class="c">!        ... TEMPORARY TO HOLD MINUS ONE</span>
<a name="ln-2020"></a>        <span class="kt">real </span><span class="n">half</span>
<a name="ln-2021"></a><span class="c">!        ... TEMPORARY TO HOLD ONE HALF</span>
<a name="ln-2022"></a>        <span class="kt">real </span><span class="n">five</span>
<a name="ln-2023"></a><span class="c">!        ... TEMPORARY TO HOLD FIVE</span>
<a name="ln-2024"></a>        <span class="kt">real </span><span class="n">eight</span>
<a name="ln-2025"></a><span class="c">!        ... TEMPORARY TO HOLD EIGHT</span>
<a name="ln-2026"></a>        <span class="kt">real </span><span class="n">nine</span>
<a name="ln-2027"></a><span class="c">!        ... TEMPORARY TO HOLD NINE</span>
<a name="ln-2028"></a>        <span class="kt">real </span><span class="n">temp12</span>
<a name="ln-2029"></a><span class="c">!        ... TEMPORARY TO HOLD 12</span>
<a name="ln-2030"></a>        <span class="kt">real </span><span class="n">temp20</span>
<a name="ln-2031"></a><span class="c">!        ... TEMPORARY TO HOLD 20</span>
<a name="ln-2032"></a>        <span class="kt">real </span><span class="n">temp27</span>
<a name="ln-2033"></a><span class="c">!        ... TEMPORARY TO HOLD 27</span>
<a name="ln-2034"></a>        <span class="kt">real </span><span class="n">temp32</span>
<a name="ln-2035"></a><span class="c">!        ... TEMPORARY TO HOLD 32</span>
<a name="ln-2036"></a>        <span class="kt">real </span><span class="n">temp48</span>
<a name="ln-2037"></a><span class="c">!        ... TEMPORARY TO HOLD 48</span>
<a name="ln-2038"></a>        <span class="kt">real </span><span class="n">temp60</span>
<a name="ln-2039"></a><span class="c">!        ... TEMPORARY TO HOLD 60</span>
<a name="ln-2040"></a>        <span class="kt">real </span><span class="n">temp80</span>
<a name="ln-2041"></a><span class="c">!        ... TEMPORARY TO HOLD 80</span>
<a name="ln-2042"></a>        <span class="kt">real </span><span class="n">tmp240</span>
<a name="ln-2043"></a><span class="c">!        ... TEMPORARY TO HOLD 240</span>
<a name="ln-2044"></a>        <span class="kt">real </span><span class="n">temp</span>
<a name="ln-2045"></a><span class="c">!        ... TEMPORARY VARIABLE TO HOLD VARIOUS VERY SHORT TERM VALUES</span>
<a name="ln-2046"></a>        <span class="kt">real </span><span class="n">tempz</span>
<a name="ln-2047"></a><span class="c">!        ... TEMPORARY VARIABLE TO HOLD A TEMP. PREVIOUSLY KNOWN AS Z</span>
<a name="ln-2048"></a><span class="c">!        ... INITIALIZE SOME CONSTANTS</span>
<a name="ln-2049"></a>        <span class="k">data </span><span class="n">charz</span><span class="o">/</span><span class="s1">&#39;Z&#39;</span><span class="o">/</span>
<a name="ln-2050"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">7</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">951</span>
<a name="ln-2051"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">badmil</span>
<a name="ln-2052"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">891</span><span class="p">)</span>
<a name="ln-2053"></a><span class="mi">891</span>     <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Program is now RUNNING tests on small integers:&#39;</span><span class="p">)</span>
<a name="ln-2054"></a><span class="c">!</span>
<a name="ln-2055"></a><span class="c">!       ... LOOK FOR SOME OBVIOUS MISTAKES</span>
<a name="ln-2056"></a>        <span class="k">if</span><span class="p">(</span><span class="mf">0.0e0</span><span class="o">+</span><span class="mf">0.0e0</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.0e0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="mf">1.0e0</span><span class="o">-</span><span class="mf">1.0e0</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.0e0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="mf">1.0e0</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0e0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="mf">1.0e0</span><span class="o">+</span><span class="mf">1.0e0</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mf">2.0e0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">930</span>
<a name="ln-2057"></a>        <span class="n">fails</span><span class="o">=</span><span class="n">fails</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2058"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">920</span><span class="p">)</span>
<a name="ln-2059"></a><span class="mi">920</span>     <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE: violation of  0+0=0  or  1-1=0  or  1&gt;0  or 1+1 = 2.&#39;</span><span class="p">)</span>
<a name="ln-2060"></a><span class="mi">930</span>     <span class="k">continue</span>
<a name="ln-2061"></a><span class="k">        </span><span class="n">temp</span><span class="o">=</span><span class="mf">0.0e0</span>
<a name="ln-2062"></a>        <span class="n">tempz</span><span class="o">=-</span><span class="n">temp</span>
<a name="ln-2063"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">tempz</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">0.0e0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">960</span>
<a name="ln-2064"></a>        <span class="n">fails</span><span class="o">=</span><span class="n">fails</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2065"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">940</span><span class="p">)</span>
<a name="ln-2066"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">941</span><span class="p">)</span>
<a name="ln-2067"></a><span class="mi">940</span>     <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE: comparison alleges that minus zero, obtained by&#39;</span><span class="p">)</span>
<a name="ln-2068"></a><span class="mi">941</span>     <span class="k">format</span><span class="p">(</span><span class="s1">&#39; setting  x = 0.  and then  z = -x ,  is nonzero!&#39;</span><span class="p">)</span>
<a name="ln-2069"></a><span class="c">!        ... CALL TO ROUTINE TO CHECK FOR PARTIAL UNDERFLOW USING MINUS</span>
<a name="ln-2070"></a><span class="c">!        ... ZERO DON&#39;T REALLY HAVE INFO ON WHAT A UNIT IN THE LAST</span>
<a name="ln-2071"></a><span class="c">!        ... PLACE IS OR WHAT THE RADIX IS SINCE WE HAVEN&#39;T GOTTEN TO</span>
<a name="ln-2072"></a><span class="c">!        ... SUCH SOPHISTICATED STUFF YET, SO PICK SOME ARBITRARY VALUES</span>
<a name="ln-2073"></a><span class="c">!        ... FOR NOW TO GET US THROUGH THIS NEXT TEST.</span>
<a name="ln-2074"></a><span class="c">!950     continue</span>
<a name="ln-2075"></a>        <span class="n">ulppls</span><span class="o">=</span><span class="p">.</span><span class="mi">001</span>
<a name="ln-2076"></a>        <span class="nb">radix</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-2077"></a><span class="mi">951</span>     <span class="k">continue</span>
<a name="ln-2078"></a><span class="k">        call </span><span class="n">partuf</span><span class="p">(</span><span class="n">tempz</span><span class="p">,</span> <span class="n">charz</span><span class="p">,</span> <span class="n">miles</span><span class="p">,</span> <span class="n">ipartu</span><span class="p">,</span> <span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">7</span><span class="p">)</span>
<a name="ln-2079"></a><span class="c">!</span>
<a name="ln-2080"></a><span class="c">!</span>
<a name="ln-2081"></a><span class="mi">960</span>     <span class="k">continue</span>
<a name="ln-2082"></a><span class="k">        if</span> <span class="p">(</span><span class="mf">4.0e0</span><span class="o">+</span><span class="mf">2.0e0</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0e0</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">0.0e0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="mf">4.0e0</span><span class="o">-</span><span class="mf">3.0e0</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0e0</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">0.0e0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">980</span>
<a name="ln-2083"></a><span class="c">!970     continue</span>
<a name="ln-2084"></a>        <span class="n">fails</span><span class="o">=</span><span class="n">fails</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2085"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">971</span><span class="p">)</span>
<a name="ln-2086"></a><span class="mi">971</span>     <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE: violation of   3+1 = 2*2 .&#39;</span><span class="p">)</span>
<a name="ln-2087"></a><span class="c">!</span>
<a name="ln-2088"></a><span class="mi">980</span>     <span class="k">continue</span>
<a name="ln-2089"></a><span class="k">        </span><span class="n">minone</span><span class="o">=-</span><span class="mf">1.0e0</span>
<a name="ln-2090"></a>        <span class="k">if</span><span class="p">(</span><span class="n">minone</span><span class="o">+</span><span class="mf">1.0e0</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.0e0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="mf">1.0e0</span><span class="o">+</span><span class="n">minone</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.0e0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">minone</span><span class="o">+</span><span class="nb">abs</span><span class="p">(</span><span class="n">minone</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.0e0</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">minone</span><span class="o">+</span><span class="n">minone</span><span class="o">*</span><span class="n">minone</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.0e0</span><span class="p">)&amp;</span>
<a name="ln-2091"></a>        <span class="p">&amp;</span> <span class="k">goto </span><span class="mi">1000</span>
<a name="ln-2092"></a><span class="c">!990     continue</span>
<a name="ln-2093"></a>        <span class="n">fails</span><span class="o">=</span><span class="n">fails</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2094"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">991</span><span class="p">)</span>
<a name="ln-2095"></a><span class="mi">991</span>     <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE: violation of   -1 + 1 = 0 .&#39;</span><span class="p">)</span>
<a name="ln-2096"></a><span class="c">!</span>
<a name="ln-2097"></a><span class="mi">1000</span>    <span class="k">continue</span>
<a name="ln-2098"></a><span class="k">        </span><span class="n">half</span><span class="o">=</span><span class="mf">1.0e0</span><span class="o">/</span><span class="mf">2.0e0</span>
<a name="ln-2099"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">half</span><span class="o">+</span><span class="n">minone</span><span class="o">+</span><span class="n">half</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">0.0e0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1020</span>
<a name="ln-2100"></a><span class="c">!1010    continue</span>
<a name="ln-2101"></a>        <span class="n">fails</span><span class="o">=</span><span class="n">fails</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2102"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1011</span><span class="p">)</span>
<a name="ln-2103"></a><span class="mi">1011</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE: violation of   1/2 - 1 + 1/2 = 0 .&#39;</span><span class="p">)</span>
<a name="ln-2104"></a><span class="mi">1020</span>    <span class="k">continue</span>
<a name="ln-2105"></a><span class="k">        </span><span class="n">miles</span><span class="o">=</span><span class="mi">10</span>
<a name="ln-2106"></a><span class="c">!1100    continue</span>
<a name="ln-2107"></a>        <span class="n">nine</span><span class="o">=</span><span class="mf">3.0e0</span><span class="o">*</span><span class="mf">3.0e0</span>
<a name="ln-2108"></a>        <span class="n">temp27</span><span class="o">=</span><span class="n">nine</span><span class="o">*</span><span class="mf">3.0e0</span>
<a name="ln-2109"></a>        <span class="n">eight</span><span class="o">=</span><span class="mf">4.0e0</span><span class="o">+</span><span class="mf">4.0e0</span>
<a name="ln-2110"></a>        <span class="n">temp32</span><span class="o">=</span><span class="mf">4.0e0</span><span class="o">*</span><span class="n">eight</span>
<a name="ln-2111"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">temp32</span><span class="o">-</span><span class="n">temp27</span><span class="o">-</span><span class="mf">4.0e0</span><span class="o">-</span><span class="mf">1.0e0</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">0.0e0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1120</span>
<a name="ln-2112"></a><span class="c">!1110    continue</span>
<a name="ln-2113"></a>        <span class="n">fails</span><span class="o">=</span><span class="n">fails</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2114"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1111</span><span class="p">)</span>
<a name="ln-2115"></a><span class="mi">1111</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE: violation of   32 - 27 - 4 - 1 = 0 .&#39;</span><span class="p">)</span>
<a name="ln-2116"></a><span class="c">!</span>
<a name="ln-2117"></a><span class="mi">1120</span>    <span class="k">continue</span>
<a name="ln-2118"></a><span class="k">        </span><span class="n">five</span><span class="o">=</span><span class="mf">4.0e0</span><span class="o">+</span><span class="mf">1.0e0</span>
<a name="ln-2119"></a>        <span class="n">temp20</span><span class="o">=</span><span class="mf">4.0e0</span><span class="o">*</span><span class="n">five</span>
<a name="ln-2120"></a>        <span class="n">temp12</span><span class="o">=</span><span class="mf">3.0e0</span><span class="o">*</span><span class="mf">4.0e0</span>
<a name="ln-2121"></a>        <span class="n">tmp240</span><span class="o">=</span><span class="n">temp20</span><span class="o">*</span><span class="n">temp12</span>
<a name="ln-2122"></a><span class="c">!1130    continue</span>
<a name="ln-2123"></a>        <span class="n">temp80</span><span class="o">=</span><span class="n">tmp240</span><span class="o">/</span><span class="mf">3.0e0</span>
<a name="ln-2124"></a>        <span class="n">temp60</span><span class="o">=</span><span class="n">tmp240</span><span class="o">/</span><span class="mf">4.0e0</span>
<a name="ln-2125"></a>        <span class="n">temp48</span><span class="o">=</span><span class="n">tmp240</span><span class="o">/</span><span class="n">five</span>
<a name="ln-2126"></a>        <span class="n">temp80</span><span class="o">=</span><span class="n">temp80</span><span class="o">-</span><span class="mf">4.0e0</span><span class="o">*</span><span class="n">temp20</span>
<a name="ln-2127"></a>        <span class="n">temp60</span><span class="o">=</span><span class="n">temp60</span><span class="o">-</span><span class="n">five</span><span class="o">*</span><span class="n">temp12</span>
<a name="ln-2128"></a>        <span class="n">temp48</span><span class="o">=</span><span class="n">temp48</span><span class="o">-</span><span class="mf">4.0e0</span><span class="o">*</span><span class="n">temp12</span>
<a name="ln-2129"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">temp80</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">0.0e0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">temp60</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">0.0e0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">temp48</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">0.0e0</span> <span class="p">)</span> <span class="k">goto </span><span class="mi">1150</span>
<a name="ln-2130"></a><span class="c">!1140    continue</span>
<a name="ln-2131"></a>        <span class="n">fails</span><span class="o">=</span><span class="n">fails</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2132"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1141</span><span class="p">)</span>
<a name="ln-2133"></a><span class="mi">1141</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE: violation of 240/3 = 80 or 240/4 = 60 or 240/5 = 48 .&#39;</span><span class="p">)</span>
<a name="ln-2134"></a><span class="mi">1150</span>    <span class="k">continue</span>
<a name="ln-2135"></a><span class="k">        if</span> <span class="p">(</span><span class="n">fails</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">1160</span>
<a name="ln-2136"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">1151</span><span class="p">)</span>
<a name="ln-2137"></a><span class="mi">1151</span>    <span class="k">format</span> <span class="p">(</span><span class="s1">&#39; -1, 0, 1/2 , 1, 2, 3, 4, 5, 9, 27, 32 &amp; 240 are O.K.&#39;</span><span class="p">)</span>
<a name="ln-2138"></a><span class="mi">1160</span>    <span class="k">continue</span>
<a name="ln-2139"></a><span class="k">        return</span>
<a name="ln-2140"></a><span class="k">        end subroutine </span><span class="n">smlint</span>
<a name="ln-2141"></a><span class="c">!#######################################################################</span>
<a name="ln-2142"></a><span class="c">!---</span>
<a name="ln-2143"></a>        <span class="k">subroutine </span><span class="n">square</span> <span class="p">(</span><span class="n">from</span><span class="p">,</span> <span class="n">miles</span><span class="p">,</span> <span class="n">numtry</span><span class="p">)</span>
<a name="ln-2144"></a>      <span class="k">implicit none</span>
<a name="ln-2145"></a><span class="c">!</span>
<a name="ln-2146"></a><span class="c">!</span>
<a name="ln-2147"></a>        <span class="kt">integer </span><span class="n">from</span><span class="p">,</span> <span class="n">miles</span><span class="p">,</span> <span class="n">numtry</span>
<a name="ln-2148"></a><span class="c">!       ... LOCAL VARIABLES</span>
<a name="ln-2149"></a>        <span class="kt">real </span><span class="n">d</span><span class="p">,</span> <span class="n">d4</span><span class="p">,</span> <span class="n">e5</span><span class="p">,</span> <span class="n">e6</span><span class="p">,</span> <span class="n">e7</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x8</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span>
<a name="ln-2150"></a>        <span class="kt">real </span><span class="n">temp</span><span class="p">,</span><span class="n">temp1</span><span class="p">,</span><span class="n">temp2</span>
<a name="ln-2151"></a>        <span class="kt">integer </span><span class="n">i</span><span class="p">,</span> <span class="n">j</span>
<a name="ln-2152"></a><span class="c">!       ... CONSTANTS</span>
<a name="ln-2153"></a>        <span class="kt">real </span><span class="n">b2</span>
<a name="ln-2154"></a>        <span class="kt">real </span><span class="n">b9</span><span class="p">,</span> <span class="n">b1</span>
<a name="ln-2155"></a><span class="c">!</span>
<a name="ln-2156"></a><span class="c">!                       TRAP INTEGER OVERFLOWS</span>
<a name="ln-2157"></a><span class="c">!                       OTHER EXCEPTIONS ARE TRAPPED BY DEFAULT</span>
<a name="ln-2158"></a>        <span class="n">b2</span> <span class="o">=</span> <span class="nb">radix</span> <span class="o">/</span> <span class="n">fp2</span>
<a name="ln-2159"></a>        <span class="n">b9</span> <span class="o">=</span> <span class="p">((</span><span class="nb">radix</span> <span class="o">-</span> <span class="n">fp1</span><span class="p">)</span> <span class="o">-</span> <span class="n">ulppls</span><span class="p">)</span> <span class="o">+</span> <span class="n">fp1</span>
<a name="ln-2160"></a>        <span class="n">b1</span> <span class="o">=</span> <span class="n">fp1</span> <span class="o">/</span> <span class="nb">radix</span>
<a name="ln-2161"></a><span class="nb">        </span><span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">79</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">3058</span>
<a name="ln-2162"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">badmil</span>
<a name="ln-2163"></a><span class="c">!</span>
<a name="ln-2164"></a><span class="c">!3020    continue</span>
<a name="ln-2165"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">3021</span><span class="p">)</span>
<a name="ln-2166"></a><span class="mi">3021</span>    <span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="s1">&#39; Running tests of square root...&#39;</span><span class="p">)</span>
<a name="ln-2167"></a>        <span class="n">miles</span> <span class="o">=</span> <span class="mi">79</span>
<a name="ln-2168"></a>        <span class="k">call </span><span class="n">logit</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-2169"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">fp0</span>
<a name="ln-2170"></a>        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2171"></a><span class="mi">3030</span>    <span class="k">continue</span>
<a name="ln-2172"></a><span class="k">        </span><span class="n">y</span> <span class="o">=</span>  <span class="nb">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="ln-2173"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">x</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">y</span> <span class="o">-</span> <span class="n">half</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">x</span> <span class="o">-</span> <span class="n">half</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3050</span>
<a name="ln-2174"></a><span class="c">!3040    continue</span>
<a name="ln-2175"></a>        <span class="n">fails</span> <span class="o">=</span> <span class="n">fails</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2176"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">3041</span><span class="p">)</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<a name="ln-2177"></a><span class="mi">3041</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE:  sqrt(&#39;</span><span class="p">,</span><span class="n">e9</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;), miscalculated as &#39;</span><span class="p">,</span><span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-2178"></a><span class="mi">3050</span>    <span class="k">continue</span>
<a name="ln-2179"></a><span class="k">        </span><span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span>
<a name="ln-2180"></a>        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2181"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3030</span>
<a name="ln-2182"></a>        <span class="n">go</span> <span class="n">to</span> <span class="mi">3060</span>
<a name="ln-2183"></a><span class="mi">3058</span>    <span class="k">continue</span>
<a name="ln-2184"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">3059</span><span class="p">)</span>
<a name="ln-2185"></a><span class="mi">3059</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE:  sqrt(-0.0) stops the machine.&#39;</span><span class="p">)</span>
<a name="ln-2186"></a>        <span class="n">fails</span> <span class="o">=</span> <span class="n">fails</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2187"></a>        <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-2188"></a><span class="mi">3060</span>    <span class="k">continue</span>
<a name="ln-2189"></a><span class="k">        </span><span class="n">x</span> <span class="o">=</span> <span class="n">fp1</span>
<a name="ln-2190"></a>        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2191"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">3</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3030</span>
<a name="ln-2192"></a><span class="c">!       ... RECORD MIN AND MAX ERRORS.</span>
<a name="ln-2193"></a><span class="c">!3070    continue</span>
<a name="ln-2194"></a>        <span class="n">e5</span> <span class="o">=</span> <span class="n">fp0</span>
<a name="ln-2195"></a>        <span class="n">e7</span> <span class="o">=</span> <span class="n">fp0</span>
<a name="ln-2196"></a><span class="c">!       ... TEST WHETHER  SQRT(X*X)  =  X</span>
<a name="ln-2197"></a><span class="c">!3150    continue</span>
<a name="ln-2198"></a>        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2199"></a>        <span class="n">x</span> <span class="o">=</span> <span class="nb">radix</span>
<a name="ln-2200"></a><span class="nb">        </span><span class="n">u</span> <span class="o">=</span> <span class="n">ulppls</span>
<a name="ln-2201"></a>        <span class="k">call </span><span class="n">sqrerr</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">e5</span><span class="p">,</span> <span class="n">e7</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-2202"></a><span class="c">!3160    continue</span>
<a name="ln-2203"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">b1</span>
<a name="ln-2204"></a>        <span class="n">u</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">ulpmin</span>
<a name="ln-2205"></a>        <span class="k">call </span><span class="n">sqrerr</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">e5</span><span class="p">,</span> <span class="n">e7</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-2206"></a><span class="c">!3170    continue</span>
<a name="ln-2207"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">w</span>
<a name="ln-2208"></a>        <span class="n">u</span> <span class="o">=</span> <span class="n">fp1</span>
<a name="ln-2209"></a>        <span class="k">call </span><span class="n">sqrerr</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">e5</span><span class="p">,</span> <span class="n">e7</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-2210"></a><span class="c">!3180    continue</span>
<a name="ln-2211"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">ulpmin</span>
<a name="ln-2212"></a>        <span class="n">u</span> <span class="o">=</span> <span class="n">ulpmin</span> <span class="o">*</span> <span class="n">ulpmin</span>
<a name="ln-2213"></a>        <span class="k">call </span><span class="n">sqrerr</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">e5</span><span class="p">,</span> <span class="n">e7</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-2214"></a><span class="c">!                       IF SQRT HAS SERIOUS DEFECTS, THEN PAUSE</span>
<a name="ln-2215"></a><span class="c">!3190    continue</span>
<a name="ln-2216"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3210</span>
<a name="ln-2217"></a><span class="c">!3200    continue</span>
<a name="ln-2218"></a>        <span class="n">sdefct</span> <span class="o">=</span> <span class="n">sdefct</span> <span class="o">+</span> <span class="n">j</span>
<a name="ln-2219"></a>        <span class="k">call </span><span class="n">page</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-2220"></a><span class="c">!</span>
<a name="ln-2221"></a><span class="c">!</span>
<a name="ln-2222"></a><span class="c">!</span>
<a name="ln-2223"></a><span class="mi">3210</span>    <span class="k">continue</span>
<a name="ln-2224"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">3211</span><span class="p">)</span> <span class="n">numtry</span>
<a name="ln-2225"></a><span class="mi">3211</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Testing if  sqrt(x*x)  =  x  for  &#39;</span><span class="p">,</span><span class="n">i4</span><span class="p">,</span><span class="s1">&#39; integers  x.&#39;</span><span class="p">)</span>
<a name="ln-2226"></a><span class="c">!3220    continue</span>
<a name="ln-2227"></a>        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2228"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">fp2</span>
<a name="ln-2229"></a>        <span class="n">y</span> <span class="o">=</span> <span class="nb">radix</span>
<a name="ln-2230"></a><span class="nb">        </span><span class="k">if</span> <span class="p">(</span><span class="nb">radix</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp1</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3240</span>
<a name="ln-2231"></a><span class="c">!                       LOOP TO DETERMINE ??</span>
<a name="ln-2232"></a><span class="mi">3230</span>    <span class="k">continue</span>
<a name="ln-2233"></a><span class="k">        </span><span class="n">x</span> <span class="o">=</span> <span class="n">y</span>
<a name="ln-2234"></a>        <span class="n">y</span> <span class="o">=</span> <span class="nb">radix</span> <span class="o">*</span> <span class="n">x</span>
<a name="ln-2235"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">numtry</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3230</span>
<a name="ln-2236"></a><span class="mi">3240</span>    <span class="k">continue</span>
<a name="ln-2237"></a><span class="k">        </span><span class="n">u</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">ulppls</span>
<a name="ln-2238"></a><span class="c">!</span>
<a name="ln-2239"></a>        <span class="k">do </span><span class="mi">3260</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">numtry</span>
<a name="ln-2240"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">fp1</span>
<a name="ln-2241"></a>        <span class="k">call </span><span class="n">sqrerr</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">e5</span><span class="p">,</span> <span class="n">e7</span><span class="p">,</span> <span class="p">.</span><span class="n">false</span><span class="p">.)</span>
<a name="ln-2242"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3280</span>
<a name="ln-2243"></a><span class="mi">3260</span>    <span class="k">continue</span>
<a name="ln-2244"></a><span class="c">!</span>
<a name="ln-2245"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">3270</span><span class="p">)</span>
<a name="ln-2246"></a><span class="mi">3270</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Found no discrepancies.&#39;</span><span class="p">)</span>
<a name="ln-2247"></a>        <span class="k">goto </span><span class="mi">3300</span>
<a name="ln-2248"></a><span class="mi">3280</span>    <span class="k">continue</span>
<a name="ln-2249"></a><span class="k">        </span><span class="n">defect</span> <span class="o">=</span> <span class="n">defect</span> <span class="o">+</span> <span class="n">j</span>
<a name="ln-2250"></a><span class="c">!</span>
<a name="ln-2251"></a><span class="c">!                       TEST SQRT FOR MONOTONICITY.</span>
<a name="ln-2252"></a><span class="c">!</span>
<a name="ln-2253"></a><span class="mi">3300</span>    <span class="k">continue</span>
<a name="ln-2254"></a><span class="k">        </span><span class="n">i</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-2255"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">b9</span>
<a name="ln-2256"></a>        <span class="n">y</span> <span class="o">=</span> <span class="nb">radix</span>
<a name="ln-2257"></a><span class="nb">        </span><span class="n">z</span> <span class="o">=</span> <span class="nb">radix</span> <span class="o">+</span> <span class="nb">radix</span> <span class="o">*</span> <span class="n">ulppls</span>
<a name="ln-2258"></a><span class="c">!</span>
<a name="ln-2259"></a><span class="c">!                       LOOP</span>
<a name="ln-2260"></a><span class="c">!</span>
<a name="ln-2261"></a><span class="mi">3310</span>    <span class="k">continue</span>
<a name="ln-2262"></a><span class="k">        </span><span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2263"></a>        <span class="n">x</span> <span class="o">=</span>  <span class="nb">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="ln-2264"></a>        <span class="n">q</span> <span class="o">=</span>  <span class="nb">sqrt</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a name="ln-2265"></a>        <span class="n">z</span> <span class="o">=</span>  <span class="nb">sqrt</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<a name="ln-2266"></a>        <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">q</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">q</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">z</span><span class="p">))</span> <span class="k">goto </span><span class="mi">3330</span>
<a name="ln-2267"></a><span class="c">!3320    continue</span>
<a name="ln-2268"></a>        <span class="n">defect</span> <span class="o">=</span> <span class="n">defect</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2269"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">3321</span><span class="p">)</span> <span class="n">y</span>
<a name="ln-2270"></a><span class="mi">3321</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; DEFECT:  sqrt(x) is non - monotonic for  x  near &#39;</span><span class="p">,</span> <span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-2271"></a>        <span class="k">goto </span><span class="mi">3390</span>
<a name="ln-2272"></a><span class="mi">3330</span>    <span class="k">continue</span>
<a name="ln-2273"></a><span class="k">        </span><span class="n">q</span> <span class="o">=</span> <span class="nb">aint</span><span class="p">(</span><span class="n">q</span> <span class="o">+</span> <span class="n">half</span><span class="p">)</span>
<a name="ln-2274"></a>        <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">q</span><span class="o">*</span><span class="n">q</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="nb">radix</span><span class="p">))</span> <span class="k">goto </span><span class="mi">3380</span>
<a name="ln-2275"></a><span class="c">!3340    continue</span>
<a name="ln-2276"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3360</span>
<a name="ln-2277"></a><span class="c">!3350    continue</span>
<a name="ln-2278"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">q</span>
<a name="ln-2279"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">ulppls</span>
<a name="ln-2280"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">ulppls</span>
<a name="ln-2281"></a>        <span class="k">goto </span><span class="mi">3310</span>
<a name="ln-2282"></a><span class="c">!</span>
<a name="ln-2283"></a><span class="mi">3360</span>    <span class="k">continue</span>
<a name="ln-2284"></a><span class="k">        if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3380</span>
<a name="ln-2285"></a><span class="c">!3370    continue</span>
<a name="ln-2286"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">*</span> <span class="n">b1</span>
<a name="ln-2287"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">ulpmin</span>
<a name="ln-2288"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">ulpmin</span>
<a name="ln-2289"></a>        <span class="k">goto </span><span class="mi">3310</span>
<a name="ln-2290"></a><span class="mi">3380</span>    <span class="k">continue</span>
<a name="ln-2291"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">3381</span><span class="p">)</span>
<a name="ln-2292"></a><span class="mi">3381</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Sqrt has passed a test for monotonicity.&#39;</span><span class="p">)</span>
<a name="ln-2293"></a><span class="mi">3390</span>    <span class="k">continue</span>
<a name="ln-2294"></a><span class="k">        </span><span class="n">miles</span> <span class="o">=</span> <span class="mi">80</span>
<a name="ln-2295"></a><span class="c">!</span>
<a name="ln-2296"></a><span class="c">!       TEST SQRT FOR ACCURACY  =====================================</span>
<a name="ln-2297"></a><span class="c">!               E5 = MIN{ERROR + 1/2}</span>
<a name="ln-2298"></a><span class="c">!               E7 = MAX{ERROR - 1/2}</span>
<a name="ln-2299"></a><span class="c">!</span>
<a name="ln-2300"></a><span class="c">!3400    continue</span>
<a name="ln-2301"></a>        <span class="n">e5</span> <span class="o">=</span> <span class="n">e5</span> <span class="o">+</span> <span class="n">half</span>
<a name="ln-2302"></a>        <span class="n">e7</span> <span class="o">=</span> <span class="n">e7</span> <span class="o">-</span> <span class="n">half</span>
<a name="ln-2303"></a><span class="c">!3410    continue</span>
<a name="ln-2304"></a>        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">fp1</span> <span class="o">+</span> <span class="n">ulppls</span><span class="p">)</span> <span class="o">-</span> <span class="n">fp1</span><span class="p">)</span><span class="o">/</span><span class="n">ulppls</span>
<a name="ln-2305"></a>        <span class="n">e6</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">fp1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ulppls</span><span class="o">/</span><span class="n">fp8</span>
<a name="ln-2306"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">e6</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">e7</span><span class="p">)</span> <span class="n">e7</span> <span class="o">=</span> <span class="n">e6</span>
<a name="ln-2307"></a><span class="c">!3420    continue</span>
<a name="ln-2308"></a>        <span class="n">e6</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">ulppls</span><span class="o">/</span><span class="n">fp8</span>
<a name="ln-2309"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">e6</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">e5</span><span class="p">)</span> <span class="n">e5</span> <span class="o">=</span> <span class="n">e6</span>
<a name="ln-2310"></a><span class="c">!3430    continue</span>
<a name="ln-2311"></a>        <span class="n">y</span> <span class="o">=</span> <span class="p">((</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">onemin</span><span class="p">)</span> <span class="o">-</span> <span class="n">ulppls</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">fp1</span> <span class="o">-</span> <span class="n">ulppls</span><span class="p">))</span><span class="o">/</span><span class="n">ulpmin</span>
<a name="ln-2312"></a>        <span class="n">e6</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">ulpmin</span><span class="o">/</span><span class="n">fp8</span>
<a name="ln-2313"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">e6</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">e7</span><span class="p">)</span> <span class="n">e7</span> <span class="o">=</span> <span class="n">e6</span>
<a name="ln-2314"></a><span class="c">!3440    continue</span>
<a name="ln-2315"></a>        <span class="n">e6</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">fp1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ulpmin</span><span class="o">/</span><span class="n">fp8</span>
<a name="ln-2316"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">e6</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">e5</span><span class="p">)</span> <span class="n">e5</span> <span class="o">=</span> <span class="n">e6</span>
<a name="ln-2317"></a><span class="c">!3450    continue</span>
<a name="ln-2318"></a>        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2319"></a>        <span class="n">u</span> <span class="o">=</span> <span class="n">ulppls</span>
<a name="ln-2320"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">u</span>
<a name="ln-2321"></a><span class="c">!</span>
<a name="ln-2322"></a><span class="c">!                       LOOP</span>
<a name="ln-2323"></a><span class="c">!</span>
<a name="ln-2324"></a><span class="mi">3460</span>    <span class="k">continue</span>
<a name="ln-2325"></a><span class="k">        </span><span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2326"></a>        <span class="n">y</span> <span class="o">=</span>  <span class="nb">sqrt</span><span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="n">ulpmin</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">onemin</span><span class="p">)</span>
<a name="ln-2327"></a>        <span class="n">y</span> <span class="o">=</span> <span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">ulppls</span><span class="p">)</span> <span class="o">-</span> <span class="p">((</span><span class="n">fp1</span> <span class="o">-</span> <span class="n">ulppls</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">u</span>
<a name="ln-2328"></a>        <span class="n">z</span> <span class="o">=</span> <span class="p">((</span><span class="n">ulpmin</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">onemin</span><span class="p">)</span><span class="o">*</span><span class="n">half</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">u</span>
<a name="ln-2329"></a>        <span class="n">e6</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">half</span><span class="p">)</span> <span class="o">+</span> <span class="n">z</span>
<a name="ln-2330"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">e6</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">e5</span><span class="p">)</span> <span class="n">e5</span> <span class="o">=</span> <span class="n">e6</span>
<a name="ln-2331"></a><span class="c">!3470    continue</span>
<a name="ln-2332"></a>        <span class="n">e6</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">half</span><span class="p">)</span> <span class="o">+</span> <span class="n">z</span>
<a name="ln-2333"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">e6</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">e7</span><span class="p">)</span> <span class="n">e7</span> <span class="o">=</span> <span class="n">e6</span>
<a name="ln-2334"></a><span class="c">!3480    continue</span>
<a name="ln-2335"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">4</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3530</span>
<a name="ln-2336"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3520</span>
<a name="ln-2337"></a><span class="c">!3500    continue</span>
<a name="ln-2338"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">u</span> <span class="o">*</span>  <span class="nb">sign</span><span class="p">(</span><span class="n">fp1</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="nb">aint</span><span class="p">(</span> <span class="n">fp8</span> <span class="o">/</span> <span class="p">(</span><span class="n">fp9</span> <span class="o">*</span>  <span class="nb">sqrt</span><span class="p">(</span><span class="n">u</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-2339"></a>        <span class="k">goto </span><span class="mi">3460</span>
<a name="ln-2340"></a><span class="c">!</span>
<a name="ln-2341"></a><span class="mi">3520</span>    <span class="k">continue</span>
<a name="ln-2342"></a><span class="k">        </span><span class="n">u</span> <span class="o">=</span> <span class="n">ulpmin</span>
<a name="ln-2343"></a>        <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">u</span>
<a name="ln-2344"></a>        <span class="k">goto </span><span class="mi">3460</span>
<a name="ln-2345"></a><span class="c">!</span>
<a name="ln-2346"></a><span class="mi">3530</span>    <span class="k">continue</span>
<a name="ln-2347"></a><span class="k">        </span><span class="n">miles</span> <span class="o">=</span> <span class="mi">85</span>
<a name="ln-2348"></a>        <span class="n">r4</span> <span class="o">=</span> <span class="n">minus1</span>
<a name="ln-2349"></a><span class="c">!3540    continue</span>
<a name="ln-2350"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">radix</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp1</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3900</span>
<a name="ln-2351"></a><span class="c">!3550    continue</span>
<a name="ln-2352"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">3551</span><span class="p">)</span>
<a name="ln-2353"></a><span class="mi">3551</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Testing whether  sqrt  is rounded or chopped:&#39;</span><span class="p">)</span>
<a name="ln-2354"></a><span class="c">!3560    continue</span>
<a name="ln-2355"></a>        <span class="n">d</span> <span class="o">=</span> <span class="nb">aint</span><span class="p">(</span><span class="n">half</span> <span class="o">+</span> <span class="nb">radix</span> <span class="o">**</span> <span class="p">(</span><span class="n">fp1</span> <span class="o">+</span> <span class="n">precis</span> <span class="o">-</span> <span class="nb">aint</span><span class="p">(</span><span class="n">precis</span><span class="p">)))</span>
<a name="ln-2356"></a><span class="c">!</span>
<a name="ln-2357"></a><span class="c">!       ...  =  B^(1 + FRACT)  IF  P  =  INTEGER  +  FRACT.</span>
<a name="ln-2358"></a><span class="c">!</span>
<a name="ln-2359"></a><span class="c">!3570    continue</span>
<a name="ln-2360"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">d</span> <span class="o">/</span> <span class="nb">radix</span>
<a name="ln-2361"></a><span class="nb">        </span><span class="n">y</span> <span class="o">=</span> <span class="n">d</span> <span class="o">/</span> <span class="n">a1</span>
<a name="ln-2362"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="nb">aint</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">y</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="nb">aint</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="k">goto </span><span class="mi">3700</span>
<a name="ln-2363"></a><span class="c">!3580    continue</span>
<a name="ln-2364"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">fp0</span>
<a name="ln-2365"></a>        <span class="n">z2</span> <span class="o">=</span> <span class="n">x</span>
<a name="ln-2366"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">fp1</span>
<a name="ln-2367"></a>        <span class="n">y2</span> <span class="o">=</span> <span class="n">y</span>
<a name="ln-2368"></a>        <span class="n">z1</span> <span class="o">=</span> <span class="nb">radix</span> <span class="o">-</span> <span class="n">fp1</span>
<a name="ln-2369"></a>        <span class="n">d4</span> <span class="o">=</span> <span class="n">fp4</span> <span class="o">*</span> <span class="n">d</span>
<a name="ln-2370"></a><span class="c">!</span>
<a name="ln-2371"></a><span class="c">!       LOOP: FOR  Y  =  1, 3, 5, ...  MAXIMIZE  Y2  =  Y*Y MOD 4D .</span>
<a name="ln-2372"></a><span class="c">!</span>
<a name="ln-2373"></a><span class="mi">3600</span>    <span class="k">continue</span>
<a name="ln-2374"></a><span class="k">        if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="p">(</span><span class="n">y2</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">z2</span><span class="p">))</span> <span class="k">goto </span><span class="mi">3650</span>
<a name="ln-2375"></a><span class="c">!3610    continue</span>
<a name="ln-2376"></a>        <span class="n">q</span> <span class="o">=</span> <span class="nb">radix</span>
<a name="ln-2377"></a><span class="nb">        </span><span class="n">y1</span> <span class="o">=</span> <span class="n">y</span>
<a name="ln-2378"></a><span class="c">!                       IF NEW Y2 &gt; OLD, CHECK THAT  GCD(Y,B)  =  1</span>
<a name="ln-2379"></a><span class="mi">3620</span>    <span class="k">continue</span>
<a name="ln-2380"></a><span class="k">        </span><span class="n">temp</span> <span class="o">=</span> <span class="n">half</span> <span class="o">-</span> <span class="n">q</span> <span class="o">/</span> <span class="n">y1</span>
<a name="ln-2381"></a>        <span class="n">temp1</span> <span class="o">=</span> <span class="nb">aint</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
<a name="ln-2382"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">temp1</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">temp</span><span class="p">)</span> <span class="n">temp1</span> <span class="o">=</span> <span class="n">temp1</span> <span class="o">-</span> <span class="n">fp1</span>
<a name="ln-2383"></a>        <span class="n">x1</span> <span class="o">=</span>  <span class="nb">abs</span><span class="p">(</span><span class="n">q</span> <span class="o">+</span> <span class="n">temp1</span> <span class="o">*</span> <span class="n">y1</span><span class="p">)</span>
<a name="ln-2384"></a>        <span class="n">q</span> <span class="o">=</span> <span class="n">y1</span>
<a name="ln-2385"></a>        <span class="n">y1</span> <span class="o">=</span> <span class="n">x1</span>
<a name="ln-2386"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x1</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3620</span>
<a name="ln-2387"></a><span class="c">!</span>
<a name="ln-2388"></a><span class="c">!3630    continue</span>
<a name="ln-2389"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">q</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp1</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3650</span>
<a name="ln-2390"></a><span class="c">!                       IF GCD(Y,B)  .GT.  1 THEN SKIP OVER Y ;  ELSE</span>
<a name="ln-2391"></a><span class="c">!3640    continue</span>
<a name="ln-2392"></a>        <span class="n">z2</span> <span class="o">=</span> <span class="n">y2</span>
<a name="ln-2393"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">y</span>
<a name="ln-2394"></a><span class="c">!                       AND GCD(Z, RADIX)  = 1</span>
<a name="ln-2395"></a><span class="mi">3650</span>    <span class="k">continue</span>
<a name="ln-2396"></a><span class="k">        </span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">fp2</span>
<a name="ln-2397"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">fp8</span>
<a name="ln-2398"></a>        <span class="n">y2</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">+</span> <span class="n">x</span>
<a name="ln-2399"></a>        <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="p">(</span><span class="n">y2</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">d4</span><span class="p">))</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">d4</span>
<a name="ln-2400"></a><span class="c">!                       =  Y*Y MOD 4D</span>
<a name="ln-2401"></a><span class="c">!3660    continue</span>
<a name="ln-2402"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">d</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3600</span>
<a name="ln-2403"></a><span class="c">!                       ELSE  0 &lt; Z &lt; D  &amp;  Z2 = Z^2 MOD 4D  IS MAXIMAL</span>
<a name="ln-2404"></a><span class="c">!3670    continue</span>
<a name="ln-2405"></a>        <span class="n">x8</span> <span class="o">=</span> <span class="n">d4</span> <span class="o">-</span> <span class="n">z2</span>
<a name="ln-2406"></a>        <span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="n">x8</span> <span class="o">+</span> <span class="n">z</span> <span class="o">*</span> <span class="n">z</span><span class="p">)</span> <span class="o">/</span> <span class="n">d4</span>
<a name="ln-2407"></a>        <span class="n">x8</span> <span class="o">=</span> <span class="n">x8</span> <span class="o">/</span> <span class="n">fp8</span>
<a name="ln-2408"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">q</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="nb">aint</span><span class="p">(</span><span class="n">q</span><span class="p">))</span> <span class="k">goto </span><span class="mi">3700</span>
<a name="ln-2409"></a><span class="mi">3680</span>    <span class="k">continue</span>
<a name="ln-2410"></a><span class="k">        </span><span class="n">x</span> <span class="o">=</span> <span class="n">z1</span> <span class="o">*</span> <span class="n">z</span>
<a name="ln-2411"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="nb">aint</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="nb">radix</span><span class="p">)</span> <span class="o">*</span> <span class="nb">radix</span>
<a name="ln-2412"></a><span class="nb">        </span><span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp1</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3800</span>
<a name="ln-2413"></a><span class="c">!                       WITH  1  =  Z*Z1 MOD B</span>
<a name="ln-2414"></a><span class="c">!3690    continue</span>
<a name="ln-2415"></a>        <span class="n">z1</span> <span class="o">=</span> <span class="n">z1</span> <span class="o">-</span> <span class="n">fp1</span>
<a name="ln-2416"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">z1</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3680</span>
<a name="ln-2417"></a><span class="c">!                       ELSE FAILURE!</span>
<a name="ln-2418"></a><span class="mi">3700</span>    <span class="k">continue</span>
<a name="ln-2419"></a><span class="k">        </span><span class="n">fails</span> <span class="o">=</span> <span class="n">fails</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2420"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">3701</span><span class="p">)</span> <span class="n">w</span>
<a name="ln-2421"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">3702</span><span class="p">)</span>
<a name="ln-2422"></a><span class="mi">3701</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE: anomalous arithmetic with integers &lt; b^p  = &#39;</span><span class="p">,</span> <span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-2423"></a><span class="mi">3702</span>    <span class="k">format</span> <span class="p">(</span><span class="s1">&#39;         foils test whether  sqrt  rounds or chops.&#39;</span><span class="p">)</span>
<a name="ln-2424"></a>        <span class="k">goto </span><span class="mi">3940</span>
<a name="ln-2425"></a><span class="c">!</span>
<a name="ln-2426"></a><span class="c">!                       - B/2   &lt;=   Z1 == 1/Z MOD B   &lt;=   B/2</span>
<a name="ln-2427"></a><span class="c">!</span>
<a name="ln-2428"></a><span class="mi">3800</span>    <span class="k">continue</span>
<a name="ln-2429"></a><span class="k">        if</span> <span class="p">(</span><span class="n">z1</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">b2</span><span class="p">)</span> <span class="n">z1</span> <span class="o">=</span> <span class="n">z1</span> <span class="o">-</span> <span class="nb">radix</span>
<a name="ln-2430"></a><span class="c">!</span>
<a name="ln-2431"></a><span class="c">!                       LOOP UNTIL  D  =  B^(P - 1) .</span>
<a name="ln-2432"></a><span class="c">!</span>
<a name="ln-2433"></a><span class="mi">3810</span>    <span class="k">continue</span>
<a name="ln-2434"></a><span class="k">        call </span><span class="n">newd</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
<a name="ln-2435"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ulppls</span> <span class="o">*</span> <span class="n">d</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">onemin</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3810</span>
<a name="ln-2436"></a><span class="c">!</span>
<a name="ln-2437"></a><span class="c">!3820    continue</span>
<a name="ln-2438"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">d</span> <span class="o">*</span> <span class="nb">radix</span> <span class="o">-</span> <span class="n">d</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">w</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3700</span>
<a name="ln-2439"></a><span class="c">!3830    continue</span>
<a name="ln-2440"></a>        <span class="n">z2</span> <span class="o">=</span> <span class="n">d</span>
<a name="ln-2441"></a>        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2442"></a><span class="c">!               COUNT HOW MANY TESTS OF  SQRT(D*X) = Y YIELD RESULTS.</span>
<a name="ln-2443"></a><span class="c">!3840    continue</span>
<a name="ln-2444"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="p">(</span><span class="n">fp1</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="n">half</span>
<a name="ln-2445"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="n">z</span> <span class="o">+</span> <span class="n">q</span>
<a name="ln-2446"></a>        <span class="k">call </span><span class="n">sqrtdx</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x8</span><span class="p">,</span> <span class="n">e5</span><span class="p">,</span> <span class="n">e7</span><span class="p">)</span>
<a name="ln-2447"></a><span class="c">!3850    continue</span>
<a name="ln-2448"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="p">(</span><span class="n">fp1</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="n">half</span> <span class="o">+</span> <span class="n">d</span>
<a name="ln-2449"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">d</span> <span class="o">-</span> <span class="n">z</span> <span class="o">+</span> <span class="n">d</span>
<a name="ln-2450"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">q</span> <span class="o">+</span> <span class="n">x</span>
<a name="ln-2451"></a>        <span class="k">call </span><span class="n">sqrtdx</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x8</span><span class="p">,</span> <span class="n">e5</span><span class="p">,</span> <span class="n">e7</span><span class="p">)</span>
<a name="ln-2452"></a><span class="c">!3860    continue</span>
<a name="ln-2453"></a>        <span class="k">call </span><span class="n">newd</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
<a name="ln-2454"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="n">z2</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">w</span> <span class="o">-</span> <span class="n">z2</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3700</span>
<a name="ln-2455"></a><span class="c">!3870    continue</span>
<a name="ln-2456"></a>        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="n">z2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">z2</span> <span class="o">+</span> <span class="p">(</span><span class="n">fp1</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="n">half</span><span class="p">)</span>
<a name="ln-2457"></a>        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="n">z2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">z2</span> <span class="o">-</span> <span class="n">z</span> <span class="o">+</span> <span class="n">q</span><span class="p">)</span>
<a name="ln-2458"></a>        <span class="k">call </span><span class="n">sqrtdx</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x8</span><span class="p">,</span> <span class="n">e5</span><span class="p">,</span> <span class="n">e7</span><span class="p">)</span>
<a name="ln-2459"></a><span class="c">!3880    continue</span>
<a name="ln-2460"></a>        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">fp1</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="n">half</span>
<a name="ln-2461"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">q</span>
<a name="ln-2462"></a>        <span class="k">call </span><span class="n">sqrtdx</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x8</span><span class="p">,</span> <span class="n">e5</span><span class="p">,</span> <span class="n">e7</span><span class="p">)</span>
<a name="ln-2463"></a><span class="c">!3890    continue</span>
<a name="ln-2464"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3700</span>
<a name="ln-2465"></a><span class="mi">3900</span>    <span class="k">continue</span>
<a name="ln-2466"></a><span class="k">        if</span> <span class="p">(</span><span class="n">e5</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">e7</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3920</span>
<a name="ln-2467"></a><span class="c">!3910    R4 = FP1</span>
<a name="ln-2468"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">3911</span><span class="p">)</span>
<a name="ln-2469"></a><span class="mi">3911</span>    <span class="k">format</span> <span class="p">(</span><span class="s1">&#39; Square root appears to be correctly rounded.&#39;</span><span class="p">)</span>
<a name="ln-2470"></a>        <span class="k">return</span>
<a name="ln-2471"></a><span class="c">!</span>
<a name="ln-2472"></a><span class="mi">3920</span>    <span class="k">continue</span>
<a name="ln-2473"></a><span class="k">        if</span> <span class="p">(</span><span class="n">e7</span> <span class="o">+</span> <span class="n">ulppls</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">ulppls</span> <span class="o">-</span> <span class="n">half</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="n">e5</span>          <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">half</span>          <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="n">e5</span> <span class="o">+</span> <span class="nb">radix</span>  <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">half</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3940</span>
<a name="ln-2474"></a><span class="c">!3930    continue</span>
<a name="ln-2475"></a>        <span class="n">r4</span> <span class="o">=</span> <span class="n">fp0</span>
<a name="ln-2476"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">3931</span><span class="p">)</span>
<a name="ln-2477"></a><span class="mi">3931</span>    <span class="k">format</span> <span class="p">(</span><span class="s1">&#39; Square root appears to be chopped.&#39;</span><span class="p">)</span>
<a name="ln-2478"></a>        <span class="k">return</span>
<a name="ln-2479"></a><span class="mi">3940</span>    <span class="k">continue</span>
<a name="ln-2480"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">3941</span><span class="p">)</span>
<a name="ln-2481"></a>        <span class="n">temp</span><span class="o">=</span><span class="n">e5</span><span class="o">-</span><span class="n">half</span>
<a name="ln-2482"></a>        <span class="n">temp2</span><span class="o">=</span><span class="n">half</span><span class="o">+</span><span class="n">e7</span>
<a name="ln-2483"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">3942</span><span class="p">)</span> <span class="n">temp</span><span class="p">,</span> <span class="n">temp2</span>
<a name="ln-2484"></a><span class="mi">3941</span>    <span class="k">format</span> <span class="p">(</span><span class="s1">&#39; Square root is neither chopped nor correctly rounded.&#39;</span><span class="p">)</span>
<a name="ln-2485"></a><span class="mi">3942</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Observed errors run from  &#39;</span><span class="p">,</span><span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">,</span><span class="s1">&#39;  to  &#39;</span><span class="p">,</span><span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">,</span><span class="s1">&#39; ulps.&#39;</span><span class="p">)</span>
<a name="ln-2486"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">e7</span> <span class="o">-</span> <span class="n">e5</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="nb">radix</span> <span class="o">*</span> <span class="nb">radix</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-2487"></a><span class="c">!3950    continue</span>
<a name="ln-2488"></a>        <span class="n">sdefct</span> <span class="o">=</span> <span class="n">sdefct</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2489"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">3951</span><span class="p">)</span>
<a name="ln-2490"></a><span class="mi">3951</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; SERIOUS DEFECT: sqrt gets too many last digits wrong.&#39;</span><span class="p">)</span>
<a name="ln-2491"></a>        <span class="k">return</span>
<a name="ln-2492"></a><span class="k">        end subroutine </span><span class="n">square</span>
<a name="ln-2493"></a><span class="c">!#######################################################################</span>
<a name="ln-2494"></a><span class="c">!---</span>
<a name="ln-2495"></a><span class="c">!       ____ SUBROUTINE TO ASSESS ERROR   SQRT(X*X) - X  IN ULPS. ____</span>
<a name="ln-2496"></a><span class="c">!</span>
<a name="ln-2497"></a>        <span class="k">subroutine </span><span class="n">sqrerr</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">e5</span><span class="p">,</span> <span class="n">e7</span><span class="p">,</span> <span class="n">serous</span><span class="p">)</span>
<a name="ln-2498"></a>      <span class="k">implicit none</span>
<a name="ln-2499"></a><span class="c">!</span>
<a name="ln-2500"></a><span class="c">!</span>
<a name="ln-2501"></a>        <span class="kt">integer </span><span class="n">j</span>
<a name="ln-2502"></a>        <span class="kt">real </span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span>    <span class="n">e5</span><span class="p">,</span> <span class="n">e7</span>
<a name="ln-2503"></a>        <span class="kt">logical </span><span class="n">serous</span>
<a name="ln-2504"></a>        <span class="kt">real </span><span class="n">e6</span><span class="p">,</span> <span class="n">b1</span>
<a name="ln-2505"></a>        <span class="n">b1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="nb">radix</span>
<a name="ln-2506"></a><span class="c">!3090    continue</span>
<a name="ln-2507"></a>        <span class="n">e6</span> <span class="o">=</span> <span class="p">((</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">b1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">b1</span><span class="p">))</span> <span class="o">/</span> <span class="n">u</span>
<a name="ln-2508"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">e6</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-2509"></a><span class="c">!3100    continue</span>
<a name="ln-2510"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">e6</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">e5</span><span class="p">)</span> <span class="n">e5</span> <span class="o">=</span> <span class="n">e6</span>
<a name="ln-2511"></a><span class="c">!3110    continue</span>
<a name="ln-2512"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">e6</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">e7</span><span class="p">)</span> <span class="n">e7</span> <span class="o">=</span> <span class="n">e6</span>
<a name="ln-2513"></a><span class="c">!3120    continue</span>
<a name="ln-2514"></a>        <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2515"></a>        <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">serous</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">31210</span><span class="p">)</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="o">*</span><span class="n">e6</span>
<a name="ln-2516"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">serous</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">31211</span><span class="p">)</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="o">*</span><span class="n">e6</span>
<a name="ln-2517"></a><span class="mi">31210</span>   <span class="k">format</span> <span class="p">(</span><span class="s1">&#39; DEFECT: sqrt(&#39;</span><span class="p">,</span> <span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">,</span><span class="s1">&#39;) - &#39;</span><span class="p">,</span><span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">,</span><span class="s1">&#39;  =  &#39;</span><span class="p">,</span> <span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-2518"></a><span class="mi">31211</span>   <span class="k">format</span> <span class="p">(</span><span class="s1">&#39; SERIOUS DEFECT: sqrt(&#39;</span><span class="p">,</span> <span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">,</span><span class="s1">&#39;) - &#39;</span><span class="p">,</span><span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">,</span><span class="s1">&#39;  =  &#39;</span><span class="p">,</span> <span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-2519"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">3122</span><span class="p">)</span>
<a name="ln-2520"></a><span class="mi">3122</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; instead of correct value  0 .&#39;</span><span class="p">)</span>
<a name="ln-2521"></a>        <span class="k">return</span>
<a name="ln-2522"></a><span class="k">        end subroutine </span><span class="n">sqrerr</span>
<a name="ln-2523"></a><span class="c">!#######################################################################</span>
<a name="ln-2524"></a><span class="c">!---</span>
<a name="ln-2525"></a><span class="c">!       THIS SUBROUTINE PUTS  NEWD = B*D  AND</span>
<a name="ln-2526"></a><span class="c">!                             NEWZ^2 MOD NEWD = Z^2 MOD D</span>
<a name="ln-2527"></a><span class="c">!</span>
<a name="ln-2528"></a>        <span class="k">subroutine </span><span class="n">newd</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
<a name="ln-2529"></a>      <span class="k">implicit none</span>
<a name="ln-2530"></a><span class="c">!</span>
<a name="ln-2531"></a><span class="c">!</span>
<a name="ln-2532"></a>        <span class="kt">real </span><span class="n">x</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">d</span>
<a name="ln-2533"></a>        <span class="kt">real </span><span class="n">temp</span><span class="p">,</span> <span class="n">temp1</span>
<a name="ln-2534"></a><span class="c">!</span>
<a name="ln-2535"></a><span class="c">!3720    continue</span>
<a name="ln-2536"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">z1</span> <span class="o">*</span> <span class="n">q</span>
<a name="ln-2537"></a>        <span class="n">temp</span> <span class="o">=</span> <span class="n">half</span> <span class="o">-</span> <span class="n">x</span> <span class="o">/</span> <span class="nb">radix</span>
<a name="ln-2538"></a><span class="nb">        </span><span class="n">temp1</span> <span class="o">=</span> <span class="nb">aint</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
<a name="ln-2539"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">temp1</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">temp</span><span class="p">)</span> <span class="n">temp1</span> <span class="o">=</span> <span class="n">temp1</span> <span class="o">-</span> <span class="n">fp1</span>
<a name="ln-2540"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">temp1</span> <span class="o">*</span> <span class="nb">radix</span> <span class="o">+</span> <span class="n">x</span>
<a name="ln-2541"></a>        <span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="p">)</span> <span class="o">/</span> <span class="nb">radix</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">d</span> <span class="o">/</span> <span class="nb">radix</span><span class="p">)</span>
<a name="ln-2542"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">z</span> <span class="o">-</span> <span class="n">fp2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">d</span>
<a name="ln-2543"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">3740</span>
<a name="ln-2544"></a><span class="c">!3730    continue</span>
<a name="ln-2545"></a>        <span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="n">z</span>
<a name="ln-2546"></a>        <span class="n">z1</span> <span class="o">=</span> <span class="o">-</span><span class="n">z1</span>
<a name="ln-2547"></a><span class="mi">3740</span>    <span class="k">continue</span>
<a name="ln-2548"></a><span class="k">        </span><span class="n">d</span> <span class="o">=</span> <span class="nb">radix</span> <span class="o">*</span> <span class="n">d</span>
<a name="ln-2549"></a>        <span class="k">return</span>
<a name="ln-2550"></a><span class="k">        end subroutine </span><span class="n">newd</span>
<a name="ln-2551"></a><span class="c">!#######################################################################</span>
<a name="ln-2552"></a><span class="c">!---</span>
<a name="ln-2553"></a><span class="c">!       THIS SUBROUTINE TESTS IF</span>
<a name="ln-2554"></a><span class="c">!                SQRT(D*X) =  SQRT((Y - 1/2)^2 + X8/2) ROUNDS TO  Y</span>
<a name="ln-2555"></a><span class="c">!</span>
<a name="ln-2556"></a>        <span class="k">subroutine </span><span class="n">sqrtdx</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x8</span><span class="p">,</span> <span class="n">e5</span><span class="p">,</span> <span class="n">e7</span><span class="p">)</span>
<a name="ln-2557"></a>      <span class="k">implicit none</span>
<a name="ln-2558"></a><span class="c">!</span>
<a name="ln-2559"></a><span class="c">!</span>
<a name="ln-2560"></a>        <span class="kt">real </span><span class="n">x</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x8</span><span class="p">,</span> <span class="n">e5</span><span class="p">,</span> <span class="n">e7</span>
<a name="ln-2561"></a>        <span class="kt">integer </span><span class="n">i</span>
<a name="ln-2562"></a>        <span class="kt">real </span><span class="n">e6</span>
<a name="ln-2563"></a><span class="c">!</span>
<a name="ln-2564"></a><span class="c">!3760    continue</span>
<a name="ln-2565"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="nb">radix</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">z2</span> <span class="o">-</span> <span class="nb">radix</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">x</span> <span class="o">-</span> <span class="n">z2</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">w</span> <span class="o">-</span> <span class="n">z2</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-2566"></a><span class="c">!3770    continue</span>
<a name="ln-2567"></a>        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2568"></a>        <span class="n">x2</span> <span class="o">=</span>  <span class="nb">sqrt</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">d</span><span class="p">)</span>
<a name="ln-2569"></a>        <span class="n">y2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">z2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">z2</span><span class="p">)</span>
<a name="ln-2570"></a>        <span class="n">x2</span> <span class="o">=</span> <span class="n">x8</span><span class="o">/</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">half</span><span class="p">)</span>
<a name="ln-2571"></a>        <span class="n">x2</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">half</span> <span class="o">*</span> <span class="n">x2</span> <span class="o">*</span> <span class="n">x2</span>
<a name="ln-2572"></a>        <span class="n">e6</span> <span class="o">=</span> <span class="p">(</span><span class="n">y2</span> <span class="o">+</span> <span class="n">half</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">half</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span>
<a name="ln-2573"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">e6</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">e5</span><span class="p">)</span> <span class="n">e5</span> <span class="o">=</span> <span class="n">e6</span>
<a name="ln-2574"></a><span class="c">!3780    continue</span>
<a name="ln-2575"></a>        <span class="n">e6</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">x2</span>
<a name="ln-2576"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">e6</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">e7</span><span class="p">)</span> <span class="n">e7</span> <span class="o">=</span> <span class="n">e6</span>
<a name="ln-2577"></a><span class="c">!3790    continue</span>
<a name="ln-2578"></a>        <span class="k">return</span>
<a name="ln-2579"></a><span class="k">        end subroutine </span><span class="n">sqrtdx</span>
<a name="ln-2580"></a><span class="c">!#######################################################################</span>
<a name="ln-2581"></a><span class="c">!---</span>
<a name="ln-2582"></a>        <span class="k">subroutine </span><span class="n">underf</span><span class="p">(</span><span class="n">miles</span><span class="p">,</span> <span class="n">numtry</span><span class="p">,</span> <span class="n">from</span><span class="p">)</span>
<a name="ln-2583"></a>      <span class="k">implicit none</span>
<a name="ln-2584"></a><span class="k">        </span><span class="kt">integer           </span><span class="n">miles</span><span class="p">,</span> <span class="n">numtry</span><span class="p">,</span> <span class="n">from</span>
<a name="ln-2585"></a><span class="c">!        MILES  ... NUMBER OF MILESTONE REACHED SO FAR IN TESTING</span>
<a name="ln-2586"></a><span class="c">!        NUMTRY ... NUMBER OF TIMES TO TRY RANDOM TRIALS</span>
<a name="ln-2587"></a><span class="c">!        FROM   ... NUMBER OF MILESTONE TO RETURN TO ON RESTART</span>
<a name="ln-2588"></a><span class="c">!</span>
<a name="ln-2589"></a><span class="c">!</span>
<a name="ln-2590"></a>        <span class="kt">integer </span><span class="n">accur</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">iq</span><span class="p">,</span> <span class="n">partu</span>
<a name="ln-2591"></a><span class="c">!        ACCUR  ... FLAG TO INDICATE SUCCESS/FAILURE OF ACCURACY TESTS</span>
<a name="ln-2592"></a><span class="c">!        ERROR  ... COUNT OF ERRORS DETECTED TESTING POWERS.</span>
<a name="ln-2593"></a><span class="c">!        I      ... SCRATCH FOR ENUMERATING CASES</span>
<a name="ln-2594"></a><span class="c">!        IQ     ... TEMPORARY FOR HOLDING INTEGER EXPONENTS</span>
<a name="ln-2595"></a><span class="c">!        PARTU  ... FLAG TO INDICATE THE DETECTION OF PARTIAL UNDERFLOW</span>
<a name="ln-2596"></a><span class="c">!</span>
<a name="ln-2597"></a>        <span class="kt">real </span><span class="n">c</span><span class="p">,</span> <span class="n">epsp1</span><span class="p">,</span> <span class="n">exp2</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">mindif</span>
<a name="ln-2598"></a><span class="c">!        C      ... 1/(RADIX^LARGE_INTEGER)</span>
<a name="ln-2599"></a><span class="c">!        EPSP1  ... EPSILON + 1 (1 + (SMALL INTEGER)* 1 ULP OF 1+...)</span>
<a name="ln-2600"></a><span class="c">!        EXP2   ... VALUE OF E ^ 2</span>
<a name="ln-2601"></a><span class="c">!        H      ... MIN (1/RADIX, 1/2)</span>
<a name="ln-2602"></a><span class="c">!        MINDIF ... MINIMUM POSITIVE NUMBER FOUND BY ADDITION/SUBTR.</span>
<a name="ln-2603"></a><span class="c">!</span>
<a name="ln-2604"></a><span class="c">!        ... LOCAL VARIABLES</span>
<a name="ln-2605"></a>        <span class="kt">real </span><span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">v9</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">z9</span><span class="p">,</span><span class="n">temp</span>
<a name="ln-2606"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">charz0</span><span class="p">,</span> <span class="n">chare0</span>
<a name="ln-2607"></a><span class="c">!        CHARZ0 ... CHARACTER CONSTANT &#39;Z0&#39;</span>
<a name="ln-2608"></a><span class="c">!        CHARE0 ... CHARACTER CONSTANT &#39;E0&#39;</span>
<a name="ln-2609"></a>        <span class="k">data </span><span class="n">charz0</span><span class="o">/</span> <span class="s1">&#39; PHONY0&#39;</span><span class="o">/</span><span class="p">,</span><span class="n">chare0</span><span class="o">/</span> <span class="s1">&#39; MINPOS&#39;</span><span class="o">/</span>
<a name="ln-2610"></a><span class="c">!</span>
<a name="ln-2611"></a>        <span class="k">if</span><span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span> <span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4330</span>
<a name="ln-2612"></a><span class="c">!          WE MUST BE DOING A RESTART.  FIGURE OUT WHERE, AND GO DO IT</span>
<a name="ln-2613"></a><span class="c">!       MUST READ THE LOG FILE BACK IN.</span>
<a name="ln-2614"></a>        <span class="k">read</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">accur</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">epsp1</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">exp2</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">iq</span><span class="p">,</span> <span class="n">mindif</span><span class="p">,</span> <span class="n">partu</span>
<a name="ln-2615"></a>        <span class="k">read</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">v9</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">z9</span>
<a name="ln-2616"></a>        <span class="k">rewind </span><span class="mi">3</span>
<a name="ln-2617"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">105</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4390</span>
<a name="ln-2618"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">106</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4410</span>
<a name="ln-2619"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">107</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4450</span>
<a name="ln-2620"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">108</span><span class="p">)</span> <span class="n">phony0</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2621"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">108</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4522</span>
<a name="ln-2622"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">109</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4860</span>
<a name="ln-2623"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">115</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4631</span>
<a name="ln-2624"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">120</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4890</span>
<a name="ln-2625"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">121</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4941</span>
<a name="ln-2626"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">122</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">5011</span>
<a name="ln-2627"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">123</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">5160</span>
<a name="ln-2628"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">124</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">5190</span>
<a name="ln-2629"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">125</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">5175</span>
<a name="ln-2630"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">131</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">53021</span>
<a name="ln-2631"></a><span class="c">!               MAKES NO SENSE TO TALK ABOUT UNDERFLOW STICKING, SINCE</span>
<a name="ln-2632"></a><span class="c">!               UNDERFLOW ABORTS THE PROGRAM....</span>
<a name="ln-2633"></a>        <span class="k">call </span><span class="n">badmil</span>
<a name="ln-2634"></a><span class="mi">4330</span>    <span class="k">continue</span>
<a name="ln-2635"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4335</span><span class="p">)</span>
<a name="ln-2636"></a><span class="mi">4335</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Seeking underflow threshold and min positive number:&#39;</span><span class="p">)</span>
<a name="ln-2637"></a>        <span class="n">miles</span> <span class="o">=</span> <span class="mi">105</span>
<a name="ln-2638"></a>        <span class="k">call </span><span class="n">logit</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-2639"></a><span class="c">!4340    continue</span>
<a name="ln-2640"></a>        <span class="n">d</span> <span class="o">=</span> <span class="n">ulpmin</span>
<a name="ln-2641"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">precis</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="nb">aint</span><span class="p">(</span><span class="n">precis</span><span class="p">))</span> <span class="k">goto </span><span class="mi">4370</span>
<a name="ln-2642"></a><span class="c">!4350    continue</span>
<a name="ln-2643"></a>        <span class="n">d</span> <span class="o">=</span> <span class="n">fp1</span> <span class="o">/</span> <span class="nb">radix</span>
<a name="ln-2644"></a><span class="nb">        </span><span class="n">x</span> <span class="o">=</span> <span class="n">precis</span>
<a name="ln-2645"></a><span class="mi">4360</span>    <span class="k">continue</span>
<a name="ln-2646"></a><span class="k">        </span><span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">/</span> <span class="nb">radix</span>
<a name="ln-2647"></a><span class="nb">        </span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">fp1</span>
<a name="ln-2648"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4360</span>
<a name="ln-2649"></a><span class="c">!       IF NON-INTEGRAL PRECISION NOW HAVE D = 1 RIGHT SHIFTED BY PRECIS</span>
<a name="ln-2650"></a><span class="c">!       DIGITS (IN BASE &quot;RADIX&quot;)</span>
<a name="ln-2651"></a><span class="c">!       IF INTEGRAL PRECISION, ULPMIN IS THIS NUMBER - PRE-COMPUTED.</span>
<a name="ln-2652"></a><span class="mi">4370</span>    <span class="k">continue</span>
<a name="ln-2653"></a><span class="k">        </span><span class="n">y</span> <span class="o">=</span> <span class="n">fp1</span>
<a name="ln-2654"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">d</span>
<a name="ln-2655"></a><span class="c">!       ... D = A POWER OF  1/RADIX &lt; 1</span>
<a name="ln-2656"></a><span class="mi">4380</span>    <span class="k">continue</span>
<a name="ln-2657"></a><span class="k">        </span><span class="n">c</span><span class="o">=</span><span class="n">y</span>
<a name="ln-2658"></a>        <span class="n">y</span><span class="o">=</span><span class="n">z</span>
<a name="ln-2659"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">accur</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">epsp1</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">exp2</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">iq</span><span class="p">,</span> <span class="n">mindif</span><span class="p">,</span> <span class="n">partu</span>
<a name="ln-2660"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">v9</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">z9</span>
<a name="ln-2661"></a>        <span class="k">rewind </span><span class="mi">3</span>
<a name="ln-2662"></a>        <span class="k">call </span><span class="n">logit</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-2663"></a>        <span class="n">z</span><span class="o">=</span><span class="n">y</span><span class="o">*</span><span class="n">y</span>
<a name="ln-2664"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">z</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">z</span><span class="o">+</span><span class="n">z</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">z</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4380</span>
<a name="ln-2665"></a><span class="c">!          MILESTONE 106</span>
<a name="ln-2666"></a><span class="mi">4390</span>    <span class="k">continue</span>
<a name="ln-2667"></a><span class="k">        </span><span class="n">miles</span> <span class="o">=</span> <span class="mi">106</span>
<a name="ln-2668"></a>        <span class="k">call </span><span class="n">logit</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-2669"></a>        <span class="n">y</span><span class="o">=</span><span class="n">c</span>
<a name="ln-2670"></a>        <span class="n">z</span><span class="o">=</span><span class="n">y</span><span class="o">*</span><span class="n">d</span>
<a name="ln-2671"></a><span class="mi">4400</span>    <span class="k">continue</span>
<a name="ln-2672"></a><span class="k">        </span><span class="n">c</span><span class="o">=</span><span class="n">y</span>
<a name="ln-2673"></a>        <span class="n">y</span><span class="o">=</span><span class="n">z</span>
<a name="ln-2674"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">accur</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">epsp1</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">exp2</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">iq</span><span class="p">,</span> <span class="n">mindif</span><span class="p">,</span> <span class="n">partu</span>
<a name="ln-2675"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">v9</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">z9</span>
<a name="ln-2676"></a>        <span class="k">rewind </span><span class="mi">3</span>
<a name="ln-2677"></a>        <span class="k">call </span><span class="n">logit</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-2678"></a>        <span class="n">z</span><span class="o">=</span><span class="n">y</span><span class="o">*</span><span class="n">d</span>
<a name="ln-2679"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">z</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">z</span><span class="o">+</span><span class="n">z</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">z</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4400</span>
<a name="ln-2680"></a><span class="c">!       MILESTONE 107</span>
<a name="ln-2681"></a><span class="mi">4410</span>    <span class="k">continue</span>
<a name="ln-2682"></a><span class="k">        </span><span class="n">miles</span> <span class="o">=</span> <span class="mi">107</span>
<a name="ln-2683"></a>        <span class="k">call </span><span class="n">logit</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-2684"></a>        <span class="n">h1</span><span class="o">=</span><span class="nb">radix</span>
<a name="ln-2685"></a><span class="nb">        </span><span class="k">if</span> <span class="p">(</span><span class="n">h1</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">fp2</span><span class="p">)</span> <span class="n">h1</span><span class="o">=</span><span class="n">fp2</span>
<a name="ln-2686"></a><span class="c">!4420    continue</span>
<a name="ln-2687"></a>        <span class="n">h</span><span class="o">=</span><span class="n">fp1</span><span class="o">/</span><span class="n">h1</span>
<a name="ln-2688"></a><span class="c">!        ... 1/H1 = H = MIN{ 1/RADIX, 1/2 }</span>
<a name="ln-2689"></a><span class="c">!4430    continue</span>
<a name="ln-2690"></a>        <span class="n">c1</span><span class="o">=</span><span class="n">fp1</span><span class="o">/</span><span class="n">c</span>
<a name="ln-2691"></a>        <span class="n">minpos</span><span class="o">=</span><span class="n">c</span>
<a name="ln-2692"></a>        <span class="n">z</span><span class="o">=</span><span class="n">minpos</span><span class="o">*</span><span class="n">h</span>
<a name="ln-2693"></a><span class="c">!       ... C = 1/RADIX^(BIG INTEGER) &lt;&lt; 1 &lt;&lt; C1 = 1/C</span>
<a name="ln-2694"></a><span class="mi">4440</span>    <span class="k">continue</span>
<a name="ln-2695"></a><span class="k">        </span><span class="n">y</span><span class="o">=</span><span class="n">minpos</span>
<a name="ln-2696"></a>        <span class="n">minpos</span><span class="o">=</span><span class="n">z</span>
<a name="ln-2697"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">accur</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">epsp1</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">exp2</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">iq</span><span class="p">,</span> <span class="n">mindif</span><span class="p">,</span> <span class="n">partu</span>
<a name="ln-2698"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">v9</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">z9</span>
<a name="ln-2699"></a>        <span class="k">rewind </span><span class="mi">3</span>
<a name="ln-2700"></a>        <span class="k">call </span><span class="n">logit</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-2701"></a>        <span class="n">z</span><span class="o">=</span><span class="n">minpos</span><span class="o">*</span><span class="n">h</span>
<a name="ln-2702"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">minpos</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">z</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">z</span><span class="o">+</span><span class="n">z</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">z</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4440</span>
<a name="ln-2703"></a><span class="c">!       MILESTONE 108</span>
<a name="ln-2704"></a><span class="mi">4450</span>    <span class="k">continue</span>
<a name="ln-2705"></a><span class="k">        </span><span class="n">miles</span> <span class="o">=</span> <span class="mi">108</span>
<a name="ln-2706"></a>        <span class="k">call </span><span class="n">logit</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-2707"></a>        <span class="n">uflthr</span> <span class="o">=</span> <span class="n">minpos</span>
<a name="ln-2708"></a>        <span class="n">mindif</span><span class="o">=</span><span class="n">fp0</span>
<a name="ln-2709"></a>        <span class="n">q</span><span class="o">=</span><span class="n">fp0</span>
<a name="ln-2710"></a>        <span class="n">nulps</span><span class="o">=</span><span class="n">ulppls</span>
<a name="ln-2711"></a>        <span class="n">epsp1</span><span class="o">=</span><span class="n">fp1</span><span class="o">+</span><span class="n">nulps</span>
<a name="ln-2712"></a>        <span class="n">d</span><span class="o">=</span><span class="n">c</span><span class="o">*</span><span class="n">epsp1</span>
<a name="ln-2713"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">d</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">c</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4490</span>
<a name="ln-2714"></a><span class="c">!4460    continue</span>
<a name="ln-2715"></a>        <span class="n">nulps</span><span class="o">=</span><span class="nb">radix</span><span class="o">*</span><span class="n">ulppls</span>
<a name="ln-2716"></a>        <span class="n">epsp1</span><span class="o">=</span><span class="n">fp1</span><span class="o">+</span><span class="n">nulps</span>
<a name="ln-2717"></a>        <span class="n">d</span><span class="o">=</span><span class="n">c</span><span class="o">*</span><span class="n">epsp1</span>
<a name="ln-2718"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">d</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">c</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4490</span>
<a name="ln-2719"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4470</span><span class="p">)</span>
<a name="ln-2720"></a><span class="mi">4470</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE: multiplication  gets too many last digits wrong.&#39;</span><span class="p">)</span>
<a name="ln-2721"></a><span class="c">!       ... MULTIPLICATION IS TOO CRUDE</span>
<a name="ln-2722"></a><span class="c">!4480    continue</span>
<a name="ln-2723"></a>        <span class="n">fails</span><span class="o">=</span><span class="n">fails</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2724"></a>        <span class="n">t0</span> <span class="o">=</span> <span class="n">minpos</span>
<a name="ln-2725"></a>        <span class="n">y1</span><span class="o">=</span><span class="n">fp0</span>
<a name="ln-2726"></a>        <span class="n">phony0</span> <span class="o">=</span> <span class="n">z</span>
<a name="ln-2727"></a>        <span class="k">call </span><span class="n">page</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-2728"></a>        <span class="k">goto </span><span class="mi">4570</span>
<a name="ln-2729"></a><span class="mi">4490</span>    <span class="k">continue</span>
<a name="ln-2730"></a><span class="k">        </span><span class="n">t0</span><span class="o">=</span><span class="n">d</span>
<a name="ln-2731"></a>        <span class="n">phony0</span><span class="o">=</span><span class="n">t0</span><span class="o">*</span><span class="n">h</span>
<a name="ln-2732"></a>        <span class="n">uflthr</span><span class="o">=</span><span class="n">fp0</span>
<a name="ln-2733"></a><span class="mi">4500</span>    <span class="k">continue</span>
<a name="ln-2734"></a><span class="k">        </span><span class="n">y1</span><span class="o">=</span><span class="n">t0</span>
<a name="ln-2735"></a>        <span class="n">t0</span><span class="o">=</span><span class="n">phony0</span>
<a name="ln-2736"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">mindif</span><span class="o">+</span><span class="n">mindif</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">mindif</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4520</span>
<a name="ln-2737"></a><span class="c">!4510    continue</span>
<a name="ln-2738"></a>        <span class="n">y2</span> <span class="o">=</span> <span class="n">t0</span> <span class="o">*</span> <span class="n">h1</span>
<a name="ln-2739"></a>        <span class="n">mindif</span><span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y2</span><span class="p">)</span>
<a name="ln-2740"></a>        <span class="n">q</span><span class="o">=</span><span class="n">y1</span>
<a name="ln-2741"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">uflthr</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">y1</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">y2</span><span class="p">)</span> <span class="n">uflthr</span><span class="o">=</span><span class="n">y1</span>
<a name="ln-2742"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">accur</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">epsp1</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">exp2</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">iq</span><span class="p">,</span> <span class="n">mindif</span><span class="p">,</span> <span class="n">partu</span>
<a name="ln-2743"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">v9</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">z9</span>
<a name="ln-2744"></a>        <span class="k">rewind </span><span class="mi">3</span>
<a name="ln-2745"></a>        <span class="n">miles</span> <span class="o">=</span> <span class="mi">108</span>
<a name="ln-2746"></a>        <span class="k">call </span><span class="n">logit</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-2747"></a><span class="mi">4520</span>    <span class="k">continue</span>
<a name="ln-2748"></a><span class="k">        </span><span class="n">phony0</span><span class="o">=</span><span class="n">t0</span><span class="o">*</span><span class="n">h</span>
<a name="ln-2749"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">t0</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">phony0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">phony0</span><span class="o">+</span><span class="n">phony0</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">phony0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4500</span>
<a name="ln-2750"></a><span class="mi">4522</span>    <span class="k">continue</span>
<a name="ln-2751"></a><span class="k">        </span><span class="n">miles</span> <span class="o">=</span> <span class="mi">109</span>
<a name="ln-2752"></a>        <span class="k">call </span><span class="n">logit</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-2753"></a><span class="c">!        ... NOW  1 &gt;&gt; C=1/RADIX^(INTEGER)  &gt;=   Y    &gt;   MINPOS=Y*H</span>
<a name="ln-2754"></a><span class="c">!                  &gt;~ Z:=MINPOS*H &gt;~ 0 ,</span>
<a name="ln-2755"></a><span class="c">!        ... AND  1 &gt;&gt; D=(1+NULPS)*C &gt;= UFLTHR &gt;= Q &gt;= Y1 &gt; T0:=Y1*H</span>
<a name="ln-2756"></a><span class="c">!                  &gt;~ PHONY0:=T0*H &gt;~ 0 ,</span>
<a name="ln-2757"></a><span class="c">!        ... AND  UFLTHR = D/RADIX^INTEGER  IS FIRST TO VIOLATE</span>
<a name="ln-2758"></a><span class="c">!                  (UFLTHR*H)/H=UFLTHR , ELSE  UFLTHR=0 ;</span>
<a name="ln-2759"></a><span class="c">!        ... AND  Q:=UFLTHR/RADIX^INTEGER  IS FIRST WITH  MINDIF :=</span>
<a name="ln-2760"></a><span class="c">!                  |(Q*H)/H - Q| &gt; 0, ELSE Q=Y1.</span>
<a name="ln-2761"></a><span class="mi">4570</span>    <span class="k">continue</span>
<a name="ln-2762"></a><span class="k">        if</span> <span class="p">(</span><span class="n">phony0</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4860</span>
<a name="ln-2763"></a><span class="c">!        ... TEST  PHONY0  FOR &#39;PHONEY-ZERO&#39; VIOLATING  PHONY0&lt;T0 OR</span>
<a name="ln-2764"></a><span class="c">!                  PHONY0&lt;PHONY0+PHONY0  ...</span>
<a name="ln-2765"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4590</span><span class="p">)</span>
<a name="ln-2766"></a><span class="mi">4590</span>    <span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="p">)</span>
<a name="ln-2767"></a>        <span class="n">z</span><span class="o">=</span><span class="n">phony0</span>
<a name="ln-2768"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">phony0</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="k">goto </span><span class="mi">4620</span>
<a name="ln-2769"></a><span class="c">!4600    continue</span>
<a name="ln-2770"></a>        <span class="n">fails</span><span class="o">=</span><span class="n">fails</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2771"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4601</span><span class="p">)</span>
<a name="ln-2772"></a><span class="mi">4601</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE:  positive expressions can underflow to an allegedly&#39;</span><span class="p">)</span>
<a name="ln-2773"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4602</span><span class="p">)</span><span class="n">phony0</span>
<a name="ln-2774"></a><span class="mi">4602</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;          negative value z0 that prints out as &#39;</span><span class="p">,</span> <span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-2775"></a>        <span class="n">x</span><span class="o">=-</span><span class="n">phony0</span>
<a name="ln-2776"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4630</span>
<a name="ln-2777"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4610</span><span class="p">)</span><span class="n">x</span>
<a name="ln-2778"></a><span class="mi">4610</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;          but  -z0, which should then be positive, isn&#39;&#39;t; it prints out as&#39;</span><span class="p">,</span> <span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-2779"></a>        <span class="k">goto </span><span class="mi">4630</span>
<a name="ln-2780"></a><span class="mi">4620</span>    <span class="k">continue</span>
<a name="ln-2781"></a><span class="k">        </span><span class="n">flaws</span><span class="o">=</span><span class="n">flaws</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2782"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4623</span><span class="p">)</span>
<a name="ln-2783"></a><span class="mi">4623</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FLAW: underflow can stick at an allegedly positive value  z0&#39;</span><span class="p">)</span>
<a name="ln-2784"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4626</span><span class="p">)</span><span class="n">phony0</span>
<a name="ln-2785"></a><span class="mi">4626</span>    <span class="k">format</span><span class="p">(</span> <span class="s1">&#39;       that prints out as &#39;</span><span class="p">,</span> <span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-2786"></a><span class="mi">4630</span>    <span class="k">continue</span>
<a name="ln-2787"></a><span class="k">        </span><span class="n">miles</span><span class="o">=</span><span class="mi">115</span>
<a name="ln-2788"></a><span class="c">!       PARTUF INCLUDES CALL LOGIT(MILES)</span>
<a name="ln-2789"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">accur</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">epsp1</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">exp2</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">iq</span><span class="p">,</span> <span class="n">mindif</span><span class="p">,</span> <span class="n">partu</span>
<a name="ln-2790"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">v9</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">z9</span>
<a name="ln-2791"></a>        <span class="k">rewind </span><span class="mi">3</span>
<a name="ln-2792"></a><span class="mi">4631</span>    <span class="k">continue</span>
<a name="ln-2793"></a><span class="k">        call </span><span class="n">partuf</span> <span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">charz0</span><span class="p">,</span> <span class="n">miles</span><span class="p">,</span> <span class="n">partu</span><span class="p">,</span> <span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">115</span><span class="p">)</span>
<a name="ln-2794"></a><span class="c">!       ... END OF TEST FOR &#39;PHONEY-ZERO&#39;.</span>
<a name="ln-2795"></a><span class="mi">4860</span>    <span class="k">continue</span>
<a name="ln-2796"></a><span class="k">        </span><span class="n">miles</span><span class="o">=</span><span class="mi">120</span>
<a name="ln-2797"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">accur</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">epsp1</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">exp2</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">iq</span><span class="p">,</span> <span class="n">mindif</span><span class="p">,</span> <span class="n">partu</span>
<a name="ln-2798"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">v9</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">z9</span>
<a name="ln-2799"></a>        <span class="k">rewind </span><span class="mi">3</span>
<a name="ln-2800"></a>        <span class="k">call </span><span class="n">logit</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-2801"></a><span class="c">!       ==============================================================</span>
<a name="ln-2802"></a><span class="c">!4870    continue</span>
<a name="ln-2803"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="n">y</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">c1</span><span class="o">*</span><span class="n">y1</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4890</span>
<a name="ln-2804"></a><span class="c">!       ... AS HAPPENS ON MOST MACHINES.</span>
<a name="ln-2805"></a><span class="c">!4880    continue</span>
<a name="ln-2806"></a>        <span class="n">epsp1</span><span class="o">=</span><span class="n">h</span><span class="o">*</span><span class="n">epsp1</span>
<a name="ln-2807"></a>        <span class="n">minpos</span><span class="o">=</span><span class="n">t0</span>
<a name="ln-2808"></a><span class="c">!       = LEAST POSITIVE NO. ON HP 3000</span>
<a name="ln-2809"></a><span class="mi">4890</span>    <span class="k">continue</span>
<a name="ln-2810"></a><span class="k">        if</span> <span class="p">(</span><span class="n">mindif</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">mindif</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">minpos</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4930</span>
<a name="ln-2811"></a><span class="c">!4900    continue</span>
<a name="ln-2812"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">mindif</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">minpos</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">4920</span>
<a name="ln-2813"></a><span class="c">!4910    continue</span>
<a name="ln-2814"></a>        <span class="n">defect</span><span class="o">=</span><span class="n">defect</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2815"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4912</span><span class="p">)</span>
<a name="ln-2816"></a><span class="mi">4912</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; DEFECT: differences underflow at a higher threshold than products.&#39;</span><span class="p">)</span>
<a name="ln-2817"></a>        <span class="k">goto </span><span class="mi">4930</span>
<a name="ln-2818"></a><span class="mi">4920</span>    <span class="k">continue</span>
<a name="ln-2819"></a><span class="k">        </span><span class="n">defect</span><span class="o">=</span><span class="n">defect</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2820"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4922</span><span class="p">)</span>
<a name="ln-2821"></a><span class="mi">4922</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; DEFECT: products underflow at a higher threshold than differences.&#39;</span><span class="p">)</span>
<a name="ln-2822"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">phony0</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="n">minpos</span><span class="o">=</span><span class="n">mindif</span>
<a name="ln-2823"></a><span class="c">!       ... BUT NOT IF PSEUDO-ZEROS EXIST.</span>
<a name="ln-2824"></a><span class="mi">4930</span>    <span class="k">continue</span>
<a name="ln-2825"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4935</span><span class="p">)</span> <span class="n">minpos</span>
<a name="ln-2826"></a><span class="mi">4935</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Smallest strictly positive number found is  minpos  =&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="n">pe16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-2827"></a><span class="c">!4940    continue</span>
<a name="ln-2828"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">minpos</span>
<a name="ln-2829"></a>        <span class="n">miles</span> <span class="o">=</span> <span class="mi">121</span>
<a name="ln-2830"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">accur</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">epsp1</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">exp2</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">iq</span><span class="p">,</span> <span class="n">mindif</span><span class="p">,</span> <span class="n">partu</span>
<a name="ln-2831"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">v9</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">z9</span>
<a name="ln-2832"></a>        <span class="k">rewind </span><span class="mi">3</span>
<a name="ln-2833"></a><span class="mi">4941</span>    <span class="k">continue</span>
<a name="ln-2834"></a><span class="k">        call </span><span class="n">partuf</span> <span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">chare0</span><span class="p">,</span> <span class="n">miles</span><span class="p">,</span> <span class="n">partu</span><span class="p">,</span> <span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">121</span><span class="p">)</span>
<a name="ln-2835"></a>        <span class="n">t0</span><span class="o">=</span><span class="n">minpos</span>
<a name="ln-2836"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">partu</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="n">t0</span><span class="o">=</span><span class="n">y</span>
<a name="ln-2837"></a><span class="c">!       FOR CDC 7600</span>
<a name="ln-2838"></a><span class="c">!4950    continue</span>
<a name="ln-2839"></a>        <span class="n">i</span><span class="o">=</span><span class="mi">4</span>
<a name="ln-2840"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">mindif</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="n">i</span><span class="o">=</span><span class="mi">3</span>
<a name="ln-2841"></a><span class="c">!       ...  I=1 IF MINDIF=0=UFLTHR  ,   I=2 IF MINDIF&gt;0=UFLTHR  ,</span>
<a name="ln-2842"></a><span class="c">!4960    continue</span>
<a name="ln-2843"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">uflthr</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span>
<a name="ln-2844"></a><span class="c">!           ...  I=3 IF MINDIF=0&lt;UFLTHR  ,   I=4 IF MINDIF&gt;0 &amp; UFLTHR&gt;0</span>
<a name="ln-2845"></a><span class="c">!4970    continue</span>
<a name="ln-2846"></a>        <span class="k">goto</span> <span class="p">(</span><span class="mi">4980</span><span class="p">,</span> <span class="mi">5090</span><span class="p">,</span> <span class="mi">5010</span><span class="p">,</span> <span class="mi">5130</span><span class="p">),</span><span class="n">i</span>
<a name="ln-2847"></a><span class="c">!       ... CASE STATEMENT</span>
<a name="ln-2848"></a><span class="mi">4980</span>    <span class="k">continue</span>
<a name="ln-2849"></a><span class="k">        </span><span class="n">uflthr</span><span class="o">=</span><span class="n">t0</span>
<a name="ln-2850"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="n">q</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">epsp1</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">5010</span>
<a name="ln-2851"></a><span class="c">!4990    continue</span>
<a name="ln-2852"></a>        <span class="n">fails</span><span class="o">=</span><span class="n">fails</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2853"></a>        <span class="n">uflthr</span><span class="o">=</span><span class="n">y</span>
<a name="ln-2854"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4993</span><span class="p">)</span>
<a name="ln-2855"></a><span class="mi">4993</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE: either accuracy deteriorates as numbers approach a threshold&#39;</span><span class="p">)</span>
<a name="ln-2856"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4996</span><span class="p">)</span><span class="n">uflthr</span><span class="p">,</span><span class="n">c</span>
<a name="ln-2857"></a><span class="mi">4996</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; of &#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39; coming down from  &#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-2858"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4997</span><span class="p">)</span>
<a name="ln-2859"></a><span class="mi">4997</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; or else  multiplication  gets too many last digits wrong.&#39;</span><span class="p">)</span>
<a name="ln-2860"></a>        <span class="k">call </span><span class="n">page</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-2861"></a><span class="c">!</span>
<a name="ln-2862"></a><span class="c">!        ___ TEST FOR  X-Z = 0  ALTHOUGH  X  .NE.  Z ___</span>
<a name="ln-2863"></a><span class="c">!</span>
<a name="ln-2864"></a><span class="mi">5010</span>    <span class="k">continue</span>
<a name="ln-2865"></a><span class="k">        </span><span class="n">miles</span> <span class="o">=</span> <span class="mi">122</span>
<a name="ln-2866"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">accur</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">epsp1</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">exp2</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">iq</span><span class="p">,</span> <span class="n">mindif</span><span class="p">,</span> <span class="n">partu</span>
<a name="ln-2867"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">v9</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">z9</span>
<a name="ln-2868"></a>        <span class="k">rewind </span><span class="mi">3</span>
<a name="ln-2869"></a>        <span class="k">call </span><span class="n">logit</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-2870"></a>        <span class="n">r</span> <span class="o">=</span>  <span class="nb">sqrt</span><span class="p">(</span><span class="n">t0</span> <span class="o">/</span> <span class="n">uflthr</span><span class="p">)</span>
<a name="ln-2871"></a>        <span class="n">go</span> <span class="n">to</span> <span class="mi">5012</span>
<a name="ln-2872"></a><span class="mi">5011</span>    <span class="k">continue</span>
<a name="ln-2873"></a><span class="k">        </span><span class="n">r</span> <span class="o">=</span> <span class="n">fp1</span>
<a name="ln-2874"></a><span class="mi">5012</span>    <span class="k">continue</span>
<a name="ln-2875"></a><span class="k">        if</span> <span class="p">(</span><span class="n">r</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">h</span><span class="p">)</span> <span class="k">goto </span><span class="mi">5030</span>
<a name="ln-2876"></a><span class="c">!5020    continue</span>
<a name="ln-2877"></a>        <span class="n">z</span><span class="o">=</span><span class="n">r</span><span class="o">*</span><span class="n">uflthr</span>
<a name="ln-2878"></a>        <span class="n">x</span><span class="o">=</span><span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="n">fp1</span><span class="o">+</span><span class="n">r</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="p">(</span><span class="n">fp1</span><span class="o">+</span><span class="n">h</span><span class="p">))</span>
<a name="ln-2879"></a>        <span class="k">goto </span><span class="mi">5040</span>
<a name="ln-2880"></a><span class="mi">5030</span>    <span class="k">continue</span>
<a name="ln-2881"></a><span class="k">        </span><span class="n">z</span><span class="o">=</span><span class="n">uflthr</span>
<a name="ln-2882"></a>        <span class="n">x</span><span class="o">=</span><span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="n">fp1</span><span class="o">+</span><span class="n">h</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="p">(</span><span class="n">fp1</span><span class="o">+</span><span class="n">h</span><span class="p">))</span>
<a name="ln-2883"></a><span class="mi">5040</span>    <span class="k">continue</span>
<a name="ln-2884"></a><span class="k">        </span><span class="n">miles</span> <span class="o">=</span> <span class="mi">123</span>
<a name="ln-2885"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">accur</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">epsp1</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">exp2</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">iq</span><span class="p">,</span> <span class="n">mindif</span><span class="p">,</span> <span class="n">partu</span>
<a name="ln-2886"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">v9</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">z9</span>
<a name="ln-2887"></a>        <span class="k">rewind </span><span class="mi">3</span>
<a name="ln-2888"></a>        <span class="k">call </span><span class="n">logit</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-2889"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">z</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">x</span><span class="o">-</span><span class="n">z</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">fp0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">5160</span>
<a name="ln-2890"></a><span class="c">!5050    continue</span>
<a name="ln-2891"></a>        <span class="n">flaws</span><span class="o">=</span><span class="n">flaws</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2892"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5055</span><span class="p">)</span><span class="n">x</span><span class="p">,</span><span class="n">z</span>
<a name="ln-2893"></a><span class="mi">5055</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FLAW:  x =&#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39; is unequal to  z =&#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39; ,&#39;</span><span class="p">)</span>
<a name="ln-2894"></a>        <span class="n">z9</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">z</span>
<a name="ln-2895"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5057</span><span class="p">)</span> <span class="n">z9</span>
<a name="ln-2896"></a><span class="mi">5057</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; yet  x-z  yields &#39;</span><span class="p">,</span> <span class="n">e15</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-2897"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5060</span><span class="p">)</span>
<a name="ln-2898"></a><span class="mi">5060</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Should this not signal underflow, this is a SERIOUS DEFECT that causes confusion when innocent statements like&#39;</span><span class="p">)</span>
<a name="ln-2899"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5063</span><span class="p">)</span>
<a name="ln-2900"></a><span class="mi">5063</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; if (x.eq.z) then ... else ... ( f(x)-f(z) )/(x-z) ...&#39;</span><span class="p">)</span>
<a name="ln-2901"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5070</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">z</span><span class="o">-</span><span class="n">half</span><span class="p">)</span><span class="o">-</span><span class="n">half</span>
<a name="ln-2902"></a><span class="mi">5070</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; encounter division by zero although actually  x/z = 1 +&#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-2903"></a>        <span class="n">go</span> <span class="n">to</span> <span class="mi">5160</span>
<a name="ln-2904"></a><span class="c">!       ... END OF TEST FOR  X-Z = 0  &amp;  X  .NE.  Z</span>
<a name="ln-2905"></a><span class="mi">5090</span>    <span class="k">continue</span>
<a name="ln-2906"></a><span class="c">!        CASE I=2</span>
<a name="ln-2907"></a><span class="c">!       UFLTHR = 0 &lt; MINDIF  !</span>
<a name="ln-2908"></a><span class="c">!5100    continue</span>
<a name="ln-2909"></a>        <span class="n">fails</span><span class="o">=</span><span class="n">fails</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2910"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5102</span><span class="p">)</span>
<a name="ln-2911"></a><span class="mi">5102</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FAILURE: underflow confuses comparison, which alleges that  q = y &#39;</span><span class="p">)</span>
<a name="ln-2912"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5104</span><span class="p">)</span>
<a name="ln-2913"></a><span class="mi">5104</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;         while denying that  |q-y| = 0 ; these values print out as&#39;</span><span class="p">)</span>
<a name="ln-2914"></a>        <span class="n">temp</span><span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="n">y2</span><span class="p">)</span>
<a name="ln-2915"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5106</span><span class="p">)</span><span class="n">q</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">temp</span>
<a name="ln-2916"></a><span class="mi">5106</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; q =&#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;,  y =&#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;,  |q-y| =&#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39; ,&#39;</span><span class="p">)</span>
<a name="ln-2917"></a>        <span class="n">temp</span> <span class="o">=</span> <span class="n">q</span><span class="o">/</span><span class="n">y2</span> <span class="o">-</span> <span class="n">half</span>
<a name="ln-2918"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5110</span><span class="p">)</span> <span class="n">temp</span> <span class="o">-</span> <span class="n">half</span>
<a name="ln-2919"></a><span class="mi">5110</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; and  q/y = 1 + &#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-2920"></a><span class="c">!5120    continue</span>
<a name="ln-2921"></a>        <span class="n">uflthr</span><span class="o">=</span><span class="n">q</span>
<a name="ln-2922"></a>        <span class="k">goto </span><span class="mi">5010</span>
<a name="ln-2923"></a><span class="c">!        CASE I=4 ;  UFLTHR &gt; 0  &amp;  MINDIF &gt; 0</span>
<a name="ln-2924"></a><span class="mi">5130</span>    <span class="k">continue</span>
<a name="ln-2925"></a><span class="c">!5140    continue</span>
<a name="ln-2926"></a>        <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="p">(</span><span class="n">q</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">uflthr</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">mindif</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">minpos</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="nb">abs</span><span class="p">(</span><span class="n">uflthr</span><span class="o">-</span><span class="n">mindif</span><span class="o">/</span><span class="n">nulps</span><span class="p">)</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">mindif</span><span class="p">))</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">5010</span>
<a name="ln-2927"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5150</span><span class="p">)</span>
<a name="ln-2928"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5155</span><span class="p">)</span>
<a name="ln-2929"></a><span class="mi">5150</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Underflow is gradual; it incurs  absolute error = &#39;</span><span class="p">)</span>
<a name="ln-2930"></a><span class="mi">5155</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; (roundoff in underflow threshold) &lt; minpos.&#39;</span><span class="p">)</span>
<a name="ln-2931"></a>        <span class="n">y</span><span class="o">=</span><span class="n">minpos</span><span class="o">*</span><span class="n">c1</span>
<a name="ln-2932"></a>        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mf">1.5e0</span><span class="o">+</span><span class="n">ulppls</span><span class="p">)</span>
<a name="ln-2933"></a>        <span class="n">x</span><span class="o">=</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="n">fp1</span><span class="o">+</span><span class="n">ulppls</span><span class="p">)</span>
<a name="ln-2934"></a>        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">/</span><span class="n">x</span>
<a name="ln-2935"></a>        <span class="n">ieee</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2936"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">minpos</span><span class="p">)</span> <span class="n">ieee</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-2937"></a><span class="c">!       ... IEEE=1 UNLESS GRADUAL UNDERFLOWS ARE DOUBLY ROUNDED.)</span>
<a name="ln-2938"></a><span class="mi">5160</span>    <span class="k">continue</span>
<a name="ln-2939"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5163</span><span class="p">)</span><span class="n">uflthr</span>
<a name="ln-2940"></a><span class="mi">5163</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; The  underflow threshold is &#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39; , below which&#39;</span><span class="p">)</span>
<a name="ln-2941"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5165</span><span class="p">)</span>
<a name="ln-2942"></a><span class="mi">5165</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; calculation may suffer larger relative error than merely roundoff.&#39;</span><span class="p">)</span>
<a name="ln-2943"></a><span class="c">!5170    continue</span>
<a name="ln-2944"></a>        <span class="n">miles</span> <span class="o">=</span> <span class="mi">124</span>
<a name="ln-2945"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">accur</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">epsp1</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">exp2</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">iq</span><span class="p">,</span> <span class="n">mindif</span><span class="p">,</span> <span class="n">partu</span>
<a name="ln-2946"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">v9</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">z9</span>
<a name="ln-2947"></a>        <span class="k">rewind </span><span class="mi">3</span>
<a name="ln-2948"></a>        <span class="k">call </span><span class="n">logit</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-2949"></a>        <span class="n">y2</span><span class="o">=</span><span class="n">ulpmin</span><span class="o">*</span><span class="n">ulpmin</span>
<a name="ln-2950"></a>        <span class="n">y</span><span class="o">=</span><span class="n">y2</span><span class="o">*</span><span class="n">y2</span>
<a name="ln-2951"></a>        <span class="n">miles</span> <span class="o">=</span> <span class="mi">125</span>
<a name="ln-2952"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">accur</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">epsp1</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">exp2</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">iq</span><span class="p">,</span> <span class="n">mindif</span><span class="p">,</span> <span class="n">partu</span>
<a name="ln-2953"></a>        <span class="k">write</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">v9</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">z9</span>
<a name="ln-2954"></a>        <span class="k">rewind </span><span class="mi">3</span>
<a name="ln-2955"></a>        <span class="k">call </span><span class="n">logit</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-2956"></a>        <span class="n">y2</span><span class="o">=</span><span class="n">y</span><span class="o">*</span><span class="n">ulpmin</span>
<a name="ln-2957"></a><span class="mi">5175</span>    <span class="k">continue</span>
<a name="ln-2958"></a><span class="k">        if</span> <span class="p">(</span><span class="n">y2</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">uflthr</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">5220</span>
<a name="ln-2959"></a><span class="c">!5180    continue</span>
<a name="ln-2960"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">minpos</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">5200</span>
<a name="ln-2961"></a><span class="mi">5190</span>    <span class="k">continue</span>
<a name="ln-2962"></a><span class="k">        </span><span class="n">sdefct</span><span class="o">=</span><span class="n">sdefct</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2963"></a>        <span class="n">i</span><span class="o">=</span><span class="mi">4</span>
<a name="ln-2964"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5195</span><span class="p">)</span>
<a name="ln-2965"></a><span class="mi">5195</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; SERIOUS &#39;</span><span class="p">)</span>
<a name="ln-2966"></a>        <span class="k">goto </span><span class="mi">5210</span>
<a name="ln-2967"></a><span class="mi">5200</span>    <span class="k">continue</span>
<a name="ln-2968"></a><span class="k">        </span><span class="n">defect</span><span class="o">=</span><span class="n">defect</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2969"></a>        <span class="n">i</span><span class="o">=</span><span class="mi">5</span>
<a name="ln-2970"></a><span class="mi">5210</span>    <span class="k">continue</span>
<a name="ln-2971"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5212</span><span class="p">)</span><span class="n">i</span>
<a name="ln-2972"></a><span class="mi">5212</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; DEFECT:  range is too narrow;   ulpmin^&#39;</span><span class="p">,</span><span class="n">i5</span><span class="p">,</span><span class="s1">&#39;  underflows.&#39;</span><span class="p">)</span>
<a name="ln-2973"></a><span class="mi">5220</span>    <span class="k">continue</span>
<a name="ln-2974"></a><span class="k">        </span><span class="n">miles</span><span class="o">=</span><span class="mi">130</span>
<a name="ln-2975"></a>        <span class="k">call </span><span class="n">page</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-2976"></a><span class="c">!       ---- PAUSE ---- ==================================</span>
<a name="ln-2977"></a><span class="c">!5230    continue</span>
<a name="ln-2978"></a>        <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="nb">aint</span><span class="p">(</span><span class="n">half</span> <span class="o">-</span> <span class="mi">24</span><span class="mf">0.0</span> <span class="o">*</span> <span class="nb">alog</span><span class="p">(</span><span class="n">uflthr</span><span class="p">)</span> <span class="o">/</span> <span class="nb">alog</span><span class="p">(</span><span class="n">h1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">240</span>
<a name="ln-2979"></a>        <span class="n">y2</span><span class="o">=</span><span class="n">y</span><span class="o">+</span><span class="n">y</span>
<a name="ln-2980"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5240</span><span class="p">)</span><span class="n">h1</span><span class="p">,</span><span class="n">y</span>
<a name="ln-2981"></a><span class="mi">5240</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; since underflow occurs below the threshold  =&#39;</span><span class="o">/</span><span class="mi">10</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;(&#39;</span><span class="p">,</span><span class="mi">1</span><span class="n">pe16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;)^(&#39;</span><span class="p">,</span><span class="mi">1</span><span class="n">pe16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;) ,&#39;</span><span class="p">)</span>
<a name="ln-2982"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5245</span><span class="p">)</span><span class="n">h1</span><span class="p">,</span><span class="n">y2</span>
<a name="ln-2983"></a><span class="mi">5245</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; only underflow should afflict the expression&#39;</span><span class="o">/</span><span class="mi">10</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;(&#39;</span><span class="p">,</span><span class="mi">1</span><span class="n">pe16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;)^(&#39;</span><span class="p">,</span><span class="mi">1</span><span class="n">pe16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;) ;&#39;</span><span class="p">)</span>
<a name="ln-2984"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5247</span><span class="p">)</span>
<a name="ln-2985"></a><span class="mi">5247</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; actually calculating it yields   &#39;</span><span class="p">)</span>
<a name="ln-2986"></a>        <span class="n">miles</span> <span class="o">=</span> <span class="mi">131</span>
<a name="ln-2987"></a>        <span class="k">call </span><span class="n">logit</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-2988"></a><span class="c">!5250    continue</span>
<a name="ln-2989"></a>        <span class="n">v9</span> <span class="o">=</span> <span class="n">h1</span> <span class="o">**</span> <span class="p">(</span><span class="n">y2</span><span class="p">)</span>
<a name="ln-2990"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5255</span><span class="p">)</span> <span class="n">v9</span>
<a name="ln-2991"></a><span class="mi">5255</span>    <span class="k">format</span><span class="p">(</span><span class="mi">1</span><span class="n">x</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-2992"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">v9</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="n">fp0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">v9</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="p">(</span><span class="nb">radix</span><span class="o">+</span><span class="nb">radix</span><span class="o">*</span><span class="n">nulps</span><span class="p">)</span><span class="o">*</span><span class="n">uflthr</span><span class="p">)</span><span class="n">go</span> <span class="n">to</span> <span class="mi">5270</span>
<a name="ln-2993"></a><span class="c">!5260    continue</span>
<a name="ln-2994"></a>        <span class="n">sdefct</span><span class="o">=</span><span class="n">sdefct</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2995"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5263</span><span class="p">)</span>
<a name="ln-2996"></a><span class="mi">5263</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; SERIOUS&#39;</span><span class="p">)</span>
<a name="ln-2997"></a>        <span class="k">goto </span><span class="mi">5300</span>
<a name="ln-2998"></a><span class="mi">5270</span>    <span class="k">continue</span>
<a name="ln-2999"></a><span class="k">        if</span> <span class="p">(</span><span class="n">v9</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">uflthr</span><span class="o">*</span><span class="p">(</span><span class="n">fp1</span><span class="o">+</span><span class="n">nulps</span><span class="p">))</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">5290</span>
<a name="ln-3000"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5280</span><span class="p">)</span>
<a name="ln-3001"></a><span class="mi">5280</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; This computed value is O.K.&#39;</span><span class="p">)</span>
<a name="ln-3002"></a>        <span class="k">goto </span><span class="mi">5310</span>
<a name="ln-3003"></a><span class="mi">5290</span>    <span class="k">continue</span>
<a name="ln-3004"></a><span class="k">        </span><span class="n">defect</span><span class="o">=</span><span class="n">defect</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3005"></a><span class="mi">5300</span>    <span class="k">continue</span>
<a name="ln-3006"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5302</span><span class="p">)</span><span class="n">uflthr</span>
<a name="ln-3007"></a><span class="mi">5302</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; DEFECT: this is not between 0 and  underflow threshold=&#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-3008"></a>        <span class="n">go</span> <span class="n">to</span> <span class="mi">5310</span>
<a name="ln-3009"></a><span class="mi">53021</span>   <span class="k">continue</span>
<a name="ln-3010"></a><span class="k">        </span><span class="n">flaws</span> <span class="o">=</span> <span class="n">flaws</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3011"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">53022</span><span class="p">)</span>
<a name="ln-3012"></a><span class="mi">53022</span>   <span class="k">format</span><span class="p">(</span><span class="s1">&#39; FLAW: underflow trap from ** .&#39;</span><span class="p">)</span>
<a name="ln-3013"></a><span class="mi">5310</span>    <span class="k">continue</span>
<a name="ln-3014"></a><span class="k">        </span><span class="n">miles</span><span class="o">=</span><span class="mi">140</span>
<a name="ln-3015"></a><span class="c">!       ======================================================</span>
<a name="ln-3016"></a><span class="c">!       CALCULATE  EXP2 = EXP(2) = 7.389056099...</span>
<a name="ln-3017"></a><span class="c">!5330    continue</span>
<a name="ln-3018"></a>        <span class="n">x</span><span class="o">=</span><span class="n">fp0</span>
<a name="ln-3019"></a>        <span class="n">i</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-3020"></a>        <span class="n">y</span><span class="o">=</span><span class="n">fp2</span><span class="o">*</span><span class="n">fp3</span>
<a name="ln-3021"></a>        <span class="n">q</span><span class="o">=</span><span class="n">fp0</span>
<a name="ln-3022"></a>        <span class="n">accur</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3023"></a><span class="mi">5340</span>    <span class="k">continue</span>
<a name="ln-3024"></a><span class="k">        </span><span class="n">z</span><span class="o">=</span><span class="n">x</span>
<a name="ln-3025"></a>        <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3026"></a>        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">/</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
<a name="ln-3027"></a>        <span class="n">r</span><span class="o">=</span><span class="n">y</span><span class="o">+</span><span class="n">q</span>
<a name="ln-3028"></a>        <span class="n">x</span><span class="o">=</span><span class="n">z</span><span class="o">+</span><span class="n">r</span>
<a name="ln-3029"></a>        <span class="n">q</span><span class="o">=</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">r</span>
<a name="ln-3030"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">z</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">5340</span>
<a name="ln-3031"></a><span class="c">!5350    continue</span>
<a name="ln-3032"></a>        <span class="n">z</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5e0</span><span class="o">+</span><span class="n">fp1</span><span class="o">/</span><span class="n">fp8</span><span class="p">)</span><span class="o">+</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mf">1.5e0</span> <span class="o">*</span> <span class="n">fp32</span><span class="p">)</span>
<a name="ln-3033"></a>        <span class="n">x</span><span class="o">=</span><span class="n">z</span><span class="o">*</span><span class="n">z</span>
<a name="ln-3034"></a>        <span class="n">exp2</span><span class="o">=</span><span class="n">x</span><span class="o">*</span><span class="n">x</span>
<a name="ln-3035"></a>        <span class="n">x</span><span class="o">=</span><span class="n">onemin</span>
<a name="ln-3036"></a>        <span class="n">y</span><span class="o">=</span><span class="n">x</span><span class="o">-</span><span class="n">ulpmin</span>
<a name="ln-3037"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5360</span><span class="p">)</span> <span class="n">exp2</span>
<a name="ln-3038"></a><span class="mi">5360</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Testing  x^((x+1)/(x-1)) vs. exp(2) = &#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;  as  x-&gt; 1.&#39;</span><span class="p">)</span>
<a name="ln-3039"></a><span class="mi">5370</span>    <span class="k">continue</span>
<a name="ln-3040"></a><span class="k">        do </span><span class="mi">5415</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span> <span class="p">,</span> <span class="n">numtry</span>
<a name="ln-3041"></a><span class="c">!5380    continue</span>
<a name="ln-3042"></a>        <span class="n">z</span><span class="o">=</span><span class="n">x</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="nb">radix</span><span class="p">)</span>
<a name="ln-3043"></a>        <span class="n">z</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">fp1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="p">(</span><span class="n">fp1</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="nb">radix</span><span class="p">)))</span>
<a name="ln-3044"></a>        <span class="n">q</span><span class="o">=</span><span class="n">x</span><span class="o">**</span><span class="n">z</span><span class="o">-</span><span class="n">exp2</span>
<a name="ln-3045"></a>        <span class="k">if</span> <span class="p">(</span> <span class="nb">abs</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">24</span><span class="mf">0.</span> <span class="o">*</span> <span class="n">ulppls</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">5420</span>
<a name="ln-3046"></a><span class="c">!5390    continue</span>
<a name="ln-3047"></a>        <span class="n">z</span><span class="o">=</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">fp2</span><span class="o">+</span><span class="n">y</span>
<a name="ln-3048"></a>        <span class="n">x</span><span class="o">=</span><span class="n">y</span>
<a name="ln-3049"></a>        <span class="n">y</span><span class="o">=</span><span class="n">z</span>
<a name="ln-3050"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">fp1</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">onemin</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">onemin</span><span class="p">)</span>
<a name="ln-3051"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">fp1</span><span class="p">)</span> <span class="k">goto </span><span class="mi">5400</span>
<a name="ln-3052"></a><span class="mi">5415</span>    <span class="k">continue</span>
<a name="ln-3053"></a><span class="mi">5400</span>    <span class="k">continue</span>
<a name="ln-3054"></a><span class="k">        if</span> <span class="p">(</span><span class="n">x</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">fp1</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">5440</span>
<a name="ln-3055"></a><span class="c">!5410    continue</span>
<a name="ln-3056"></a>        <span class="n">x</span><span class="o">=</span><span class="n">fp1</span><span class="o">+</span><span class="n">ulppls</span>
<a name="ln-3057"></a>        <span class="n">y</span><span class="o">=</span><span class="n">ulppls</span><span class="o">+</span><span class="n">ulppls</span><span class="o">+</span><span class="n">x</span>
<a name="ln-3058"></a>        <span class="k">goto </span><span class="mi">5370</span>
<a name="ln-3059"></a><span class="mi">5420</span>    <span class="k">continue</span>
<a name="ln-3060"></a><span class="k">        </span><span class="n">accur</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-3061"></a>        <span class="n">defect</span><span class="o">=</span><span class="n">defect</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3062"></a>        <span class="n">temp</span><span class="o">=+</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="nb">radix</span><span class="p">))</span><span class="o">-</span><span class="p">(</span><span class="n">fp1</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="nb">radix</span><span class="p">))</span>
<a name="ln-3063"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5425</span><span class="p">)</span><span class="n">temp</span><span class="p">,</span><span class="n">z</span>
<a name="ln-3064"></a><span class="mi">5425</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; DEFECT:  calculated  (1 + (&#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;))^(&#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
<a name="ln-3065"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5427</span><span class="p">)</span><span class="n">q</span>
<a name="ln-3066"></a><span class="mi">5427</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39;         differs from correct value by  &#39;</span><span class="p">,</span><span class="n">e16</span><span class="p">.</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-3067"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5430</span><span class="p">)</span>
<a name="ln-3068"></a><span class="mi">5430</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; This much error may spoil financial calculations involving tiny interest rates.&#39;</span><span class="p">)</span>
<a name="ln-3069"></a>        <span class="k">goto </span><span class="mi">5450</span>
<a name="ln-3070"></a><span class="mi">5440</span>    <span class="k">continue</span>
<a name="ln-3071"></a><span class="k">        if</span> <span class="p">(</span><span class="n">accur</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5445</span><span class="p">)</span>
<a name="ln-3072"></a><span class="mi">5445</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Accuracy seems adequate.&#39;</span><span class="p">)</span>
<a name="ln-3073"></a><span class="mi">5450</span>    <span class="k">continue</span>
<a name="ln-3074"></a><span class="k">        </span><span class="n">miles</span><span class="o">=</span><span class="mi">150</span>
<a name="ln-3075"></a><span class="c">!       =======================================================</span>
<a name="ln-3076"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">5460</span><span class="p">)</span>
<a name="ln-3077"></a><span class="mi">5460</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Testing powers  z^q  at four nearly extreme values:&#39;</span><span class="p">)</span>
<a name="ln-3078"></a>        <span class="n">error</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3079"></a>        <span class="n">z</span><span class="o">=</span><span class="n">a1</span>
<a name="ln-3080"></a>        <span class="n">iq</span> <span class="o">=</span>  <span class="nb">int</span><span class="p">(</span><span class="n">half</span><span class="o">-</span><span class="nb">alog</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">/</span> <span class="nb">alog</span><span class="p">(</span><span class="n">a1</span><span class="p">))</span>
<a name="ln-3081"></a><span class="mi">5470</span>    <span class="k">continue</span>
<a name="ln-3082"></a><span class="k">        </span><span class="n">x</span><span class="o">=</span><span class="n">c1</span>
<a name="ln-3083"></a>        <span class="k">call </span><span class="n">cmpxy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">iq</span><span class="p">,</span><span class="n">error</span><span class="p">)</span>
<a name="ln-3084"></a>        <span class="n">iq</span><span class="o">=-</span><span class="n">iq</span>
<a name="ln-3085"></a>        <span class="n">x</span><span class="o">=</span><span class="n">c</span>
<a name="ln-3086"></a>        <span class="k">call </span><span class="n">cmpxy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">iq</span><span class="p">,</span><span class="n">error</span><span class="p">)</span>
<a name="ln-3087"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">fp1</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">5490</span>
<a name="ln-3088"></a><span class="c">!5480    continue</span>
<a name="ln-3089"></a>        <span class="n">z</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">a1</span>
<a name="ln-3090"></a>        <span class="k">goto </span><span class="mi">5470</span>
<a name="ln-3091"></a><span class="mi">5490</span>    <span class="k">continue</span>
<a name="ln-3092"></a><span class="k">        call </span><span class="n">prtcnt</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span>
<a name="ln-3093"></a>        <span class="k">call </span><span class="n">prt2</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-3094"></a><span class="c">!       ... PRINT COUNT OF DISCREPANCIES.</span>
<a name="ln-3095"></a><span class="c">!5500    continue</span>
<a name="ln-3096"></a>        <span class="n">miles</span><span class="o">=</span><span class="mi">160</span>
<a name="ln-3097"></a>        <span class="k">return</span>
<a name="ln-3098"></a><span class="k">        end subroutine </span><span class="n">underf</span>
<a name="ln-3099"></a><span class="c">!#######################################################################</span>
<a name="ln-3100"></a><span class="c">!---</span>
<a name="ln-3101"></a>        <span class="k">subroutine </span><span class="n">zeros</span><span class="p">(</span><span class="n">miles</span><span class="p">,</span><span class="n">from</span><span class="p">)</span>
<a name="ln-3102"></a>      <span class="k">implicit none</span>
<a name="ln-3103"></a><span class="k">        </span><span class="kt">integer </span><span class="n">miles</span>
<a name="ln-3104"></a><span class="c">!</span>
<a name="ln-3105"></a><span class="c">!</span>
<a name="ln-3106"></a><span class="c">!       MILESTONE REACHED SO FAR</span>
<a name="ln-3107"></a>        <span class="kt">integer </span><span class="n">from</span>
<a name="ln-3108"></a><span class="c">!       MILESTONE TO RESTART AT</span>
<a name="ln-3109"></a>        <span class="kt">real </span><span class="n">q9</span>
<a name="ln-3110"></a><span class="c">!       TEMPORARY TO THROW RANDOM STUFF INTO.</span>
<a name="ln-3111"></a>        <span class="k">if</span><span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">6110</span>
<a name="ln-3112"></a><span class="c">!       MUST BE DOING A RESTART.  FIGURE OUT WHERE, AND GO DO IT.</span>
<a name="ln-3113"></a><span class="c">!       DON&#39;T NEED A LOG FILE FOR THIS ROUTINE.</span>
<a name="ln-3114"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">211</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">7000</span>
<a name="ln-3115"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">212</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">6130</span>
<a name="ln-3116"></a>        <span class="k">call </span><span class="n">badmil</span>
<a name="ln-3117"></a><span class="mi">6110</span>    <span class="k">continue</span>
<a name="ln-3118"></a><span class="k">        write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">6120</span><span class="p">)</span>
<a name="ln-3119"></a><span class="mi">6120</span>    <span class="k">format</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39; What messages and/or values does division by zero produce?&#39;</span><span class="p">)</span>
<a name="ln-3120"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">6123</span><span class="p">)</span>
<a name="ln-3121"></a><span class="mi">6123</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; About to compute 1/0...&#39;</span><span class="p">)</span>
<a name="ln-3122"></a>        <span class="n">miles</span> <span class="o">=</span> <span class="mi">211</span>
<a name="ln-3123"></a>        <span class="k">call </span><span class="n">logit</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-3124"></a>        <span class="n">q9</span> <span class="o">=</span> <span class="n">fp1</span> <span class="o">/</span> <span class="n">fp0</span>
<a name="ln-3125"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">6121</span><span class="p">)</span> <span class="n">q9</span>
<a name="ln-3126"></a><span class="mi">6121</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Trying to compute  1/0  produces &#39;</span><span class="p">,</span> <span class="mi">1</span><span class="n">pe15</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-3127"></a><span class="mi">7000</span>    <span class="k">continue</span>
<a name="ln-3128"></a><span class="k">        </span><span class="n">miles</span> <span class="o">=</span> <span class="mi">212</span>
<a name="ln-3129"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">6124</span><span class="p">)</span>
<a name="ln-3130"></a><span class="mi">6124</span>    <span class="k">format</span><span class="p">(</span><span class="s1">&#39; About to compute 0/0...&#39;</span><span class="p">)</span>
<a name="ln-3131"></a>        <span class="k">call </span><span class="n">logit</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<a name="ln-3132"></a>        <span class="n">q9</span> <span class="o">=</span> <span class="n">fp0</span> <span class="o">/</span> <span class="n">fp0</span>
<a name="ln-3133"></a>        <span class="k">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">6122</span><span class="p">)</span> <span class="n">q9</span>
<a name="ln-3134"></a><span class="mi">6122</span>    <span class="k">format</span> <span class="p">(</span><span class="s1">&#39; Trying to compute  0/0  produces &#39;</span><span class="p">,</span> <span class="mi">1</span><span class="n">pe15</span><span class="p">.</span><span class="mi">7</span><span class="o">/</span><span class="p">)</span>
<a name="ln-3135"></a><span class="mi">6130</span>    <span class="k">continue</span>
<a name="ln-3136"></a><span class="k">        </span><span class="n">miles</span> <span class="o">=</span> <span class="mi">220</span>
<a name="ln-3137"></a>        <span class="k">return</span>
<a name="ln-3138"></a><span class="k">        end subroutine </span><span class="n">zeros</span>
<a name="ln-3139"></a><span class="c">!#######################################################################</span>
<a name="ln-3140"></a>      <span class="k">subroutine </span><span class="n">badmil</span>
<a name="ln-3141"></a>      <span class="k">implicit none</span>
<a name="ln-3142"></a><span class="k">      write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">11110</span><span class="p">)</span>
<a name="ln-3143"></a><span class="mi">11110</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39; Unrecognized restart milestone - PLEASE NOTIFY KARPINSKI !&#39;</span><span class="p">)</span>
<a name="ln-3144"></a>      <span class="k">stop</span>
<a name="ln-3145"></a><span class="k">      end subroutine </span><span class="n">badmil</span>
<a name="ln-3146"></a><span class="c">!#######################################################################</span>
<a name="ln-3147"></a><span class="k">end subroutine </span><span class="n">sparanoia</span>
<a name="ln-3148"></a><span class="c">!#######################################################################</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2022 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2022-05-04 21:40  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> paranoia was developed by John S. Urban</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>